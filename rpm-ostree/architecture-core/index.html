<html><head><style data-id="immersive-translate-default-injected-css">:root {
  --immersive-translate-theme-underline-borderColor: #72ece9;
  --immersive-translate-theme-nativeUnderline-borderColor: #72ece9;
  --immersive-translate-theme-nativeDashed-borderColor: #72ece9;
  --immersive-translate-theme-nativeDotted-borderColor: #72ece9;
  --immersive-translate-theme-highlight-backgroundColor: #ffff00;
  --immersive-translate-theme-dashed-borderColor: #59c1bd;
  --immersive-translate-theme-blockquote-borderColor: #cc3355;
  --immersive-translate-theme-thinDashed-borderColor: #ff374f;
  --immersive-translate-theme-dashedBorder-borderColor: #94a3b8;
  --immersive-translate-theme-dashedBorder-borderRadius: 0;
  --immersive-translate-theme-solidBorder-borderColor: #94a3b8;
  --immersive-translate-theme-solidBorder-borderRadius: 0;
  --immersive-translate-theme-dotted-borderColor: #94a3b8;
  --immersive-translate-theme-wavy-borderColor: #72ece9;
  --immersive-translate-theme-dividingLine-borderColor: #94a3b8;
  --immersive-translate-theme-grey-textColor: #2f4f4f;
  --immersive-translate-theme-marker-backgroundColor: #fbda41;
  --immersive-translate-theme-marker-backgroundColor-rgb: 251, 218, 65;
  --immersive-translate-theme-marker2-backgroundColor: #ffff00;
  --immersive-translate-theme-opacity-opacity: 10;
}

.immersive-translate-target-translation-pre-whitespace {
  white-space: pre-wrap !important;
}

.immersive-translate-pdf-target-container {
  position: absolute;
  background-color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
    sans-serif;
  top: 0;
  width: 600px;
  height: 100%;
  z-index: 2;
  line-height: 1.3;
  font-size: 16px;
}
.immersive-translate-target-wrapper[dir='rtl'] {
  text-align: right;
}

.immersive-translate-pdf-target-container .immersive-translate-target-wrapper {
  color: rgb(0, 0, 0);
  white-space: normal;
  position: absolute;
}

.immersive-translate-pdf-target-container .immersive-translate-target-wrapper font {
  color: inherit;
  white-space: inherit;
  position: unset;
}

.immersive-translate-state-dual>br {
  display: none;
}

.immersive-translate-target-translation-block-wrapper {
  margin: 8px 0 !important;
  display: inline-block;
}

.immersive-translate-target-translation-pdf-block-wrapper {
  margin: 0 !important;
  display: block;
}

.immersive-translate-target-translation-theme-grey-inner {
  color: var(--immersive-translate-theme-grey-textColor);
}


.immersive-translate-target-translation-theme-underline-inner {
  border-bottom: 1px solid var(--immersive-translate-theme-underline-borderColor) !important;
}

.immersive-translate-target-translation-theme-nativeUnderline-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeUnderline-borderColor) !important;
}

.immersive-translate-target-translation-block-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

.immersive-translate-target-translation-inline-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
  padding: 2px;
}

.immersive-translate-target-translation-block-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

.immersive-translate-target-translation-inline-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
  padding: 2px;
}

.immersive-translate-target-translation-theme-nativeDashed-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeDashed-borderColor) !important;
  text-decoration-style: dashed !important;
}

.immersive-translate-target-translation-theme-thinDashed-inner {
  border-bottom: 1px dashed var(--immersive-translate-theme-thinDashed-borderColor) !important;
}

.immersive-translate-target-translation-theme-dotted-inner {
  background-image: linear-gradient(to right,
      var(--immersive-translate-theme-dotted-borderColor) 30%,
      rgba(255, 255, 255, 0) 0%);
  background-position: bottom;
  background-size: 5px 1px;
  background-repeat: repeat-x;
  padding-bottom: 3px;
}

.immersive-translate-target-translation-theme-nativeDotted-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeDotted-borderColor) !important;
  text-decoration-style: dotted !important;
}

.immersive-translate-target-translation-theme-wavy-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-wavy-borderColor) !important;
  text-decoration-style: wavy !important;
}

.immersive-translate-target-translation-theme-dashed-inner {
  background: linear-gradient(to right,
      var(--immersive-translate-theme-dashed-borderColor) 0%,
      var(--immersive-translate-theme-dashed-borderColor) 50%,
      transparent 50%,
      transparent 100%) repeat-x left bottom;
  background-size: 8px 2px;
  padding-bottom: 2px;
}

.immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
  content: "";
  display: block;
  max-width: 80px;
  width: 10%;
  border-top: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
  padding-top: 8px;
}

.immersive-translate-target-translation-inline-wrapper-theme-dividingLine::before {
  content: "";
  border-left: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
  max-height: 16px;
  height: 16px;
  padding-left: 8px;
}

.immersive-translate-target-translation-theme-highlight-inner {
  background: var(--immersive-translate-theme-highlight-backgroundColor);
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

.immersive-translate-target-translation-block-wrapper-theme-marker {
  line-height: 1.5em;
}

.immersive-translate-target-translation-theme-marker2-inner {
  font-weight: bold;
  text-shadow: 10px 0px 3px var(--immersive-translate-theme-marker2-backgroundColor),
    16px 3px 9px var(--immersive-translate-theme-marker2-backgroundColor),
    2px 0px 6px var(--immersive-translate-theme-marker2-backgroundColor),
    -12px 0px 12px var(--immersive-translate-theme-marker2-backgroundColor) !important;
}

.immersive-translate-target-translation-theme-marker-inner {
  /* TODO: add more texture */
  background: linear-gradient(to right,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.1),
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 3%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 35%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 70%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.8) 95%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.3));
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

.immersive-translate-target-translation-theme-weakening {
  opacity: 0.618 !important;
}

.immersive-translate-target-translation-theme-italic {
  font-style: italic !important;
}

.immersive-translate-target-translation-theme-bold {
  font-weight: bold !important;
}

.immersive-translate-target-translation-block-wrapper-theme-paper {
  margin: 8px 0;
  box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
  padding: 16px 32px;
  display: block;
}

.immersive-translate-target-translation-block-wrapper-theme-blockquote {
  border-left: 4px solid var(--immersive-translate-theme-blockquote-borderColor) !important;
  padding-left: 12px !important;
  margin-top: 4px;
  margin-bottom: 4px;
  padding-top: 4px;
  padding-bottom: 4px;
  display: block;
}

.immersive-translate-target-translation-theme-mask-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-mask-inner {
  filter: none !important;
}

[data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}


/* opacity theme start */

.immersive-translate-target-translation-theme-opacity-inner {
  filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-opacity-inner {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner,.immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

.immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: none !important;
}


.immersive-translate-target-translation-theme-mask-inner:hover {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner:hover {
  filter: none !important;
}


[data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner:hover {
  filter: none !important;
}

/* opacity theme end */

/* vertical css , please remain it in the last one. */
.immersive-translate-target-translation-vertical-block-wrapper {
  margin: 0px 8px !important;
}

.immersive-translate-text {
  font-size: 15px !important;
}

.immersive-translate-error-toast {
  position: fixed;
  top: 5%;
  z-index: 99999999;
  left: 0;
  right: 0;
  margin: auto;
  max-width: 300px;
  padding: 16px;
  border-radius: 12px;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  flex-direction: row;
  justify-content: space-between;
}

@media all and (min-width: 750px) {
  .immersive-translate-error-toast {
    max-width: 400px;
  }
}


.immersive-translate-clickable-button {
  cursor: pointer;
}

.immersive-translate-help-button {
  cursor: pointer;
}

.immersive-translate-loading-text:before {
  content: "...";
}


/* dark mode for loading */

@media only screen and (prefers-color-scheme: dark) {
  .immersive-translate-loading {
    border: 2px rgba(255, 255, 255, 0.25) solid !important;
    border-top: 2px rgba(255, 255, 255, 1) solid !important;
  }
}

.immersive-translate-error-wrapper {
  position: relative;
  display: inline-flex;
  padding: 6px;
  margin: 0 12px;
  white-space: nowrap;
  font-size: 0.9em;
}
[lang="zh-CN"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}
[lang="zh-TW"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}


.immersive-translate-tooltip {
  position: relative;
  display: inline-flex;
  /* little indicater to indicate it's hoverable */
}

.immersive-translate-tooltip-content {
  /* here's the magic */
  position: absolute;
  z-index: 100000000000;

  left: 50%;
  bottom: 0;
  transform: translate(-50%, 110%);
  line-height: 1;
  /* and add a small left margin */

  /* basic styles */
  width: max-content;
  max-width: 250px;
  word-wrap: break-word;
  white-space: pre-line;
  padding: 10px;
  border-radius: 10px;
  background: #000C;
  color: #fff;
  text-align: center;
  font-size: 14px;
  display: none;
  /* hide by default */
}

.immersive-translate-tooltip:hover .immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip:hover+.immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip-content-table {
  left: unset !important;
  bottom: unset !important;
  transform: translate(-10%, 50%) !important;
}


.immersive-translate-tooltip:hover:before {
  display: block;
}



.immersive-translate-loading-spinner {
  vertical-align: middle !important;
  width: 10px !important;
  height: 10px !important;
  display: inline-block !important;
  margin: 0 4px !important;
  border: 2px rgba(221, 244, 255, 0.6) solid !important;
  border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-radius: 50% !important;
  padding: 0 !important;
  -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
  animation: immersive-translate-loading-animation 0.6s infinite linear !important;
}

@-webkit-keyframes immersive-translate-loading-animation {
  from {
    -webkit-transform: rotate(0deg);
  }

  to {
    -webkit-transform: rotate(359deg);
  }
}

@keyframes immersive-translate-loading-animation {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(359deg);
  }
}
</style><style data-id="immersive-translate-user-custom-style">:root {

.immersive-translate-target-inner { font-family: inherit; }
}
</style><style data-id="immersive-translate-dynamic-injected-css">.immersive-translate-target-wrapper[dir='rtl'] {text-align: right;}
.immersive-translate-target-wrapper[dir='rtl'] [data-immersive-translate-class-bak*='block-wrapper'] {display:block;}
.immersive-translate-target-wrapper {word-break: break-word;}
</style></head><body data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="../assets/css/just-the-docs-default.css"><link rel="stylesheet" href="../assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"><style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(1)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(7) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(7) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(7) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(7) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(7) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; }</style><script src="../assets/js/vendor/lunr.min.js"></script> <script src="../assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="../favicon.ico" type="image/x-icon"><title>RPM packages, ostree commits | rpm-ostree</title><meta name="generator" content="Jekyll v3.9.5"><meta property="og:title" content="RPM packages, ostree commits"><meta property="og:locale" content="en_US"><meta name="description" content="rpm-ostree documentation"><meta property="og:description" content="rpm-ostree documentation"><link rel="canonical" href="index.html"><meta property="og:url" content="https://coreos.github.io/rpm-ostree/architecture-core/"><meta property="og:site_name" content="rpm-ostree"><meta property="og:type" content="website"><meta name="twitter:card" content="summary"><meta property="twitter:title" content="RPM packages, ostree commits"> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"rpm-ostree documentation","headline":"RPM packages, ostree commits","url":"https://coreos.github.io/rpm-ostree/architecture-core/"}</script> <a class="skip-to-main" href="#main-content" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Skip to main content<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">跳转至主要内容</font></font></font></a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"></path><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"></path> </svg> </symbol> </svg><div class="side-bar" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><div class="site-header" role="banner" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"> <a href="../index.html" class="site-title lh-tight" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> rpm-ostree </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button></div><nav aria-label="Main" id="site-nav" class="site-nav" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><ul class="nav-list" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">A true hybrid image/package system<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">一个真正的混合镜像/软件包系统</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../background/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Background<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">背景</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../administrator-handbook/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Client administration<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">客户端管理</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../countme/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">DNF Count Me support<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">DNF 计数我支持</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><button class="nav-list-expander btn-reset" aria-label="toggle items in Composing images category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="../compose/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Composing images<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">撰写图像</font></font></font></a><ul class="nav-list" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../compose-server/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Compose server<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">组合服务器</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../treefile/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Treefile reference<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Treefile 参考</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../extensions/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Extensions<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">扩展</font></font></font></a></li></ul></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../container/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">ostree native containers<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">ostree 本地容器</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><button class="nav-list-expander btn-reset" aria-label="toggle items in Architecture category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="../architecture/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Architecture<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">架构</font></font></font></a><ul class="nav-list" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">RPM packages, ostree commits<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">RPM 软件包，ostree 提交</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../architecture-daemon/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Daemon model<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">守护程序模型</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../apply-live/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Architecture of apply-live<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">应用实时架构</font></font></font></a></li></ul></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><button class="nav-list-expander btn-reset" aria-label="toggle items in Contributing category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="../CONTRIBUTING/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Contributing<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">贡献</font></font></font></a><ul class="nav-list" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../HACKING/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Hacking on rpm-ostree<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在 rpm-ostree 上进行黑客攻击</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../repo_structure/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Repository structure<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">仓库结构</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../RELEASE/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Releasing rpm-ostree<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">发布 rpm-ostree</font></font></font></a></li></ul></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><button class="nav-list-expander btn-reset" aria-label="toggle items in Experimental features category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="../experimental/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Experimental features<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">实验性功能</font></font></font></a><ul class="nav-list" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../cliwrap/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Wrapping other CLI entrypoints<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">封装其他 CLI 入口点</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../ex-rebuild/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Declarative system changes<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">声明性系统更改</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../ex-replace/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">override replace --experimental<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">覆盖替换 --实验性</font></font></font></a></li><li class="nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../layering/index.html" class="nav-list-link" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Applying a new package using CoreOS layering<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 CoreOS 分层应用新包</font></font></font></a></li></ul></li></ul></nav><footer class="site-footer" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> This site uses <a href="https://github.com/just-the-docs/just-the-docs" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">Just the Docs</a>, a documentation theme for Jekyll.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">本站使用 Just the Docs，这是一个适用于 Jekyll 的文档主题。</font></font></font></footer></div><div class="main" id="top" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><div id="main-header" class="main-header" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><div class="search" role="search" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><div class="search-input-wrap" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search rpm-ostree" aria-label="Search rpm-ostree" autocomplete="off" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"> <label for="search-input" class="search-label" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"></div></div><nav aria-label="Auxiliary" class="aux-nav" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><ul class="aux-nav-list" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li class="aux-nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"> <a href="https://github.com/coreos/rpm-ostree" class="site-button" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> rpm-ostree on GitHub <font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在 GitHub 上的 rpm-ostree</font></font></font></a></li></ul></nav></div><div class="main-content-wrap" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><nav aria-label="Breadcrumb" class="breadcrumb-nav" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><ol class="breadcrumb-nav-list" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li class="breadcrumb-nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="../architecture/index.html" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Architecture<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">架构</font></font></font></a></li><li class="breadcrumb-nav-list-item" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><span data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">RPM packages, ostree commits<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">RPM 软件包，ostree 提交</font></font></font></span></li></ol></nav><div id="main-content" class="main-content" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><main data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><h1 class="no_toc" id="rpm-packages-ostree-commits" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> <a href="#rpm-packages-ostree-commits" class="anchor-heading" aria-labelledby="rpm-packages-ostree-commits" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RPM packages, ostree commits<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">RPM 软件包，ostree 提交</font></font></font></h1><ol id="markdown-toc" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="#rpms--config---single-ostree-commit" id="markdown-toc-rpms--config---single-ostree-commit" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">RPMs + config -&gt; single OSTree commit<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">RPMs + 配置 -&gt; 单个 OSTree 提交</font></font></font></a></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="#philosophy-every-change-is-from-scratch" id="markdown-toc-philosophy-every-change-is-from-scratch" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Philosophy: Every change is “from scratch”<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">哲学：每次更改都是“从头开始”的</font></font></font></a></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="#base-vs-extensions-split" id="markdown-toc-base-vs-extensions-split" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Base vs extensions split<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">基础 vs 扩展分离</font></font></font></a></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="#overall-architecture" id="markdown-toc-overall-architecture" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Overall architecture:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">总体架构：</font></font></font></a><ol data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="#generating-the-filesystem-tree" id="markdown-toc-generating-the-filesystem-tree" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Generating the filesystem tree<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">生成文件系统树</font></font></font></a></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="#sandboxing-scripts" id="markdown-toc-sandboxing-scripts" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Sandboxing scripts<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">沙盒脚本</font></font></font></a></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="#content-in-var" id="markdown-toc-content-in-var" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Content in /var<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">/var 中的内容</font></font></font></a></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="#kernel-handling" id="markdown-toc-kernel-handling" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Kernel handling<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">内核处理</font></font></font></a></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="#selinux" id="markdown-toc-selinux" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">SELinux</a><ol data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><a href="#selinux-policy-storage-location" id="markdown-toc-selinux-policy-storage-location" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">SELinux policy storage location<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">SELinux 策略存储位置</font></font></font></a></li></ol></li></ol></li></ol><h2 id="rpms--config---single-ostree-commit" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> <a href="#rpms--config---single-ostree-commit" class="anchor-heading" aria-labelledby="rpms--config---single-ostree-commit" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RPMs + config -&gt; single OSTree commit<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">RPM 包 + 配置 -&gt; 单个 OSTree 提交</font></font></font></h2><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">On the compose side, to generate the “base image” the core idea is that we take a set of packages as input, along with other configuration and data and generate a single OSTree commit - a versioned filesystem tree.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在组合方面，生成“基础镜像”的核心思想是，我们将一组软件包作为输入，以及其他配置和数据，并生成一个单个的 OSTree 提交 - 一个带版本的文件系统树。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">The same is also true on the client side, but it starts from a “base commit”.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">客户端也是如此，但它是从一个“基本提交”开始的。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">This document will describe the “core” phases and steps in that process that apply both build/compose side and client side.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">本文档将描述该过程中适用于构建/组合端和客户端的“核心”阶段和步骤。</font></font></font></p><h2 id="philosophy-every-change-is-from-scratch" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> <a href="#philosophy-every-change-is-from-scratch" class="anchor-heading" aria-labelledby="philosophy-every-change-is-from-scratch" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Philosophy: Every change is “from scratch”<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">哲学：每一次变更都是“从头开始”。</font></font></font></h2><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">For every change today, rpm-ostree generally rebuilds the target filesystem “from scratch” - adding accurate caching where needed. The goal is to avoid <a href="https://en.wikipedia.org/wiki/Hysteresis" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">hysteresis</a> (<a href="https://blog.verbum.org/2020/08/22/immutable-%E2%86%92-reprovisionable-anti-hysteresis/" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">related blog</a>).<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">对于今天的每一次更改，rpm-ostree 通常会“从头开始”重新构建目标文件系统 - 在需要时添加准确的缓存。目标是避免滞后效应（相关博客）。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">In other words if e.g. you <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">rpm-ostree install foo</code> and then <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">rpm-ostree install bar</code>, the new target filesystem tree will be regenerated “from scratch” and all RPM <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%post</code> scripts etc. will rerun.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">换句话说，例如，如果您 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">rpm-ostree install foo</code> 然后 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">rpm-ostree install bar</code> ，新的目标文件系统树将被“从头开始”重新生成，所有 RPM <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%post</code> 脚本等将重新运行。</font></font></font></p><h2 id="base-vs-extensions-split" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> <a href="#base-vs-extensions-split" class="anchor-heading" aria-labelledby="base-vs-extensions-split" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Base vs extensions split<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">基础与扩展分离</font></font></font></h2><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">rpm-ostree today goes to some lengths to create a distinction between the “base image” and optional “layered/extension” packages. The idea is that the base image has been tested on a build server, and any overrides or replacements are more likely to break things, and should be explicit actions.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">rpm-ostree 今天在创建“基础镜像”和可选的“分层/扩展”软件包之间进行了一些区分。其想法是基础镜像已在构建服务器上经过测试，任何覆盖或替换更有可能导致故障，应该是明确的操作。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">This is the reason why on the client side e.g. <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">rpm-ostree upgrade kernel</code> does not work today. Instead, this requires an invocation of <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">rpm-ostree override replace</code>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这就是为什么在客户端上例如 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">rpm-ostree upgrade kernel</code> 今天无法工作的原因。相反，这需要调用 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">rpm-ostree override replace</code> 。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Another related rationale for this is that rpm-ostree does not have a per-package “user installed” type database as exists in e.g. <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">dnf</code>. Everything in the base image is always replaced by the contents of the new base image, without considering any per-package semantics. For more on this topic, see <a href="https://blog.verbum.org/2020/08/22/immutable-%E2%86%92-reprovisionable-anti-hysteresis/" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">this blog entry</a>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这种做法的另一个相关理由是，rpm-ostree 没有像 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">dnf</code> 中存在的每个软件包“用户安装”类型数据库。基础镜像中的所有内容总是被新基础镜像的内容替换，而不考虑任何软件包的语义。有关此主题的更多信息，请参阅此博客条目。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">In some cases, a dependency may “span” the base image and a layered package. For discussion related to this, see e.g. https://github.com/coreos/rpm-ostree/issues/415 A solution chosen for in Fedora is to ensure that such packages have versions corresponding to the base image available in the rpm-md repository as well; this is implemented via the <a href="https://src.fedoraproject.org/rpms/fedora-repos/blob/rawhide/f/fedora-updates-archive.repo" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">updates-archive repository</a>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在某些情况下，依赖关系可能“跨越”基础镜像和分层包。有关此问题的讨论，请参见例如 https://github.com/coreos/rpm-ostree/issues/415 Fedora 中选择的解决方案是确保这些包的版本与 rpm-md 存储库中基础镜像的版本对应；这是通过 updates-archive 存储库实现的。</font></font></font></p><h2 id="overall-architecture" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> <a href="#overall-architecture" class="anchor-heading" aria-labelledby="overall-architecture" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overall architecture:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">整体架构：</font></font></font></h2><ul data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">For each package, download and import into OSTree commit if necessary<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">对于每个软件包，如果需要，下载并导入到 OSTree 提交。</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Unpack the “base” filesystem tree if any via hardlinks<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">通过硬链接解压“base”文件系统树（如果有的话）</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Determine an installation order, and unpack each package-ostree commit again via hardlinks<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">确定安装顺序，并通过硬链接再次解压每个软件包-ostree 提交</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Run all the <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%post</code> scripts (in install order)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">运行所有 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%post</code> 脚本（按安装顺序）</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Run all the <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%posttrans</code> scripts (in install order)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">运行所有 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%posttrans</code> 脚本（按安装顺序）</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Write RPM database (if we had a “base commit”, starting from that)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">写入 RPM 数据库（如果有“基本提交”，则从那里开始）</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">If initramfs regeneration is enabled or the kernel was replaced, remove the base initramfs and run <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">dracut</code> to generate a new one.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果启用了 initramfs 重新生成或者内核已被替换，则删除基本 initramfs 并运行 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">dracut</code> 生成新的。</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Ask libostree to commit the resulting filesystem tree, optimized by a (device, inode) -&gt; checksum cache, so that files that weren’t changed aren’t re-checksummed.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">请求 libostree 提交生成的文件系统树，通过 (设备，索引节点) -&gt; 校验和缓存进行优化，以便不重新对未更改的文件进行校验。</font></font></font></li></ul><h3 id="generating-the-filesystem-tree" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> <a href="#generating-the-filesystem-tree" class="anchor-heading" aria-labelledby="generating-the-filesystem-tree" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Generating the filesystem tree<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">生成文件系统树</font></font></font></h3><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">In contrast to the above, traditional package managers like RPM are usually implemented in a flow that does:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">与上述相反，像 RPM 这样的传统软件包管理器通常是按照以下流程实现的：</font></font></font></p><ul data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Unpack package A<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">解压包 A</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Run <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%post</code> script for A<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">运行 A 的 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%post</code> 脚本</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Update the package database with metadata for A<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 A 的元数据更新包数据库</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Unpack package B<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">解压包 B</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Run <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%post</code> script for B<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">运行 B 的 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%post</code> 脚本</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Update the package database with metadata for B<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 B 的元数据更新包数据库</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">…</li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Run <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%posttrans</code> scripts<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">运行 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%posttrans</code> 脚本</font></font></font></li></ul><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">etc.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">等等。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">In contrast, rpm-ostree maintains an OSTree commit corresponding to each RPM package provided as input. On a client system, you can see this in e.g. <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">ostree refs | grep rpmostree/pkg</code> (assuming you have layered packages). On a build system, these ostree commits will be stored in a repo at <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">pkgcache-repo/</code> within the cache directory.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">相比之下，rpm-ostree 维护与提供的每个 RPM 软件包对应的一个 OSTree 提交。在客户端系统上，您可以在例如 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">ostree refs | grep rpmostree/pkg</code> 中看到这一点（假设您有分层软件包）。在构建系统上，这些 ostree 提交将存储在缓存目录中的 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">pkgcache-repo/</code> 存储库中。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">This acts as an optimized cache for regenerating the target root filesystem. So for rpm-ostree, the phase is more like this:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这充当了重新生成目标根文件系统的优化缓存。因此对于 rpm-ostree，该阶段更像是这样：</font></font></font></p><ul data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Unpack the filesystem tree for all packages<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">为所有软件包解压文件系统树</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Run all the <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%post</code> scripts<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">运行所有 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%post</code> 脚本</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Run all the <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%posttrans</code> scripts …<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">运行所有 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%posttrans</code> 脚本...</font></font></font></li></ul><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">rpm-ostree is effectively reimplementing large chunks of the librpm userspace in order to make it use OSTree natively.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">rpm-ostree 实际上是重新实现了大部分 librpm 用户空间，以便使其原生地使用 OSTree。</font></font></font></p><h3 id="sandboxing-scripts" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> <a href="#sandboxing-scripts" class="anchor-heading" aria-labelledby="sandboxing-scripts" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sandboxing scripts<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">脚本沙盒化</font></font></font></h3><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">On the build server side, it’s obviously desirable to have the “build” of an ostree commit for a target system not affect the running host.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在构建服务器端，显然希望目标系统的 ostree 提交的“构建”不会影响运行主机。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Similarly, on the client side, the default is to provide “offline” updates that don’t affect the running system.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">同样，在客户端，提供“离线”更新是默认设置，不会影响运行系统。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">As part of this, rpm-ostree currently uses the <a href="https://github.com/containers/bubblewrap/" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">bubblewrap</a> tool to run each script in its own isolated container.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">作为其中的一部分，rpm-ostree 目前使用 bubblewrap 工具在独立的容器中运行每个脚本。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Today, scripts are run with real uid 0 (not in a user namespace), but we <a href="https://github.com/coreos/rpm-ostree/pull/1099" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">drop most capabilities</a>. Additionally, scripts can’t see the real host root filesystem, most notably they do not see the real <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/var</code> with all of the system data. A good example of the benefit of this is <a href="https://github.com/coreos/rpm-ostree/pull/888" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">“tests: Add a test case for a %post that does rm -rf /”</a>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">今天，脚本以真实的 uid 0 运行（不在用户命名空间中），但我们会放弃大部分权限。此外，脚本无法看到真实的主机根文件系统，特别是它们看不到带有所有系统数据的真实 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/var</code> 。这种做法的好处的一个很好的例子是“测试：为执行 rm -rf / 的 %post 添加一个测试用例”。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">In addition to bubblewrap, rpm-ostree uses <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">rofiles-fuse</code> from the ostree project which originally enforced the model that a file that has multiple hardlinks is read-only, but more recently gained <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">--copyup</code> support which acts in a similar fashion to the in-kernel <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">overlayfs</code>. (See also https://github.com/ostreedev/ostree/issues/2281)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">除了 bubblewrap 外，rpm-ostree 还使用 ostree 项目中的 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">rofiles-fuse</code> ，该项目最初强制执行一个文件具有多个硬链接是只读的模型，但最近增加了 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">--copyup</code> 支持，其功能类似于内核中的 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">overlayfs</code> 。（另请参阅 https://github.com/ostreedev/ostree/issues/2281）</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Scripts can mutate content in <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/etc</code> and <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/usr</code>, but this should generally be restricted to updating “cache files”. Example of this are <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">ldconfig</code> and <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">gtk-update-icon-cache</code>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">脚本可以更改 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/etc</code> 和 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/usr</code> 中的内容，但这通常应该限制在更新“缓存文件”上。这方面的例子包括 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">ldconfig</code> 和 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">gtk-update-icon-cache</code> 。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Scripts see a minimal, read-only view of <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/var</code>. It is explicitly not writable. This helps ensure offline updates are possible; a package script running client side cannot affect persistent system state.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">脚本查看 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/var</code> 的最小只读视图。明确不可写。这有助于确保离线更新的可能性；在客户端运行的软件包脚本不能影响持久系统状态。</font></font></font></p><h3 id="content-in-var" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> <a href="#content-in-var" class="anchor-heading" aria-labelledby="content-in-var" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Content in /var<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">/var 中的内容</font></font></font></h3><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">rpm-ostree automatically synthesizes <a href="https://www.freedesktop.org/software/systemd/man/tmpfiles.d.html" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">systemd tmpfiles.d</a> snippets from directories in <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/var</code>. This helps ensure a separation between OS updates and machine local state. The directories will be created when the system boots - and it aids in a “factory reset” scenario of wiping machine-local state in <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/var</code>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">rpm-ostree 会自动从 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/var</code> 中的目录合成 systemd tmpfiles.d 片段。这有助于确保 OS 更新和机器本地状态之间的分离。这些目录将在系统启动时创建 - 并且在“恢复出厂设置”场景中有助于擦除机器本地状态。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">At the current time, any non-directories (i.e. regular files or symbolic links) are discarded. This will likely change to be an opt-in error in the future.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在当前时间，任何非目录（即常规文件或符号链接）都将被丢弃。这很可能会在将来更改为选择性错误。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Example bugs:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">示例错误：</font></font></font></p><ul data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">https://bugzilla.redhat.com/show_bug.cgi?id=2132103</li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">https://bugzilla.redhat.com/show_bug.cgi?id=1473402</li></ul><h3 id="kernel-handling" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> <a href="#kernel-handling" class="anchor-heading" aria-labelledby="kernel-handling" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Kernel handling<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">内核处理</font></font></font></h3><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">ostree is entirely oriented around bootable filesystem trees; its “source of truth” is the bootloader entries. It has opinions about where the Linux kernel binaries are stored (the current standard is in <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/usr/lib/modules/$kver</code>.)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">ostree 完全围绕可引导的文件系统树进行设计；它的“真相来源”是引导加载程序条目。它对 Linux 内核二进制文件存储的位置有自己的看法（当前标准是在 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/usr/lib/modules/$kver</code> 中。）</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">In contrast, traditional RPM is unaware of what a kernel is; it’s just another package. Most higher level package managers such as yum gained some special casing around the kernel - because it’s not possible to restart the running kernel, traditional RPM systems need to keep the kernel modules for the running kernel around. For example yum/dnf have a concept of “installonlyn” which defaults to 2 for the kernel package.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">相比之下，传统的 RPM 不知道什么是内核；它只是另一个软件包。大多数高级软件包管理器（如 yum）在内核周围增加了一些特殊处理 - 因为无法重新启动正在运行的内核，传统的 RPM 系统需要保留正在运行的内核模块。例如 yum/dnf 有一个“installonlyn”的概念，默认为 2 用于内核软件包。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Additionally, for at least traditional Fedora derivatives with yum/dnf, the initramfs is generated client side as part of a kernel update.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">另外，至少对于使用 yum/dnf 的传统 Fedora 派生版，initramfs 是作为内核更新的一部分在客户端生成的。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">But for rpm-ostree, the decision was made to default to a pre-generated initramfs by default. Further, in order to implement transactional upgrades, rpm-ostree needs to be in control of the initramfs regeneration - it can’t just be a script forked off without its knowledge.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">但是对于 rpm-ostree，决定默认使用预生成的 initramfs。此外，为了实现事务性升级，rpm-ostree 需要控制 initramfs 的重新生成 - 不能只是一个没有知识的脚本分支。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Further for rpm-ostree, easily replacing the kernel (as well as userspace) is intended to be a first-class operation; you need to be able to do that in order to debug production issues for example.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">对于 rpm-ostree，轻松替换内核（以及用户空间）被设计为一种一流操作；例如，您需要能够这样做以便调试生产问题。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">In contrast to the yum/dnf “installonly” for ostree there can be exactly one kernel per userspace filesystem tree. To ostree, a “bootable ostree commit” is the pair of (kernel, userspace).<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">与 yum/dnf 的“installonly”相比，ostree 中每个用户空间文件系统树只能有一个内核。对于 ostree，一个“可引导的 ostree 提交”是（内核，用户空间）的一对。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">rpm-ostree combines these two worlds, and goes to some lengths to bend the libdnf stack to work this way. We reset the “installonly” limit back to 1 to ensure we have exactly one kernel. PR: https://github.com/coreos/rpm-ostree/pull/1228<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">rpm-ostree 结合了这两个世界，并且竭尽全力弯曲 libdnf 堆栈以使其按照这种方式工作。我们将“installonly”限制重置为 1，以确保我们只有一个内核。PR: https://github.com/coreos/rpm-ostree/pull/1228</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Further, as noted above rpm-ostree takes over the handling of invoking <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">dracut</code> - just like other scripts, it is run inside a container with just read-only access to the system. <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">dracut</code> generates the initramfs CPIO archive, which we then place inside the <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/usr/lib/modules/$kver</code> location.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此外，如上所述，rpm-ostree 接管了调用 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">dracut</code> 的处理方式 - 就像其他脚本一样，它在一个容器内运行，只能以只读方式访问系统。 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">dracut</code> 生成 initramfs CPIO 归档文件，然后我们将其放置在 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/usr/lib/modules/$kver</code> 位置。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">If client-side initramfs regeneration is enabled, we may selectively provide desired configuration files into this process. PR: https://github.com/coreos/rpm-ostree/pull/2170<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果启用了客户端端 initramfs 重新生成，我们可以有选择性地将所需的配置文件提供给此过程。PR: https://github.com/coreos/rpm-ostree/pull/2170</font></font></font></p><h3 id="selinux" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> <a href="#selinux" class="anchor-heading" aria-labelledby="selinux" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SELinux</h3><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Handling SELinux is very tricky, because it is a package that can affect <em data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">every other package</em>. Specifically, the SELinux policy package contains a vast set of regular expressions in <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">file_contexts</code> to determine labeling.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">处理 SELinux 非常棘手，因为它是一个可以影响每个其他软件包的软件包。具体来说，SELinux 策略软件包包含大量的正则表达式，用于确定标签。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">For traditional librpm, this is a plugin.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">对于传统的 librpm，这是一个插件。</font></font></font></p><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">A major goal of OSTree from the start has been to ensure fully correct handling of SELinux for the base operating system. The way rpm-ostree handles this is by:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">从一开始，OSTree 的一个主要目标就是确保基本操作系统对 SELinux 的完全正确处理。rpm-ostree 处理这个的方式是：</font></font></font></p><ul data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Recompiling the policy as a <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%posttrans</code> equivalent<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">重新编译策略作为一个 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">%posttrans</code> 等价物</font></font></font></li><li data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Loading the policy from the target root, and pass that loaded policy to libostree, which consults it to use for the label of each committed file.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">从目标根目录加载策略，并将加载的策略传递给 libostree，libostree 会查询它以用于每个提交文件的标签。</font></font></font></li></ul><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">This means that on an OSTree based system, the labels for the files in the booted deployment (e.g. in <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/usr</code>) are always correct and set atomically - there’s no need to relabel.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这意味着在基于 OSTree 的系统上，引导部署中文件的标签（例如在 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/usr</code> 中）始终是正确的并原子设置的 - 无需重新标记。</font></font></font></p><h4 id="selinux-policy-storage-location" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1"> <a href="#selinux-policy-storage-location" class="anchor-heading" aria-labelledby="selinux-policy-storage-location" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SELinux policy storage location<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">SELinux 策略存储位置</font></font></font></h4><p data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Another major difference between traditional yum/dnf and rpm-ostree based systems is the location of the SELinux policy store database itself. rpm-ostree overrides it to be back in <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/etc</code>, when it was moved to <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/var</code> in the RPM package around the Fedora 24 timeframe. For more information see https://bugzilla.redhat.com/show_bug.cgi?id=1290659 and the comments in <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">rpmostree-postprocess.cxx</code>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">传统的 yum/dnf 和基于 rpm-ostree 的系统之间的另一个主要区别是 SELinux 策略存储数据库本身的位置。在 Fedora 24 时间段左右，rpm-ostree 将其覆盖为回到 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/etc</code> ，而在 RPM 软件包中将其移动到 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">/var</code> 。有关更多信息，请参阅 https://bugzilla.redhat.com/show_bug.cgi?id=1290659 和 <code class="language-plaintext highlighter-rouge" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">rpmostree-postprocess.cxx</code> 中的评论。</font></font></font></p></main><hr><footer data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><p class="text-small text-grey-dk-100 mb-0" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Copyright © <a href="https://www.redhat.com" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">Red Hat, Inc.</a> and <a href="https://github.com/coreos" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0">others</a>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">版权所有 © 红帽公司及其他。</font></font></font></p><div class="d-flex mt-2" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"><p class="text-small text-grey-dk-000 mb-0" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"> <a href="https://github.com/coreos/rpm-ostree/tree/main/docs/architecture-core.md" id="edit-this-page" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0" data-immersive-translate-paragraph="1">Edit this page on GitHub<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在 GitHub 上编辑此页面</font></font></font></a></p></div></footer></div></div><div class="search-overlay" data-immersive-translate-walked="cc087aba-b413-4adb-8fc1-791e695532e0"></div></div>
</body></html>