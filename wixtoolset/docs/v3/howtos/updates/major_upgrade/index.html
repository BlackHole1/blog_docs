<html><head><style data-id="immersive-translate-default-injected-css">:root {
  --immersive-translate-theme-underline-borderColor: #72ece9;
  --immersive-translate-theme-nativeUnderline-borderColor: #72ece9;
  --immersive-translate-theme-nativeDashed-borderColor: #72ece9;
  --immersive-translate-theme-nativeDotted-borderColor: #72ece9;
  --immersive-translate-theme-highlight-backgroundColor: #ffff00;
  --immersive-translate-theme-dashed-borderColor: #59c1bd;
  --immersive-translate-theme-blockquote-borderColor: #cc3355;
  --immersive-translate-theme-thinDashed-borderColor: #ff374f;
  --immersive-translate-theme-dashedBorder-borderColor: #94a3b8;
  --immersive-translate-theme-dashedBorder-borderRadius: 0;
  --immersive-translate-theme-solidBorder-borderColor: #94a3b8;
  --immersive-translate-theme-solidBorder-borderRadius: 0;
  --immersive-translate-theme-dotted-borderColor: #94a3b8;
  --immersive-translate-theme-wavy-borderColor: #72ece9;
  --immersive-translate-theme-dividingLine-borderColor: #94a3b8;
  --immersive-translate-theme-grey-textColor: #2f4f4f;
  --immersive-translate-theme-marker-backgroundColor: #fbda41;
  --immersive-translate-theme-marker-backgroundColor-rgb: 251, 218, 65;
  --immersive-translate-theme-marker2-backgroundColor: #ffff00;
  --immersive-translate-theme-opacity-opacity: 10;
}

.immersive-translate-target-translation-pre-whitespace {
  white-space: pre-wrap !important;
}

.immersive-translate-pdf-target-container {
  position: absolute;
  background-color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
    sans-serif;
  top: 0;
  width: 600px;
  height: 100%;
  z-index: 2;
  line-height: 1.3;
  font-size: 16px;
}
.immersive-translate-target-wrapper[dir='rtl'] {
  text-align: right;
}

.immersive-translate-pdf-target-container .immersive-translate-target-wrapper {
  color: rgb(0, 0, 0);
  white-space: normal;
  position: absolute;
}

.immersive-translate-pdf-target-container .immersive-translate-target-wrapper font {
  color: inherit;
  white-space: inherit;
  position: unset;
}

.immersive-translate-state-dual>br {
  display: none;
}

.immersive-translate-target-translation-block-wrapper {
  margin: 8px 0 !important;
  display: inline-block;
}

.immersive-translate-target-translation-pdf-block-wrapper {
  margin: 0 !important;
  display: block;
}

.immersive-translate-target-translation-theme-grey-inner {
  color: var(--immersive-translate-theme-grey-textColor);
}


.immersive-translate-target-translation-theme-underline-inner {
  border-bottom: 1px solid var(--immersive-translate-theme-underline-borderColor) !important;
}

.immersive-translate-target-translation-theme-nativeUnderline-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeUnderline-borderColor) !important;
}

.immersive-translate-target-translation-block-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

.immersive-translate-target-translation-inline-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
  padding: 2px;
}

.immersive-translate-target-translation-block-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

.immersive-translate-target-translation-inline-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
  padding: 2px;
}

.immersive-translate-target-translation-theme-nativeDashed-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeDashed-borderColor) !important;
  text-decoration-style: dashed !important;
}

.immersive-translate-target-translation-theme-thinDashed-inner {
  border-bottom: 1px dashed var(--immersive-translate-theme-thinDashed-borderColor) !important;
}

.immersive-translate-target-translation-theme-dotted-inner {
  background-image: linear-gradient(to right,
      var(--immersive-translate-theme-dotted-borderColor) 30%,
      rgba(255, 255, 255, 0) 0%);
  background-position: bottom;
  background-size: 5px 1px;
  background-repeat: repeat-x;
  padding-bottom: 3px;
}

.immersive-translate-target-translation-theme-nativeDotted-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeDotted-borderColor) !important;
  text-decoration-style: dotted !important;
}

.immersive-translate-target-translation-theme-wavy-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-wavy-borderColor) !important;
  text-decoration-style: wavy !important;
}

.immersive-translate-target-translation-theme-dashed-inner {
  background: linear-gradient(to right,
      var(--immersive-translate-theme-dashed-borderColor) 0%,
      var(--immersive-translate-theme-dashed-borderColor) 50%,
      transparent 50%,
      transparent 100%) repeat-x left bottom;
  background-size: 8px 2px;
  padding-bottom: 2px;
}

.immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
  content: "";
  display: block;
  max-width: 80px;
  width: 10%;
  border-top: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
  padding-top: 8px;
}

.immersive-translate-target-translation-inline-wrapper-theme-dividingLine::before {
  content: "";
  border-left: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
  max-height: 16px;
  height: 16px;
  padding-left: 8px;
}

.immersive-translate-target-translation-theme-highlight-inner {
  background: var(--immersive-translate-theme-highlight-backgroundColor);
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

.immersive-translate-target-translation-block-wrapper-theme-marker {
  line-height: 1.5em;
}

.immersive-translate-target-translation-theme-marker2-inner {
  font-weight: bold;
  text-shadow: 10px 0px 3px var(--immersive-translate-theme-marker2-backgroundColor),
    16px 3px 9px var(--immersive-translate-theme-marker2-backgroundColor),
    2px 0px 6px var(--immersive-translate-theme-marker2-backgroundColor),
    -12px 0px 12px var(--immersive-translate-theme-marker2-backgroundColor) !important;
}

.immersive-translate-target-translation-theme-marker-inner {
  /* TODO: add more texture */
  background: linear-gradient(to right,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.1),
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 3%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 35%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 70%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.8) 95%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.3));
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

.immersive-translate-target-translation-theme-weakening {
  opacity: 0.618 !important;
}

.immersive-translate-target-translation-theme-italic {
  font-style: italic !important;
}

.immersive-translate-target-translation-theme-bold {
  font-weight: bold !important;
}

.immersive-translate-target-translation-block-wrapper-theme-paper {
  margin: 8px 0;
  box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
  padding: 16px 32px;
  display: block;
}

.immersive-translate-target-translation-block-wrapper-theme-blockquote {
  border-left: 4px solid var(--immersive-translate-theme-blockquote-borderColor) !important;
  padding-left: 12px !important;
  margin-top: 4px;
  margin-bottom: 4px;
  padding-top: 4px;
  padding-bottom: 4px;
  display: block;
}

.immersive-translate-target-translation-theme-mask-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-mask-inner {
  filter: none !important;
}

[data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}


/* opacity theme start */

.immersive-translate-target-translation-theme-opacity-inner {
  filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-opacity-inner {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner,.immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

.immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: none !important;
}


.immersive-translate-target-translation-theme-mask-inner:hover {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner:hover {
  filter: none !important;
}


[data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner:hover {
  filter: none !important;
}

/* opacity theme end */

/* vertical css , please remain it in the last one. */
.immersive-translate-target-translation-vertical-block-wrapper {
  margin: 0px 8px !important;
}

.immersive-translate-text {
  font-size: 15px !important;
}

.immersive-translate-error-toast {
  position: fixed;
  top: 5%;
  z-index: 99999999;
  left: 0;
  right: 0;
  margin: auto;
  max-width: 300px;
  padding: 16px;
  border-radius: 12px;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  flex-direction: row;
  justify-content: space-between;
}

@media all and (min-width: 750px) {
  .immersive-translate-error-toast {
    max-width: 400px;
  }
}


.immersive-translate-clickable-button {
  cursor: pointer;
}

.immersive-translate-help-button {
  cursor: pointer;
}

.immersive-translate-loading-text:before {
  content: "...";
}


/* dark mode for loading */

@media only screen and (prefers-color-scheme: dark) {
  .immersive-translate-loading {
    border: 2px rgba(255, 255, 255, 0.25) solid !important;
    border-top: 2px rgba(255, 255, 255, 1) solid !important;
  }
}

.immersive-translate-error-wrapper {
  position: relative;
  display: inline-flex;
  padding: 6px;
  margin: 0 12px;
  white-space: nowrap;
  font-size: 0.9em;
}
[lang="zh-CN"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}
[lang="zh-TW"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}


.immersive-translate-tooltip {
  position: relative;
  display: inline-flex;
  /* little indicater to indicate it's hoverable */
}

.immersive-translate-tooltip-content {
  /* here's the magic */
  position: absolute;
  z-index: 100000000000;

  left: 50%;
  bottom: 0;
  transform: translate(-50%, 110%);
  line-height: 1;
  /* and add a small left margin */

  /* basic styles */
  width: max-content;
  max-width: 250px;
  word-wrap: break-word;
  white-space: pre-line;
  padding: 10px;
  border-radius: 10px;
  background: #000C;
  color: #fff;
  text-align: center;
  font-size: 14px;
  display: none;
  /* hide by default */
}

.immersive-translate-tooltip:hover .immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip:hover+.immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip-content-table {
  left: unset !important;
  bottom: unset !important;
  transform: translate(-10%, 50%) !important;
}


.immersive-translate-tooltip:hover:before {
  display: block;
}



.immersive-translate-loading-spinner {
  vertical-align: middle !important;
  width: 10px !important;
  height: 10px !important;
  display: inline-block !important;
  margin: 0 4px !important;
  border: 2px rgba(221, 244, 255, 0.6) solid !important;
  border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-radius: 50% !important;
  padding: 0 !important;
  -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
  animation: immersive-translate-loading-animation 0.6s infinite linear !important;
}

@-webkit-keyframes immersive-translate-loading-animation {
  from {
    -webkit-transform: rotate(0deg);
  }

  to {
    -webkit-transform: rotate(359deg);
  }
}

@keyframes immersive-translate-loading-animation {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(359deg);
  }
}
</style><style data-id="immersive-translate-user-custom-style">:root {

.immersive-translate-target-inner { font-family: inherit; }
}
</style><style data-id="immersive-translate-dynamic-injected-css">.immersive-translate-target-wrapper[dir='rtl'] {text-align: right;}
.immersive-translate-target-wrapper[dir='rtl'] [data-immersive-translate-class-bak*='block-wrapper'] {display:block;}
.immersive-translate-target-wrapper {word-break: break-word;}
</style></head><body data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">


<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">How To: Implement a Major Upgrade In Your Installer | WiX Toolset</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.bugs.cc/wixtoolset/docs/v3/howtos/updates/major_upgrade/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v3"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v3"><meta data-rh="true" name="docsearch:version" content="v3"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v3"><meta data-rh="true" property="og:title" content="How To: Implement a Major Upgrade In Your Installer | WiX Toolset"><meta data-rh="true" name="description" content="When creating an .msi-based installer, you are strongly encouraged to include logic that supports Windows Installer major upgrades. Major upgrades are the most common form of updates for .msi's, and including support in your initial .msi release gives you flexibility in the future. Without including support for major upgrades you risk greatly complicating your distribution story if you ever need to release updates later on."><meta data-rh="true" property="og:description" content="When creating an .msi-based installer, you are strongly encouraged to include logic that supports Windows Installer major upgrades. Major upgrades are the most common form of updates for .msi's, and including support in your initial .msi release gives you flexibility in the future. Without including support for major upgrades you risk greatly complicating your distribution story if you ever need to release updates later on."><link data-rh="true" rel="icon" href="/wixtoolset/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.bugs.cc/wixtoolset/docs/v3/howtos/updates/major_upgrade/"><link data-rh="true" rel="alternate" href="https://docs.bugs.cc/wixtoolset/docs/v3/howtos/updates/major_upgrade/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.bugs.cc/wixtoolset/docs/v3/howtos/updates/major_upgrade/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/wixtoolset/news/rss.xml" title="WiX Toolset RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/wixtoolset/news/atom.xml" title="WiX Toolset Atom Feed"><link rel="stylesheet" href="/wixtoolset/assets/css/styles.f38540a7.css">
<link rel="preload" href="/wixtoolset/assets/js/runtime~main.d4837c13.js" as="script">
<link rel="preload" href="/wixtoolset/assets/js/main.81f55813.js" as="script">


<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">
<div role="region" aria-label="Skip to main content" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Skip to main content<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">跳到主要内容</font></font></font></a></div><div class="announcementBar_mb4j" style="background-color:#C70039;color:#fff" role="banner" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="announcementBarPlaceholder_vyr4" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"></div><div class="content_knG7 announcementBarContent_xLdY" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><span style="font-size:16px" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Get the latest WiX news sent to you. <a style="text-decoration-line:none;border-bottom:1px solid" href="https://www.firegiant.com/subscribe/?utm_source=wixtoolset.org&amp;utm_medium=Display&amp;utm_campaign=subscribe&amp;utm_term=subscribe&amp;utm_content=announcement_bar" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">Subscribe to the FireGiant newsletter.</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">获取最新的 WiX 新闻。订阅 FireGiant 通讯。</font></font></font></span></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="navbar__inner" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="navbar__items" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/wixtoolset/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="navbar__logo" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><img src="/wixtoolset/img/logo-white-hollow-xs.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA" width="53.6171875" height="22.5" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><img src="/wixtoolset/img/logo-black-hollow-xs.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU" width="53.6171875" height="22.5" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"></div><b class="navbar__title text--truncate" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">WiX Toolset<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">WiX 工具集</font></font></font></b></a></div><div class="navbar__items navbar__items--right" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1"><a class="navbar__item navbar__link" href="/wixtoolset/news/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">News</a><a class="navbar__item navbar__link" href="/wixtoolset/docs/intro/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">Docs</a><a href="https://github.com/wixtoolset/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.firegiant.com/services/?utm_source=wixtoolset.org&amp;utm_medium=Display&amp;utm_term=enterprise+support&amp;utm_content=header" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">Enterprise Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">新闻 文档 GitHub 企业支持</font></font></font><div class="toggle_vylO colorModeToggle_DEke" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="dsla-search-wrapper" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="dsla-search-field" data-tags="default,docs-default-v3" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="container padding-top--md padding-bottom--lg" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="row" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="col docItemCol_VOVn" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">This is documentation for <!-- -->WiX Toolset<!-- --> <b data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">v3</b>, which is no longer actively maintained.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这是 WiX Toolsetv3 的文档，不再积极维护。</font></font></font></div><div class="margin-top--md" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">For up-to-date documentation, see the <b data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a href="/wixtoolset/docs/intro/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">latest version</a></b> (<!-- -->v4.0<!-- -->).<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">有关最新文档，请参阅最新版本（v4.0）。</font></font></font></div></div><div class="docItemContainer_Djhp" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><article data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><span class="theme-doc-version-badge badge badge--secondary" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Version: v3<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">版本：v3</font></font></font></span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><h1 data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">How To: Implement a Major Upgrade In Your Installer<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如何：在安装程序中实施重大升级</font></font></font></h1><p data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">When creating an .msi-based installer, you are strongly encouraged to include logic that supports <a href="http://msdn.microsoft.com/library/aa369786.aspx" target="_blank" rel="noopener noreferrer" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">Windows Installer major upgrades</a>. Major upgrades are the most common form of updates for .msi's, and including support in your initial .msi release gives you flexibility in the future. Without including support for major upgrades you risk greatly complicating your distribution story if you ever need to release updates later on.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在创建基于.msi 的安装程序时，强烈建议您包含支持 Windows Installer 重大升级的逻辑。重大升级是.msi 最常见的更新形式，在初始.msi 版本中包含支持可以为将来提供灵活性。如果不包括对重大升级的支持，您在以后需要发布更新时可能会大大复杂化您的分发故事。</font></font></font></p><p data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">You can use the following steps to enable major upgrades in your .msi, build multiple versions of your .msi and test major upgrade scenarios.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">您可以使用以下步骤在.msi 中启用重大升级，构建.msi 的多个版本并测试重大升级场景。</font></font></font></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-add-upgrade-information-needed-to-cause-new-versions-to-upgrade-older-versions" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Step 1: Add upgrade information needed to cause new versions to upgrade older versions<a href="#step-1-add-upgrade-information-needed-to-cause-new-versions-to-upgrade-older-versions" class="hash-link" aria-label="Direct link to Step 1: Add upgrade information needed to cause new versions to upgrade older versions" title="Direct link to Step 1: Add upgrade information needed to cause new versions to upgrade older versions" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">第一步：添加升级信息以使新版本升级旧版本</font></font></font></h2><p data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">In order to allow major upgrades, you must include the following information in your .msi:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">为了允许重大升级，您必须在.msi 中包含以下信息：</font></font></font></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-a-unique-id-to-identify-that-the-product-can-be-upgraded" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Add a unique ID to identify that the product can be upgraded<a href="#add-a-unique-id-to-identify-that-the-product-can-be-upgraded" class="hash-link" aria-label="Direct link to Add a unique ID to identify that the product can be upgraded" title="Direct link to Add a unique ID to identify that the product can be upgraded" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">添加一个唯一的 ID 以识别产品可以升级</font></font></font></h3><p data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">To accomplish this, you must include an UpgradeCode attribute in your <a href="/wixtoolset/docs/v3/xsd/wix/product/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">Product</a> element. This looks like the following:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">为了实现这一点，您必须在产品元素中包含一个 UpgradeCode 属性。这看起来如下所示：</font></font></font></p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">Product</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">Id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">*</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name" style="color:#00a4db">UpgradeCode</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">PUT-GUID-HERE</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name" style="color:#00a4db">Name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">My Application Name</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name" style="color:#00a4db">Language</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">1033</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name" style="color:#00a4db">Version</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">1.0.1</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name" style="color:#00a4db">Manufacturer</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">My Manufacturer Name</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="schedule-the-removal-of-old-versions-and-handle-out-of-order-installations" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Schedule the removal of old versions and handle out-of-order installations<a href="#schedule-the-removal-of-old-versions-and-handle-out-of-order-installations" class="hash-link" aria-label="Direct link to Schedule the removal of old versions and handle out-of-order installations" title="Direct link to Schedule the removal of old versions and handle out-of-order installations" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">安排删除旧版本并处理乱序安装</font></font></font></h3><p data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">The <a href="/wixtoolset/docs/v3/xsd/wix/majorupgrade/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">MajorUpgrade</a> element upgrades all older versions of the .msi. By default, it prevents out-of-order installations: installing an older version after installing a newer version.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">MajorUpgrade 元素升级所有旧版本的.msi。默认情况下，它会阻止乱序安装：在安装新版本后安装旧版本。</font></font></font></p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">MajorUpgrade</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">  </span><span class="token tag attr-name" style="color:#00a4db">DowngradeErrorMessage</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">A later version of [ProductName] is already installed. Setup will now exit.</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">There are several options for where you can schedule the <a href="/wixtoolset/docs/v3/xsd/wix/removeexistingproducts/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">RemoveExistingProducts</a> action to remove old versions of the .msi. You need to review the options and choose the one that makes the most sense for your scenarios. You can find a summary of the options in the <a href="http://msdn.microsoft.com/library/aa371197.aspx" target="_blank" rel="noopener noreferrer" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">RemoveExistingProducts documentation</a>.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">有几种选择可以安排 RemoveExistingProducts 操作来删除旧版本的 .msi。您需要查看这些选项并选择最适合您场景的选项。您可以在 RemoveExistingProducts 文档中找到这些选项的摘要。</font></font></font></p><p data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">By default, MajorUpgrade schedules RemoveExistingProducts after InstallValidate. You can change the scheduling using the Schedule attribute. For example, If you choose to schedule it after <a href="/wixtoolset/docs/v3/xsd/wix/installinitialize/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">InstallInitialize</a>, it will look like the following:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">默认情况下，MajorUpgrade 在 InstallValidate 之后安排 RemoveExistingProducts。您可以使用 Schedule 属性更改调度。例如，如果您选择在 InstallInitialize 之后安排它，它将如下所示：</font></font></font></p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">MajorUpgrade</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">  </span><span class="token tag attr-name" style="color:#00a4db">Schedule</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">afterInstallInitialize</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">  </span><span class="token tag attr-name" style="color:#00a4db">DowngradeErrorMessage</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">A later version of [ProductName] is already installed. Setup will now exit.</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Windows Installer looks for other installed .msi files with the same UpgradeCode value during the <a href="/wixtoolset/docs/v3/xsd/wix/findrelatedproducts/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">FindRelatedProducts</a> action. If you do not specifically schedule the <a href="/wixtoolset/docs/v3/xsd/wix/findrelatedproducts/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">FindRelatedProducts</a> action in your setup authoring, WiX will automatically schedule it for you when it creates your .msi.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Windows Installer 在 FindRelatedProducts 操作期间查找具有相同 UpgradeCode 值的其他已安装 .msi 文件。如果您没有在设置编写中专门安排 FindRelatedProducts 操作，WiX 会在创建 .msi 时自动为您安排。</font></font></font></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-build-version-1-and-version-2-of-your-msi" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Step 2: Build version 1 and version 2 of your .msi<a href="#step-2-build-version-1-and-version-2-of-your-msi" class="hash-link" aria-label="Direct link to Step 2: Build version 1 and version 2 of your .msi" title="Direct link to Step 2: Build version 1 and version 2 of your .msi" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">第 2 步：构建版本 1 和版本 2 的.msi</font></font></font></h2><p data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Creating version 1 of your .msi is as simple as running your standard build process - this means you compile and link it with the WiX toolset. In order to create version 2 of your .msi, you must make the following changes to your setup authoring, then re-run your build process to create a new .msi:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">创建版本 1 的.msi 就像运行标准构建过程一样简单——这意味着你需要使用 WiX 工具集进行编译和链接。为了创建版本 2 的.msi，你必须对安装程序进行以下更改，然后重新运行构建过程以创建新的.msi：</font></font></font></p><ul data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><li data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Increment the Version value in your <a href="/wixtoolset/docs/v3/xsd/wix/product/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">Product</a> element to be higher than any previous versions that you have shipped. Windows Installer only uses the first 3 parts of the version in upgrade scenarios, so make sure to increment your version such that one of the first 3 parts is higher than any previously shipped version. For example, if your version 1 uses Version value 1.0.1.0, then version 2 should have a Version value of 1.0.2.0 or higher (1.0.1.1 will not work here).<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将 Product 元素中的版本值增加到高于你已发布的任何先前版本。Windows Installer 在升级场景中只使用版本的前 3 部分，因此请确保增加版本值，使前 3 部分中的一个高于任何先前发布的版本。例如，如果你的版本 1 使用版本值 1.0.1.0，那么版本 2 应具有 1.0.2.0 或更高的版本值（1.0.1.1 在这里不起作用）。</font></font></font></li><li data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1"><a href="/wixtoolset/docs/v3/howtos/general/generate_guids/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">Generate a new Id value</a> in the <a href="/wixtoolset/docs/v3/xsd/wix/product/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">Product</a> element of the new version of the .msi.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在新版本的.msi 的 Product 元素中生成一个新的 Id 值。</font></font></font></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-test-upgrade-scenarios-before-you-ship-version-1" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Step 3: Test upgrade scenarios before you ship version 1<a href="#step-3-test-upgrade-scenarios-before-you-ship-version-1" class="hash-link" aria-label="Direct link to Step 3: Test upgrade scenarios before you ship version 1" title="Direct link to Step 3: Test upgrade scenarios before you ship version 1" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">第三步：在发布版本 1 之前测试升级场景</font></font></font></h2><p data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">This step is very important and is too often ignored. In order to make sure that upgrade scenarios will behave the way you expect, you should test upgrades before you ship the first version of your .msi. There are some upgrade-related bugs that can be fixed purely by making fixes in version 2 or higher of your .msi, but there are some bugs that affect the uninstall of version 1 that must be fixed before you ship version 1. Once version 1 ships, you are essentially locked into the uninstall behavior that you ship with version 1, and that impacts major upgrade scenarios because Windows Installer performs an uninstall of version 1 behind the scenes during version 2 installation.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这一步非常重要，但经常被忽视。为了确保升级场景按预期运行，您应该在发布第一个版本的.msi 之前测试升级。有些与升级相关的错误可以通过在.msi 的第 2 版或更高版本中进行修复来解决，但有些错误会影响第 1 版的卸载，必须在发布第 1 版之前修复。一旦第 1 版发布，您基本上就被锁定在第 1 版的卸载行为中，这会影响主要的升级场景，因为 Windows Installer 在安装第 2 版期间会在后台执行第 1 版的卸载。</font></font></font></p><p data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Here are some interesting scenarios to test:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这里有一些有趣的测试场景：</font></font></font></p><ul data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><li data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Install version 1, then install version 2.  Make sure that version 1 is correctly removed and version 2 functions correctly.  Make sure version 2 cleanly uninstalls afterwards.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">安装版本 1，然后安装版本 2。确保版本 1 被正确移除且版本 2 正常运行。确保版本 2 之后可以干净地卸载。</font></font></font></li><li data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Install version 2, then try to install version 1.  Make sure that version 1 correctly detects that version 2 is already installed and either blocks or silently exits, depending on what behavior you choose to implement for your out-of-order installation scenarios.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">安装版本 2，然后尝试安装版本 1。确保版本 1 正确检测到版本 2 已经安装，并根据您选择的行为，要么阻止安装，要么静默退出，以应对您的乱序安装场景。</font></font></font></li></ul><p data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">When testing major upgrade scenarios, make sure to pay particular attention to the conditions on custom actions in your .msi because you may run into issues caused by custom actions running during a major upgrade uninstall and leaving your product in a partially installed state. The <a href="http://msdn.microsoft.com/library/aa372380.aspx" target="_blank" rel="noopener noreferrer" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">UPGRADINGPRODUCTCODE property</a> can be useful to prevent actions from running during an uninstall that is invoked by the <a href="/wixtoolset/docs/v3/xsd/wix/removeexistingproducts/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">RemoveExistingProducts</a> action.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在测试主要升级场景时，请特别注意.msi 中自定义操作的条件，因为在主要升级卸载期间运行的自定义操作可能会导致问题，并使您的产品处于部分安装状态。UPGRADINGPRODUCTCODE 属性可以防止在由 RemoveExistingProducts 操作调用的卸载期间运行的操作。</font></font></font></p><p data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">In addition, pay attention to assemblies that need to be installed to the GAC or the Win32 WinSxS store. There is some information about a sequence of events that can remove assemblies from the GAC and the WinSxS store during some major upgrades in <a href="http://support.microsoft.com/kb/905238" target="_blank" rel="noopener noreferrer" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">this knowledge base article</a>.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此外，请注意需要安装到 GAC 或 Win32 WinSxS 存储的程序集。本文知识库中有一些关于在某些主要升级期间从 GAC 和 WinSxS 存储中删除程序集的事件顺序的信息。</font></font></font></p></div><footer class="theme-doc-footer docusaurus-mt-lg" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="theme-doc-footer-edit-meta-row row" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="col" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a href="https://github.com/wixtoolset/web/tree/master/src/Docusaurus/versioned_docs/version-v3/howtos/updates/major_upgrade.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">编辑此页面</font></font></font></a></div><div class="col lastUpdated_vwxv" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"></nav></div></div><div class="col col--3" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><ul class="table-of-contents table-of-contents__left-border" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><li data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a href="#step-1-add-upgrade-information-needed-to-cause-new-versions-to-upgrade-older-versions" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Step 1: Add upgrade information needed to cause new versions to upgrade older versions<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">第一步：添加升级信息以使新版本升级旧版本</font></font></font></a><ul data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><li data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a href="#add-a-unique-id-to-identify-that-the-product-can-be-upgraded" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Add a unique ID to identify that the product can be upgraded<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">添加一个唯一的 ID 以识别产品可以升级</font></font></font></a></li><li data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a href="#schedule-the-removal-of-old-versions-and-handle-out-of-order-installations" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Schedule the removal of old versions and handle out-of-order installations<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">安排删除旧版本并处理乱序安装</font></font></font></a></li></ul></li><li data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a href="#step-2-build-version-1-and-version-2-of-your-msi" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Step 2: Build version 1 and version 2 of your .msi<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">第 2 步：构建版本 1 和版本 2 的.msi</font></font></font></a></li><li data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a href="#step-3-test-upgrade-scenarios-before-you-ship-version-1" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Step 3: Test upgrade scenarios before you ship version 1<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">步骤 3：在发布版本 1 之前测试升级方案</font></font></font></a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="container container-fluid" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="row footer__links" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="col footer__col" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="footer__title" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"></div><ul class="footer__items clean-list" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><li class="footer__item" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">
                  <p class="footer_label" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Support provided by<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">提供的支持</font></font></font></p>
                  <a href="https://www.firegiant.com/?utm_source=wixtoolset.org&amp;utm_medium=Display&amp;utm_content=footer" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">
                    <img src="/img/firegiant.png" alt="FireGiant" width="83.6875" height="22.5" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e">
                  </a>
                </li></ul></div><div class="col footer__col" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="footer__title" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Community<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">社区</font></font></font></div><ul class="footer__items clean-list" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><li class="footer__item" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a href="https://stackoverflow.com/questions/tagged/wix" target="_blank" rel="noopener noreferrer" class="footer__link-item" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Stack Overflow<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Stack 溢出</font></font></font><svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a href="https://www.youtube.com/wixtoolset" target="_blank" rel="noopener noreferrer" class="footer__link-item" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a href="https://twitter.com/wixtoolset" target="_blank" rel="noopener noreferrer" class="footer__link-item" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Twitter<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">推特</font></font></font><svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="footer__title" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">More<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">更多</font></font></font></div><ul class="footer__items clean-list" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><li class="footer__item" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a class="footer__link-item" href="/wixtoolset/news/" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">News<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">新闻</font></font></font></a></li><li class="footer__item" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a href="https://www.firegiant.com/services/" target="_blank" rel="noopener noreferrer" class="footer__link-item" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Enterprise<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">企业</font></font></font><svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><a href="https://github.com/wixtoolset/web" target="_blank" rel="noopener noreferrer" class="footer__link-item" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e"><div class="footer__copyright" data-immersive-translate-walked="fb703885-da81-4fdc-b1e5-0abf26f5c09e" data-immersive-translate-paragraph="1">Copyright © 2024 .NET Foundation and contributors.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">版权所有 © 2024 .NET 基金会及贡献者。</font></font></font></div></div></div></footer></div>
<script src="/wixtoolset/assets/js/runtime~main.d4837c13.js"></script>
<script src="/wixtoolset/assets/js/main.81f55813.js"></script>

</body></html>