<html><head><style data-id="immersive-translate-default-injected-css">:root {
  --immersive-translate-theme-underline-borderColor: #72ece9;
  --immersive-translate-theme-nativeUnderline-borderColor: #72ece9;
  --immersive-translate-theme-nativeDashed-borderColor: #72ece9;
  --immersive-translate-theme-nativeDotted-borderColor: #72ece9;
  --immersive-translate-theme-highlight-backgroundColor: #ffff00;
  --immersive-translate-theme-dashed-borderColor: #59c1bd;
  --immersive-translate-theme-blockquote-borderColor: #cc3355;
  --immersive-translate-theme-thinDashed-borderColor: #ff374f;
  --immersive-translate-theme-dashedBorder-borderColor: #94a3b8;
  --immersive-translate-theme-dashedBorder-borderRadius: 0;
  --immersive-translate-theme-solidBorder-borderColor: #94a3b8;
  --immersive-translate-theme-solidBorder-borderRadius: 0;
  --immersive-translate-theme-dotted-borderColor: #94a3b8;
  --immersive-translate-theme-wavy-borderColor: #72ece9;
  --immersive-translate-theme-dividingLine-borderColor: #94a3b8;
  --immersive-translate-theme-grey-textColor: #2f4f4f;
  --immersive-translate-theme-marker-backgroundColor: #fbda41;
  --immersive-translate-theme-marker-backgroundColor-rgb: 251, 218, 65;
  --immersive-translate-theme-marker2-backgroundColor: #ffff00;
  --immersive-translate-theme-opacity-opacity: 10;
}

.immersive-translate-target-translation-pre-whitespace {
  white-space: pre-wrap !important;
}

.immersive-translate-pdf-target-container {
  position: absolute;
  background-color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
    sans-serif;
  top: 0;
  width: 600px;
  height: 100%;
  z-index: 2;
  line-height: 1.3;
  font-size: 16px;
}
.immersive-translate-target-wrapper[dir='rtl'] {
  text-align: right;
}

.immersive-translate-pdf-target-container .immersive-translate-target-wrapper {
  color: rgb(0, 0, 0);
  white-space: normal;
  position: absolute;
}

.immersive-translate-pdf-target-container .immersive-translate-target-wrapper font {
  color: inherit;
  white-space: inherit;
  position: unset;
}

.immersive-translate-state-dual>br {
  display: none;
}

.immersive-translate-target-translation-block-wrapper {
  margin: 8px 0 !important;
  display: inline-block;
}

.immersive-translate-target-translation-pdf-block-wrapper {
  margin: 0 !important;
  display: block;
}

.immersive-translate-target-translation-theme-grey-inner {
  color: var(--immersive-translate-theme-grey-textColor);
}


.immersive-translate-target-translation-theme-underline-inner {
  border-bottom: 1px solid var(--immersive-translate-theme-underline-borderColor) !important;
}

.immersive-translate-target-translation-theme-nativeUnderline-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeUnderline-borderColor) !important;
}

.immersive-translate-target-translation-block-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

.immersive-translate-target-translation-inline-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
  padding: 2px;
}

.immersive-translate-target-translation-block-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

.immersive-translate-target-translation-inline-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
  padding: 2px;
}

.immersive-translate-target-translation-theme-nativeDashed-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeDashed-borderColor) !important;
  text-decoration-style: dashed !important;
}

.immersive-translate-target-translation-theme-thinDashed-inner {
  border-bottom: 1px dashed var(--immersive-translate-theme-thinDashed-borderColor) !important;
}

.immersive-translate-target-translation-theme-dotted-inner {
  background-image: linear-gradient(to right,
      var(--immersive-translate-theme-dotted-borderColor) 30%,
      rgba(255, 255, 255, 0) 0%);
  background-position: bottom;
  background-size: 5px 1px;
  background-repeat: repeat-x;
  padding-bottom: 3px;
}

.immersive-translate-target-translation-theme-nativeDotted-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeDotted-borderColor) !important;
  text-decoration-style: dotted !important;
}

.immersive-translate-target-translation-theme-wavy-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-wavy-borderColor) !important;
  text-decoration-style: wavy !important;
}

.immersive-translate-target-translation-theme-dashed-inner {
  background: linear-gradient(to right,
      var(--immersive-translate-theme-dashed-borderColor) 0%,
      var(--immersive-translate-theme-dashed-borderColor) 50%,
      transparent 50%,
      transparent 100%) repeat-x left bottom;
  background-size: 8px 2px;
  padding-bottom: 2px;
}

.immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
  content: "";
  display: block;
  max-width: 80px;
  width: 10%;
  border-top: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
  padding-top: 8px;
}

.immersive-translate-target-translation-inline-wrapper-theme-dividingLine::before {
  content: "";
  border-left: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
  max-height: 16px;
  height: 16px;
  padding-left: 8px;
}

.immersive-translate-target-translation-theme-highlight-inner {
  background: var(--immersive-translate-theme-highlight-backgroundColor);
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

.immersive-translate-target-translation-block-wrapper-theme-marker {
  line-height: 1.5em;
}

.immersive-translate-target-translation-theme-marker2-inner {
  font-weight: bold;
  text-shadow: 10px 0px 3px var(--immersive-translate-theme-marker2-backgroundColor),
    16px 3px 9px var(--immersive-translate-theme-marker2-backgroundColor),
    2px 0px 6px var(--immersive-translate-theme-marker2-backgroundColor),
    -12px 0px 12px var(--immersive-translate-theme-marker2-backgroundColor) !important;
}

.immersive-translate-target-translation-theme-marker-inner {
  /* TODO: add more texture */
  background: linear-gradient(to right,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.1),
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 3%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 35%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 70%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.8) 95%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.3));
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

.immersive-translate-target-translation-theme-weakening {
  opacity: 0.618 !important;
}

.immersive-translate-target-translation-theme-italic {
  font-style: italic !important;
}

.immersive-translate-target-translation-theme-bold {
  font-weight: bold !important;
}

.immersive-translate-target-translation-block-wrapper-theme-paper {
  margin: 8px 0;
  box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
  padding: 16px 32px;
  display: block;
}

.immersive-translate-target-translation-block-wrapper-theme-blockquote {
  border-left: 4px solid var(--immersive-translate-theme-blockquote-borderColor) !important;
  padding-left: 12px !important;
  margin-top: 4px;
  margin-bottom: 4px;
  padding-top: 4px;
  padding-bottom: 4px;
  display: block;
}

.immersive-translate-target-translation-theme-mask-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-mask-inner {
  filter: none !important;
}

[data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}


/* opacity theme start */

.immersive-translate-target-translation-theme-opacity-inner {
  filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-opacity-inner {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner,.immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

.immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: none !important;
}


.immersive-translate-target-translation-theme-mask-inner:hover {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner:hover {
  filter: none !important;
}


[data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner:hover {
  filter: none !important;
}

/* opacity theme end */

/* vertical css , please remain it in the last one. */
.immersive-translate-target-translation-vertical-block-wrapper {
  margin: 0px 8px !important;
}

.immersive-translate-text {
  font-size: 15px !important;
}

.immersive-translate-error-toast {
  position: fixed;
  top: 5%;
  z-index: 99999999;
  left: 0;
  right: 0;
  margin: auto;
  max-width: 300px;
  padding: 16px;
  border-radius: 12px;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  flex-direction: row;
  justify-content: space-between;
}

@media all and (min-width: 750px) {
  .immersive-translate-error-toast {
    max-width: 400px;
  }
}


.immersive-translate-clickable-button {
  cursor: pointer;
}

.immersive-translate-help-button {
  cursor: pointer;
}

.immersive-translate-loading-text:before {
  content: "...";
}


/* dark mode for loading */

@media only screen and (prefers-color-scheme: dark) {
  .immersive-translate-loading {
    border: 2px rgba(255, 255, 255, 0.25) solid !important;
    border-top: 2px rgba(255, 255, 255, 1) solid !important;
  }
}

.immersive-translate-error-wrapper {
  position: relative;
  display: inline-flex;
  padding: 6px;
  margin: 0 12px;
  white-space: nowrap;
  font-size: 0.9em;
}
[lang="zh-CN"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}
[lang="zh-TW"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}


.immersive-translate-tooltip {
  position: relative;
  display: inline-flex;
  /* little indicater to indicate it's hoverable */
}

.immersive-translate-tooltip-content {
  /* here's the magic */
  position: absolute;
  z-index: 100000000000;

  left: 50%;
  bottom: 0;
  transform: translate(-50%, 110%);
  line-height: 1;
  /* and add a small left margin */

  /* basic styles */
  width: max-content;
  max-width: 250px;
  word-wrap: break-word;
  white-space: pre-line;
  padding: 10px;
  border-radius: 10px;
  background: #000C;
  color: #fff;
  text-align: center;
  font-size: 14px;
  display: none;
  /* hide by default */
}

.immersive-translate-tooltip:hover .immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip:hover+.immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip-content-table {
  left: unset !important;
  bottom: unset !important;
  transform: translate(-10%, 50%) !important;
}


.immersive-translate-tooltip:hover:before {
  display: block;
}



.immersive-translate-loading-spinner {
  vertical-align: middle !important;
  width: 10px !important;
  height: 10px !important;
  display: inline-block !important;
  margin: 0 4px !important;
  border: 2px rgba(221, 244, 255, 0.6) solid !important;
  border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-radius: 50% !important;
  padding: 0 !important;
  -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
  animation: immersive-translate-loading-animation 0.6s infinite linear !important;
}

@-webkit-keyframes immersive-translate-loading-animation {
  from {
    -webkit-transform: rotate(0deg);
  }

  to {
    -webkit-transform: rotate(359deg);
  }
}

@keyframes immersive-translate-loading-animation {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(359deg);
  }
}
</style><style data-id="immersive-translate-user-custom-style">:root {

.immersive-translate-target-inner { font-family: inherit; }
}
</style><style data-id="immersive-translate-dynamic-injected-css">.immersive-translate-target-wrapper[dir='rtl'] {text-align: right;}
.immersive-translate-target-wrapper[dir='rtl'] [data-immersive-translate-class-bak*='block-wrapper'] {display:block;}
.immersive-translate-target-wrapper {word-break: break-word;}
</style></head><body data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">


<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Deployment Tools Foundation | WiX Toolset</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.bugs.cc/wixtoolset/docs/tools/dtf/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Deployment Tools Foundation | WiX Toolset"><meta data-rh="true" name="description" content="Deployment Tools Foundation reference documentation is available here."><meta data-rh="true" property="og:description" content="Deployment Tools Foundation reference documentation is available here."><link data-rh="true" rel="icon" href="/wixtoolset/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.bugs.cc/wixtoolset/docs/tools/dtf/"><link data-rh="true" rel="alternate" href="https://docs.bugs.cc/wixtoolset/docs/tools/dtf/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.bugs.cc/wixtoolset/docs/tools/dtf/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/wixtoolset/news/rss.xml" title="WiX Toolset RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/wixtoolset/news/atom.xml" title="WiX Toolset Atom Feed"><link rel="stylesheet" href="/wixtoolset/assets/css/styles.f38540a7.css">
<link rel="preload" href="/wixtoolset/assets/js/runtime~main.d4837c13.js" as="script">
<link rel="preload" href="/wixtoolset/assets/js/main.81f55813.js" as="script">


<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">
<div role="region" aria-label="Skip to main content" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Skip to main content<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">跳到主要内容</font></font></font></a></div><div class="announcementBar_mb4j" style="background-color:#C70039;color:#fff" role="banner" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="announcementBarPlaceholder_vyr4" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"></div><div class="content_knG7 announcementBarContent_xLdY" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><span style="font-size:16px" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Get the latest WiX news sent to you. <a style="text-decoration-line:none;border-bottom:1px solid" href="https://www.firegiant.com/subscribe/?utm_source=wixtoolset.org&amp;utm_medium=Display&amp;utm_campaign=subscribe&amp;utm_term=subscribe&amp;utm_content=announcement_bar" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">Subscribe to the FireGiant newsletter.</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">获取最新的 WiX 新闻。订阅 FireGiant 通讯。</font></font></font></span></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="navbar__inner" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="navbar__items" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/wixtoolset/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="navbar__logo" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><img src="/wixtoolset/img/logo-white-hollow-xs.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA" width="53.6171875" height="22.5" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><img src="/wixtoolset/img/logo-black-hollow-xs.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU" width="53.6171875" height="22.5" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"></div><b class="navbar__title text--truncate" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">WiX Toolset<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">WiX 工具集</font></font></font></b></a></div><div class="navbar__items navbar__items--right" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1"><a class="navbar__item navbar__link" href="/wixtoolset/news/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">News</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/wixtoolset/docs/intro/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">Docs</a><a href="https://github.com/wixtoolset/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.firegiant.com/services/?utm_source=wixtoolset.org&amp;utm_medium=Display&amp;utm_term=enterprise+support&amp;utm_content=header" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">Enterprise Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">新闻 文档 GitHub 企业支持</font></font></font><div class="toggle_vylO colorModeToggle_DEke" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="dsla-search-wrapper" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="dsla-search-field" data-tags="default,docs-default-current" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="sidebarViewport_Xe31" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="sidebar_njMd" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><ul class="theme-doc-sidebar-menu menu__list" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" href="/wixtoolset/docs/intro/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Get started with WiX<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">开始使用 WiX</font></font></font></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" href="/wixtoolset/docs/about/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">About<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">关于</font></font></font></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" href="/wixtoolset/docs/releasenotes/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Release notes<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">发行说明</font></font></font></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" href="/wixtoolset/docs/gethelp/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Get help<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">获取帮助</font></font></font></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="menu__list-item-collapsible" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/wixtoolset/docs/fivefour/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">WiX v5 for WiX v4 users<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">WiX v5 给 WiX v4 用户</font></font></font></a><button aria-label="Toggle the collapsible sidebar category 'WiX v5 for WiX v4 users'" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="menu__list-item-collapsible" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/wixtoolset/docs/fourthree/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">WiX v4 for WiX v3 users<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">WiX v4 给 WiX v3 用户</font></font></font></a><button aria-label="Toggle the collapsible sidebar category 'WiX v4 for WiX v3 users'" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="menu__list-item-collapsible" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/wixtoolset/docs/tools/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">WiX tools and concepts<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">WiX 工具和概念</font></font></font></a><button aria-label="Toggle the collapsible sidebar category 'WiX tools and concepts'" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="menu__list-item-collapsible" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/wixtoolset/docs/tools/burn/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Burn bundles<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">烧捆</font></font></font></a><button aria-label="Toggle the collapsible sidebar category 'Burn bundles'" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" tabindex="0" href="/wixtoolset/docs/tools/msbuild/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">MSBuild</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" tabindex="0" href="/wixtoolset/docs/tools/wixexe/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Wix.exe command-line reference<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Wix.exe 命令行参考</font></font></font></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="menu__list-item-collapsible" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/wixtoolset/docs/tools/wixext/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">WiX extensions and custom actions<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">WiX 扩展和自定义操作</font></font></font></a><button aria-label="Toggle the collapsible sidebar category 'WiX extensions and custom actions'" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/wixtoolset/docs/tools/dtf/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Deployment Tools Foundation<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">部署工具基础</font></font></font></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" tabindex="0" href="/wixtoolset/docs/tools/preprocessor/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Preprocessor<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">预处理器</font></font></font></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" tabindex="0" href="/wixtoolset/docs/tools/signing/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Signing packages and bundles<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">签署包和捆绑包</font></font></font></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" tabindex="0" href="/wixtoolset/docs/tools/patches/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Windows Installer patches<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Windows 安装程序补丁</font></font></font></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" tabindex="0" href="/wixtoolset/docs/tools/payloads/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Specifying source files<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">指定源文件</font></font></font></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" tabindex="0" href="/wixtoolset/docs/tools/codepage/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Code pages<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">代码页</font></font></font></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" tabindex="0" href="/wixtoolset/docs/tools/validation/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Validation<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">验证</font></font></font></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" tabindex="0" href="/wixtoolset/docs/tools/heat/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Heat harvesting<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">热能收集</font></font></font></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="menu__list-item-collapsible" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/wixtoolset/docs/api/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">WiX managed SDK<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">WiX 管理 SDK</font></font></font></a><button aria-label="Toggle the collapsible sidebar category 'WiX managed SDK'" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="menu__list-item-collapsible" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/wixtoolset/docs/schema/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Schema reference<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">架构参考</font></font></font></a><button aria-label="Toggle the collapsible sidebar category 'Schema reference'" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="menu__list-item-collapsible" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/wixtoolset/docs/development/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Development<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">开发</font></font></font></a><button aria-label="Toggle the collapsible sidebar category 'Development'" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="menu__link" href="/wixtoolset/docs/wix3/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">WiX v3</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="container padding-top--md padding-bottom--lg" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="row" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="col docItemCol_VOVn" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="docItemContainer_Djhp" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><article data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/wixtoolset/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/wixtoolset/docs/tools/"><span itemprop="name">WiX tools and concepts</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Deployment Tools Foundation</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><h1 data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Deployment Tools Foundation<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">部署工具基础</font></font></font></h1><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="admonitionHeading_tbUL" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><span class="admonitionIcon_kALy" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="/wixtoolset/docs/api/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Deployment Tools Foundation reference documentation is available here.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">部署工具基础参考文档在这里可以找到。</font></font></font></a></p></div></div><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Deployment Tools Foundation is a rich set of .NET class libraries and related resources that together bring the Windows deployment platform technologies into the .NET world. It is designed to greatly simplify deployment-related development tasks while still exposing the complete functionality of the underlying technology.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">部署工具基础是一套丰富的 .NET 类库和相关资源，它们共同将 Windows 部署平台技术引入 .NET 世界。它旨在极大简化与部署相关的开发任务，同时仍然暴露底层技术的完整功能。</font></font></font></p><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">The primary focus of DTF is to provide a foundation for development of various kinds of tools to support deployment throughout the product lifecycle, including setup authoring, building, analysis, debugging, and testing tools. In addition to tools, DTF can also be useful for install-time activities such as setup bootstrappers, external UI, and custom actions, and for application run-time activities that need to access the deployment platform.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">DTF 的主要重点是为开发各种工具提供基础，以支持产品生命周期中的部署，包括安装编写、构建、分析、调试和测试工具。除了工具之外，DTF 还可以用于安装时的活动，如安装引导程序、外部 UI 和自定义操作，以及需要访问部署平台的应用程序运行时活动。</font></font></font></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="working-with-msi-databases" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Working with MSI Databases<a href="#working-with-msi-databases" class="hash-link" aria-label="Direct link to Working with MSI Databases" title="Direct link to Working with MSI Databases" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 MSI 数据库</font></font></font></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="querying-a-database" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Querying a database<a href="#querying-a-database" class="hash-link" aria-label="Direct link to Querying a database" title="Direct link to Querying a database" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">查询数据库</font></font></font></h3><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">using</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Database</span><span class="token plain"> db </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">Database</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"product.msi"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DatabaseOpenMode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ReadOnly</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name keyword" style="color:#00009f">string</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">value</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ExecuteScalar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"SELECT `Value` FROM `Property` WHERE `Property` = '{0}'"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> propName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Create a new Database instance referring to the location of the .msi or .msm file.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">创建一个新的数据库实例，指向.msi 或.msm 文件的位置。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Execute the query:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">执行查询：</font></font></font></li></ol><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">The ExecuteScalar method is a shortcut for opening a view, executing the view, and fetching a single value.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">ExecuteScalar 方法是打开视图、执行视图和获取单个值的快捷方式。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">The ExecuteQuery method is a shortcut for opening a view, executing the view, and fetching all values.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">ExecuteQuery 方法是打开视图、执行视图和获取所有值的快捷方式。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Or do it all manually with Database.OpenView, View.Execute, and View.Fetch.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">或者使用 Database.OpenView、View.Execute 和 View.Fetch 手动完成所有操作。</font></font></font></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="updating-a-binary" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Updating a binary<a href="#updating-a-binary" class="hash-link" aria-label="Direct link to Updating a binary" title="Direct link to Updating a binary" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">更新二进制文件</font></font></font></h3><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Database</span><span class="token plain"> db </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">View</span><span class="token plain"> view </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Record</span><span class="token plain"> rec </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    db </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">Database</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"product.msi"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DatabaseOpenMode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Direct</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    view </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">OpenView</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"UPDATE `Binary` SET `Data` = ? WHERE `Name` = '{0}'"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> binName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rec </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">Record</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SetStream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> binFile</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    view</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Commit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">finally</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rec </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> rec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">view </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> view</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">db </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Create a new Database instance referring to the location of the .msi or .msm file.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">创建一个新的 Database 实例，指向 .msi 或 .msm 文件的位置。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Open a view by calling one of the Database.OpenView overloads.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">通过调用 Database.OpenView 的重载来打开视图。</font></font></font></li></ol><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Parameters can be substituted in the SQL string using the String.Format syntax.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">可以使用 String.Format 语法在 SQL 字符串中替换参数。</font></font></font></li></ul><ol start="3" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Create a record with one field containing the new binary value.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">创建一个包含新二进制值的字段的记录。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Execute the view by calling one of the View.Execute overloads.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">通过调用 View.Execute 的重载来执行视图。</font></font></font></li></ol><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">A record can be supplied for substitution of field tokens (?) in the query.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">可以提供记录以替换查询中的字段标记（？）。</font></font></font></li></ul><ol start="5" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Commit the Database.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">提交数据库。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Close the handles.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">关闭句柄。</font></font></font></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-handles" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">About handles<a href="#about-handles" class="hash-link" aria-label="Direct link to About handles" title="Direct link to About handles" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">关于句柄</font></font></font></h3><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Handle objects (Database, View, Record, SummaryInfo, Session) will remain open until they are explicitly closed or until the objects are collected by the GC. So for the tightest code, handle objects should be explicitly closed when they are no longer needed, since closing them can release significant resources, and too many unnecessary open handles can degrade performance. This is especially important within a loop construct: for example when iterating over all the Records in a table, it is much cleaner and faster to close each Record after it is used.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">句柄对象（数据库、视图、记录、SummaryInfo、会话）将保持打开状态，直到它们被显式关闭或被 GC 收集。因此，为了最紧凑的代码，句柄对象在不再需要时应显式关闭，因为关闭它们可以释放大量资源，过多不必要的打开句柄会降低性能。这在循环结构中尤为重要：例如，当遍历表中的所有记录时，使用后关闭每个记录会更清晰和更快。</font></font></font></p><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">The handle classes in the managed library all extend the InstallerHandle class, which implements the IDisposable interface. This makes them easily managed with C#'s using statement. Alternatively, they can be closed in a finally block.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">托管library中的句柄类都扩展了 InstallerHandle 类，该类实现了 IDisposable 接口。这使得它们可以通过 C#的 using 语句轻松管理。或者，它们可以在 finally 块中关闭。</font></font></font></p><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">As a general rule, <em data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">methods</em> in the library return new handle objects that should be managed and closed by the calling code, while <em data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">properties</em> only return a reference to a prexisting handle object.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">一般来说，library中的方法返回新的句柄对象，应该由调用代码管理和关闭，而属性只返回对现有句柄对象的引用。</font></font></font></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="working-with-cabinet-files" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Working with Cabinet Files<a href="#working-with-cabinet-files" class="hash-link" aria-label="Direct link to Working with Cabinet Files" title="Direct link to Working with Cabinet Files" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用内阁文件</font></font></font></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-cabinet" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Creating a cabinet<a href="#creating-a-cabinet" class="hash-link" aria-label="Direct link to Creating a cabinet" title="Direct link to Creating a cabinet" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">创建一个柜子</font></font></font></h3><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">CabInfo</span><span class="token plain"> cabInfo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">CabInfo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"package.cab"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cabInfo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Pack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"D:\\FilesToCompress"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Create a new CabInfo instance referring to the (future) location of the .cab file.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">创建一个新的 CabInfo 实例，指向.cab 文件的（未来）位置。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Compress files:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">压缩文件：</font></font></font></li></ol><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Easily compress an entire directory with the Pack method.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 Pack 方法轻松压缩整个目录。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Compress a specific list of exernal and internal filenames with the PackFiles method.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 PackFiles 方法压缩特定的外部和内部文件名列表。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Compress a dictionary mapping of internal to external filenames with the PackFileSet method.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 PackFileSet 方法压缩内部到外部文件名的字典映射。</font></font></font></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="listing-a-cabinet" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Listing a cabinet<a href="#listing-a-cabinet" class="hash-link" aria-label="Direct link to Listing a cabinet" title="Direct link to Listing a cabinet" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">列出一个柜子</font></font></font></h3><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">CabInfo</span><span class="token plain"> cabInfo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">CabInfo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"package.cab"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">CabFileInfo</span><span class="token plain"> fileInfo </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> cabInfo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GetFiles</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">WriteLine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fileInfo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Name </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"\t"</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> fileInfo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Create a new CabInfo instance referring to the location of the .cab file.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">创建一个新的 CabInfo 实例，指向.cab 文件的位置。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Enumerate files returned by the GetFiles method.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">枚举 GetFiles 方法返回的文件。</font></font></font></li></ol><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Each CabFileInfo instance contains metadata about one file.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">每个 CabFileInfo 实例包含一个文件的元数据。</font></font></font></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="extracting-a-cabinet" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Extracting a cabinet<a href="#extracting-a-cabinet" class="hash-link" aria-label="Direct link to Extracting a cabinet" title="Direct link to Extracting a cabinet" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">提取一个柜文件</font></font></font></h3><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">CabInfo</span><span class="token plain"> cabInfo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">CabInfo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"package.cab"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cabInfo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unpack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"D:\\ExtractedFiles"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Create a new CabInfo instance referring to the location of the .cab file.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">创建一个新的 CabInfo 实例，指向 .cab 文件的位置。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Extract files:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">提取文件：</font></font></font></li></ol><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Easily extract all files to a directory with the Unpack method.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 Unpack 方法轻松将所有文件提取到目录中。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Easily extract a single file with the UnpackFile method.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 UnpackFile 方法轻松提取单个文件。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Extract a specific list of filenames with the UnpackFiles method.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 UnpackFiles 方法提取特定的文件名列表。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Extract a dictionary mapping of internal to external filenames with the UnpackFileSet method.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 UnpackFileSet 方法提取内部到外部文件名的字典映射。</font></font></font></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-progress" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Getting progress<a href="#getting-progress" class="hash-link" aria-label="Direct link to Getting progress" title="Direct link to Getting progress" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">获取进度</font></font></font></h3><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Most cabinet operation methods have an overload that allows you to specify a event handler for receiving archive progress events. The XPack sample demonstrates use of the callback to report detailed progress to the console.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">大多数机柜操作方法都有一个重载，允许您指定一个事件处理程序来接收存档进度事件。XPack 示例演示了使用回调向控制台报告详细进度。</font></font></font></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stream-based-compression" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Stream-based compression<a href="#stream-based-compression" class="hash-link" aria-label="Direct link to Stream-based compression" title="Direct link to Stream-based compression" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">基于流的压缩</font></font></font></h3><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">The CabEngine class contains static methods for performing compression/decompression operations directly on any kind of Stream. However these methods are more difficult to use, since the caller must implement a stream context that provides the file metadata which would otherwise have been provided by the filesystem. The CabInfo class uses the CabEngine class with FileStreams to provide the more traditional file-based interface.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">CabEngine 类包含用于直接在任何类型的流上执行压缩/解压缩操作的静态方法。然而，这些方法更难使用，因为调用者必须实现一个流上下文，该上下文提供文件系统本来会提供的文件元数据。CabInfo 类使用 CabEngine 类和 FileStreams 提供更传统的基于文件的接口。</font></font></font></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="working-with-install-packages" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Working with Install Packages<a href="#working-with-install-packages" class="hash-link" aria-label="Direct link to Working with Install Packages" title="Direct link to Working with Install Packages" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用安装包</font></font></font></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="updating-files-in-a-product-layout" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Updating files in a product layout<a href="#updating-files-in-a-product-layout" class="hash-link" aria-label="Direct link to Updating files in a product layout" title="Direct link to Updating files in a product layout" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">更新产品布局中的文件</font></font></font></h3><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">The InstallPackage class makes it easy to work with files and cabinets in the context of a compressed or uncompressed product layout.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">InstallPackage 类使在压缩或未压缩的产品布局中处理文件和柜子变得容易。</font></font></font></p><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">This hypothetical example takes an IDictionary <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">files</code> that maps file keys to file paths. Each file is to be updated in the package layout; cabinets are even recompressed if necessary to include the new files.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这个假设的例子使用了一个 IDictionary <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">files</code> ，它将文件键映射到文件路径。每个文件都将在包布局中更新；如果需要，柜子甚至会重新压缩以包含新文件。</font></font></font></p><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">using</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">InstallPackage</span><span class="token plain"> pkg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">InstallPackage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">@"d:\builds\product.msi"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DatabaseOpenMode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Transact</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pkg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WorkingDirectory </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Combine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GetTempFolder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"pkgtmp"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name keyword" style="color:#00009f">string</span><span class="token plain"> fileKey </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> files</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name keyword" style="color:#00009f">string</span><span class="token plain"> sourceFilePath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> files</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">fileKey</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name keyword" style="color:#00009f">string</span><span class="token plain"> destFilePath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pkg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Files</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">fileKey</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SourcePath</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        destFilePath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Combine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pkg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WorkingDirectory</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> destFilePath</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        File</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sourceFilePath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> destFilePath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pkg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">UpdateFiles</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">ArrayList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">files</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pkg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Commit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Directory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Delete</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pkg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WorkingDirectory</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Create a new InstallPackage instance referring to the location of the .msi. This is actually just a specialized subclass of a Database.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">创建一个新的 InstallPackage 实例，指向.msi 的位置。这实际上只是一个 Database 的专门子类。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Set the WorkingDirectory. This is the root directory where the package expects to find the new source files.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">设置工作目录。这是root目录，包期望在此找到新的源文件。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Copy each file to its proper location in the working directory. The InstallPackage.Files property is used to look up the relative source path of each file.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将每个文件复制到工作目录中的适当位置。InstallPackage.Files 属性用于查找每个文件的相对源路径。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Call InstallPackage.UpdateFiles with the list of file keys. This will re-compress and package the files if necessary, and also update the following data: File.FileSize, File.Version, File.Language, MsiFileHash.HashPart*.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用文件键列表调用 InstallPackage.UpdateFiles。如果需要，这将重新压缩和打包文件，并更新以下数据：File.FileSize、File.Version、File.Language、MsiFileHash.HashPart*。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Commit the database changes and cleanup the working directory.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">提交数据库更改并清理工作目录。</font></font></font></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="managed-custom-actions" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Managed Custom Actions<a href="#managed-custom-actions" class="hash-link" aria-label="Direct link to Managed Custom Actions" title="Direct link to Managed Custom Actions" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">管理的自定义操作</font></font></font></h2><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Before choosing to write a custom action in managed code instead of traditional native C++ code, you should carefully consider the following:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在选择用托管代码而不是传统的本机 C++代码编写自定义操作之前，您应该仔细考虑以下几点：</font></font></font></p><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Obviously, it introduces a dependency on the .NET Framework. Your MSI package should probably have a LaunchCondition to check for the presence of the correct version of the .NET Framework before anything else happens.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">显然，这引入了对.NET 框架的依赖。您的 MSI 包应该有一个 LaunchCondition，以在任何其他操作发生之前检查正确版本的.NET 框架是否存在。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">If the custom action runs at uninstall time, then even the uninstall of your product may fail if the .NET Framework is not present. This means a user could run into a problem if they uninstall the .NET Framework before your product.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果自定义操作在卸载时运行，那么如果没有 .NET Framework，您的产品卸载也可能会失败。这意味着如果用户在您的产品之前卸载 .NET Framework，可能会遇到问题。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">A managed custom action should be configured to run against a specific version of the .NET Framework, and that version should match the version your actual product runs against. Allowing the version to "float" to the latest installed .NET Framework is likely to lead to compatibility problems with future versions. The .NET Framework provides side-by-side functionality for good reason -- use it.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">托管自定义操作应配置为针对特定版本的 .NET Framework 运行，并且该版本应与您的实际产品运行的版本匹配。允许版本“浮动”到最新安装的 .NET Framework 可能会导致与未来版本的兼容性问题。 .NET Framework 提供并行功能是有原因的——请使用它。</font></font></font></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="proxy-for-managed-custom-actions" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Proxy for Managed Custom Actions<a href="#proxy-for-managed-custom-actions" class="hash-link" aria-label="Direct link to Proxy for Managed Custom Actions" title="Direct link to Proxy for Managed Custom Actions" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">托管自定义操作的代理</font></font></font></h3><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">The custom action proxy allows an MSI developer to write custom actions in managed code, while maintaing all the advantages of type 1 DLL custom actions including full access to installer state, properties, and the session database.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">自定义操作代理允许 MSI 开发人员在托管代码中编写自定义操作，同时保持类型 1 DLL 自定义操作的所有优点，包括完全访问安装程序状态、属性和会话数据库。</font></font></font></p><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">There are generally four problems that needed to be solved in order to create a type 1 custom action in managed code:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">通常需要解决四个问题才能在托管代码中创建类型 1 自定义操作：</font></font></font></p><ol data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Exporting the CA function as a native entry point callable by MSI: The Windows Installer engine expects to call a LoadLibrary and GetProcAddress on the custom action DLL, so an unmanaged DLL needs to implement the function that is initially called by MSI and ultimately returns the result. This function acts as a proxy to relay the custom action call into the managed custom action assembly, and relay the result back to the caller.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将 CA 函数导出为 MSI 可调用的本机入口点：Windows Installer 引擎期望在自定义操作 DLL 上调用 LoadLibrary 和 GetProcAddress，因此需要一个非托管 DLL 来实现最初由 MSI 调用并最终返回结果的函数。此函数充当代理，将自定义操作调用中继到托管自定义操作程序集，并将结果中继回调用者。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Providing supporting assemblies without requiring them to be installed as files: If a DLL custom action runs before the product's files are installed, then it is difficult to provide any supporting files, because of the way the CA DLL is singly extracted and executed from a temp file. (This can be a problem for unmanaged CAs as well.) With managed custom actions we have already hit that problem since both the CA assembly and the MSI wrapper assembly need to be loaded. To solve this, the proxy DLL carries an appended cab package. When invoked, it will extract all contents of the cab package to a temporary working directory. This way the cab package can carry any arbitrary dependencies the custom action may require.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">提供支持程序集而无需将其作为文件安装：如果在产品文件安装之前运行 DLL 自定义操作，那么由于 CA DLL 是从临时文件中单独提取和执行的，因此很难提供任何支持文件。（这对于非托管 CA 也可能是个问题。）对于托管自定义操作，我们已经遇到了这个问题，因为 CA 程序集和 MSI 包装程序集都需要加载。为了解决这个问题，代理 DLL 携带一个附加的 cab 包。当被调用时，它会将 cab 包的所有内容提取到一个临时工作目录中。这样，cab 包可以携带自定义操作可能需要的任何任意依赖项。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Hosting and configuring the Common Language Runtime: In order to invoke a method in a managed assembly from a previously unmanaged process, the CLR needs to be "hosted". This involves choosing the correct version of the .NET Framework to use out of the available version(s) on the system, binding that version to the current process, and configuring it to load assemblies from the temporary working directory.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">托管和配置公共语言运行时：为了从先前的非托管进程中调用托管程序集中的方法，需要“托管”CLR。这涉及选择系统上可用版本中的正确.NET Framework 版本，将该版本绑定到当前进程，并配置它以从临时工作目录加载程序集。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Converting the integer session handle into a Session object: The Session class in the managed wrapper library has a constructor which takes an integer session handle as its parameter. So the proxy simply instantiates this object before calling the real CA function.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将整数会话句柄转换为 Session 对象：托管包装器library中的 Session 类有一个构造函数，它将整数会话句柄作为其参数。因此，代理在调用真实 CA 函数之前简单地实例化此对象。</font></font></font></li></ol><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">The unmanaged CAPack module, when used in combination with the managed proxy in the Microsoft.WindowsInstaller assembly, accomplishes the tasks above to enable fully-functional managed DLL custom actions.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当未管理的 CAPack 模块与 Microsoft.WindowsInstaller 程序集中的托管代理结合使用时，可以完成上述任务，从而实现功能齐全的托管 DLL 自定义操作。</font></font></font></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">How to<a href="#how-to" class="hash-link" aria-label="Direct link to How to" title="Direct link to How to" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如何</font></font></font></h3><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">A custom action function needs to be declared as public static (aka Public Shared in VB.NET). It takes one parameter which is a Session object, and returns a ActionResult enumeration.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">自定义操作函数需要声明为 public static（在 VB.NET 中为 Public Shared）。它接受一个 Session 对象作为参数，并返回一个 ActionResult 枚举。</font></font></font></li></ul><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token attribute class-name">CustomAction</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token return-type class-name">ActionResult</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">MyCustomAction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Session</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">The function must have a CustomActionAttribute, which enables it to be linked to a proxy function. The attribute can take an optional "name" parameter, which is the name of the entrypoint that is exported from the custom action DLL.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">该函数必须具有 CustomActionAttribute，以便将其链接到代理函数。该属性可以接受一个可选的“name”参数，该参数是从自定义操作 DLL 导出的入口点的名称。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Fill in MSI CustomAction table entries just like you would for a normal type 1 native-DLL CA. Managed CAs can also work just as well in deferred, rollback, and commit modes.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">填写 MSI CustomAction 表条目，就像为普通类型 1 本机 DLL CA 一样。托管 CA 在延迟、回滚和提交模式下也能正常工作。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">If the custom action function throws any kind of Exception that isn't handled internally, then it will be caught by the proxy function. The Exception message and stack trace will be printed to the MSI log if logging is enabled, and the CA will return a failure code.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果自定义操作函数抛出任何未在内部处理的异常，则会被代理函数捕获。如果启用了日志记录，异常消息和stack跟踪将打印到 MSI 日志中，并且 CA 将返回失败代码。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">To be technically correct, any MSI handles obtained should be closed before a custom action function exits -- otherwise a warning gets printed to the log. The handle classes in the managed library (Database, View, Record, SummaryInfo) all implement the IDisposable interface, which makes them easily managed with C#'s <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">using</code> statement. Alternatively, they can be closed in a finally block. As a general rule, methods return new handle objects that should be managed and closed by the user code, while properties only return a reference to a prexisting handle object.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">从技术上讲，任何获取的 MSI 句柄都应在自定义操作函数退出之前关闭——否则会在日志中打印警告。托管library（数据库、视图、记录、摘要信息）中的句柄类都实现了 IDisposable 接口，这使得它们可以通过 C#的 <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">using</code> 语句轻松管理。或者，它们可以在 finally 块中关闭。作为一般规则，方法返回的新句柄对象应由用户代码管理和关闭，而属性只返回对现有句柄对象的引用。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Don't forget to use a CustomAction.config file to specify what version of the .NET Framework the custom action should run against.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">别忘了使用 CustomAction.config 文件来指定自定义操作应运行的.NET Framework 版本。</font></font></font></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="specifying-the-runtime-version" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Specifying the Runtime Version<a href="#specifying-the-runtime-version" class="hash-link" aria-label="Direct link to Specifying the Runtime Version" title="Direct link to Specifying the Runtime Version" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">指定运行时版本</font></font></font></h3><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Every managed custom action package should contain a CustomAction.config file, even though it is not required by the toolset. Here is a sample:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">每个托管的自定义操作包都应包含一个 CustomAction.config 文件，尽管工具集不要求这样做。以下是一个示例：</font></font></font></p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">configuration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">startup</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">supportedRuntime</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">version</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">v2.0.50727</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">startup</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">configuration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">The configuration file follows <a href="https://learn.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/" target="_blank" rel="noopener noreferrer" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">the standard schema for .NET Framework configuration files</a>.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">配置文件遵循.NET Framework 配置文件的标准架构。</font></font></font></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="supported-runtime-version" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Supported Runtime Version<a href="#supported-runtime-version" class="hash-link" aria-label="Direct link to Supported Runtime Version" title="Direct link to Supported Runtime Version" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">支持的运行时版本</font></font></font></h4><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">In the startup section, use <a href="https://learn.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/startup/supportedruntime-element" target="_blank" rel="noopener noreferrer" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">supportedRuntime</a> tags to explicitly specify the version(s) of the .NET Framework that the custom action should run on. If no versions are specified, the chosen version of the .NET Framework will be the "best" match to what WixToolset.Dtf.WindowsInstaller.dll was built against.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在启动部分，使用 supportedRuntime 标签明确指定自定义操作应运行的 .NET Framework 版本。如果未指定版本，则选择的 .NET Framework 版本将是与 WixToolset.Dtf.WindowsInstaller.dll 构建时最匹配的版本。</font></font></font></p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="admonitionHeading_tbUL" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1"><span class="admonitionIcon_kALy" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">注意</font></font></font></div><div class="admonitionContent_S0QG" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Warning: Leaving the version unspecified is dangerous as it introduces a risk of compatibility problems with future versions of the .NET Framework. It is highly recommended that you specify only the version(s) of the .NET Framework that you have tested against.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">警告：不指定版本是危险的，因为它会引入与未来版本的 .NET Framework 兼容性问题的风险。强烈建议您仅指定您已测试过的 .NET Framework 版本。</font></font></font></p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="other-configuration" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Other Configuration<a href="#other-configuration" class="hash-link" aria-label="Direct link to Other Configuration" title="Direct link to Other Configuration" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">其他配置</font></font></font></h4><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Various other kinds of configuration settings may also be added to this file, as it is a standard .NET Framework application config file for the custom action.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">还可以将各种其他类型的配置设置添加到此文件中，因为它是自定义操作的标准 .NET Framework 应用程序配置文件。</font></font></font></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sample-c-custom-action" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Sample C# Custom Action<a href="#sample-c-custom-action" class="hash-link" aria-label="Direct link to Sample C# Custom Action" title="Direct link to Sample C# Custom Action" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">示例 C# 自定义操作</font></font></font></h3><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">MSI custom actions are MUCH easier to write in C# than in C++!<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">用 C#编写 MSI 自定义操作比用 C++编写容易得多！</font></font></font></p><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token attribute class-name">CustomAction</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token return-type class-name">ActionResult</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SampleCustomAction1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Session</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Hello from SampleCA1"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name keyword" style="color:#00009f">string</span><span class="token plain"> testProp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"SampleCATest"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name keyword" style="color:#00009f">string</span><span class="token plain"> testProp2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    testProp2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Database</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ExecuteScalar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"SELECT `Value` FROM `Property` WHERE `Property` = 'SampleCATest'"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">testProp </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> testProp2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Simple property test passed."</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> ActionResult</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Success</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> ActionResult</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Failure</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">A sample CA project with two CAs is included in the Samples\ManagedCA directory.  Running the CustomActionTest project will package the CA and insert it into a test MSI. The MSI will invoke the custom actions, but it will not install anything since the second sample CA returns ActionResult.UserExit.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Samples\ManagedCA 目录中包含一个带有两个 CA 的示例 CA 项目。运行 CustomActionTest 项目将打包 CA 并将其插入测试 MSI 中。MSI 将调用自定义操作，但不会安装任何内容，因为第二个示例 CA 返回 ActionResult.UserExit。</font></font></font></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="building-managed-custom-actions" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Building Managed Custom Actions<a href="#building-managed-custom-actions" class="hash-link" aria-label="Direct link to Building Managed Custom Actions" title="Direct link to Building Managed Custom Actions" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">构建托管自定义操作</font></font></font></h3><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">The preferred way to build managed CA DLLs is to use an msbuild project (aka visual studio project). In that project, make sure that the <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">WixToolset.Dtf.CustomAction</code> nuget package has been included as a package reference. The resulting package (<code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">SampleCAs.CA.dll</code> if your project/assemblyname was <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">SampleCAs</code>) is ready to be inserted into the Binary table of the MSI.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">构建托管 CA DLL 的首选方法是使用 msbuild 项目（即 visual studio 项目）。在该项目中，确保已将 <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">WixToolset.Dtf.CustomAction</code> nuget 包作为包引用包含在内。生成的包（如果您的项目/程序集名称是 <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">SampleCAs</code> ，则为 <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">SampleCAs.CA.dll</code> ）已准备好插入 MSI 的 Binary 表中。</font></font></font></p><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Otherwise, the build process for managed CA DLLs is a little complicated becuase of the proxy-wrapper and dll-export requirements. Here's an overview:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">否则，由于代理包装器和 dll 导出要求，托管 CA DLL 的构建过程会有点复杂。以下是概述：</font></font></font></p><ol data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Download both the <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">WixToolset.Dtf.CustomAction</code> and <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">WixToolset.Dtf.WindowsInstaller</code> nuget packages and point <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">DTFbin</code> to the applicable <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">lib</code> directory of <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">WixToolset.Dtf.WindowsInstaller</code> and add the <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">tools</code> directory of <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">WixToolset.Dtf.CustomAction</code> to your <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">PATH</code>.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">下载 <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">WixToolset.Dtf.CustomAction</code> 和 <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">WixToolset.Dtf.WindowsInstaller</code> nuget 包，并将 <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">DTFbin</code> 指向 <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">WixToolset.Dtf.WindowsInstaller</code> 的适用 <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">lib</code> 目录，并将 <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">WixToolset.Dtf.CustomAction</code> 的 <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">tools</code> 目录添加到您的 <code data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">PATH</code> 。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Compile your CA assembly, which references WixToolset.Dtf.WindowsInstaller.dll and marks exported custom actions with a CustomActionAttribute.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">编译你的 CA 程序集，该程序集引用 WixToolset.Dtf.WindowsInstaller.dll，并使用 CustomActionAttribute 标记导出的自定义操作。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Package the CA assembly, CustomAction.config, WixToolset.Dtf.WindowsInstaller.dll, and any other dependencies using MakeSfxCA.exe. The filenames of CustomAction.config and WixToolset.Dtf.WindowsInstaller.dll must not be changed, since the custom action proxy specifically looks for those files.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 MakeSfxCA.exe 打包 CA 程序集、CustomAction.config、WixToolset.Dtf.WindowsInstaller.dll 和任何其他依赖项。CustomAction.config 和 WixToolset.Dtf.WindowsInstaller.dll 的文件名不能更改，因为自定义操作代理会专门查找这些文件。</font></font></font></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="compiling" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Compiling<a href="#compiling" class="hash-link" aria-label="Direct link to Compiling" title="Direct link to Compiling" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">编译</font></font></font></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">csc.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /target:library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /r:$(DTFbin)\WixToolset.Dtf.WindowsInstaller.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /out:SampleCAs.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *.cs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="wrapping" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Wrapping<a href="#wrapping" class="hash-link" aria-label="Direct link to Wrapping" title="Direct link to Wrapping" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">包装</font></font></font></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MakeSfxCA.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $(OutDir)\SampleCAsPackage.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $(DTFbin)\SfxCA.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SampleCAs.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CustomAction.config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $(DTFbin)\WixToolset.Dtf.WindowsInstaller.dll</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Now the resulting package, SampleCAsPackage.dll, is ready to be inserted into the Binary table of the MSI.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">现在生成的包 SampleCAsPackage.dll 已准备好插入 MSI 的 Binary 表中。</font></font></font></p><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">For a working example of building a managed custom action package you can look at included sample ManagedCAs project.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">有关构建托管自定义操作包的工作示例，您可以查看包含的示例 ManagedCAs 项目。</font></font></font></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="debugging-managed-custom-actions" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Debugging Managed Custom Actions<a href="#debugging-managed-custom-actions" class="hash-link" aria-label="Direct link to Debugging Managed Custom Actions" title="Direct link to Debugging Managed Custom Actions" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">​</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">调试托管自定义操作</font></font></font></h3><p data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">There are two ways to attach a debugger to a managed custom action.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">有两种方法可以将调试器附加到托管自定义操作。</font></font></font></p><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1"><strong data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">Attach to message box:</strong> Add some temporary code to your custom action to display a message box. Then when the message box pops up at install time, you can attch your debugger to that process (usually identifiable by the title of the message box). Once attached, you can ensure that symbols are loaded if necessary (they will be automatically loaded if PDB files were embedded in the CA assembly at build time), then set breakpoints anywhere in the custom action code.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">附加到消息框：在您的自定义操作中添加一些临时代码以显示消息框。然后，当安装时消息框弹出时，您可以将调试器附加到该进程（通常通过消息框的标题识别）。附加后，您可以确保必要时加载符号（如果在构建时将 PDB 文件嵌入到 CA 程序集，则会自动加载），然后在自定义操作代码中的任何位置设置断点。</font></font></font></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1"><strong data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">MMsiBreak environment variable:</strong> When debugging managed custom actions, you should use the MMsiBreak environment variable instead of MsiBreak. Set the MMsiBreak variable to the custom action entrypoint name. (Remember this might be different from the method name if it was overridden by the CustomActionAttribute.) When the CA proxy finds a matching name, the CLR JIT-debugging dialog will appear with text similar to "An exception 'Launch for user' has occurred in YourCustomActionName." The debug break occurs after the custom action assembly has been loaded, but just before custom action method is invoked. Once attached, you can ensure that symbols are loaded if necessary, then set breakpoints anywhere in the custom action code. Note: the MMsiBreak environment variable can also accept a comma-separated list of action names, any of which will cause a break when hit.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">MMsiBreak 环境变量：在调试托管自定义操作时，应使用 MMsiBreak 环境变量而不是 MsiBreak。将 MMsiBreak 变量设置为自定义操作入口点名称。（请记住，如果被 CustomActionAttribute 重写，这可能与方法名称不同。）当 CA 代理找到匹配的名称时，CLR JIT 调试对话框将出现，显示类似于“在 YourCustomActionName 中发生了‘为用户启动’异常”的文本。调试中断发生在自定义操作程序集加载之后，但在调用自定义操作方法之前。一旦附加，您可以确保必要时加载符号，然后在自定义操作代码中的任何位置设置断点。注意：MMsiBreak 环境变量还可以接受以逗号分隔的操作名称列表，任何一个命中都会导致中断。</font></font></font></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="theme-doc-footer-edit-meta-row row" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="col" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="https://github.com/wixtoolset/web/tree/master/src/Docusaurus/docs/tools/dtf.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">编辑此页面</font></font></font></a></div><div class="col lastUpdated_vwxv" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="pagination-nav__link pagination-nav__link--prev" href="/wixtoolset/docs/tools/wixext/directx/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="pagination-nav__sublabel" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Previous<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">以前</font></font></font></div><div class="pagination-nav__label" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">DirectX custom action<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">DirectX 自定义操作</font></font></font></div></a><a class="pagination-nav__link pagination-nav__link--next" href="/wixtoolset/docs/tools/preprocessor/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="pagination-nav__sublabel" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Next<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">下一步</font></font></font></div><div class="pagination-nav__label" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Preprocessor<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">预处理器</font></font></font></div></a></nav></div></div><div class="col col--3" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><ul class="table-of-contents table-of-contents__left-border" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#working-with-msi-databases" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Working with MSI Databases<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 MSI 数据库</font></font></font></a><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#querying-a-database" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Querying a database<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">查询数据库</font></font></font></a></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#updating-a-binary" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Updating a binary<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">更新二进制文件</font></font></font></a></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#about-handles" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">About handles<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">关于句柄</font></font></font></a></li></ul></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#working-with-cabinet-files" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Working with Cabinet Files<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用内阁文件</font></font></font></a><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#creating-a-cabinet" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Creating a cabinet<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">创建一个柜子</font></font></font></a></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#listing-a-cabinet" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Listing a cabinet<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">列出一个柜子</font></font></font></a></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#extracting-a-cabinet" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Extracting a cabinet<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">提取一个柜子</font></font></font></a></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#getting-progress" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Getting progress<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">获取进展</font></font></font></a></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#stream-based-compression" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Stream-based compression<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">基于流的压缩</font></font></font></a></li></ul></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#working-with-install-packages" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Working with Install Packages<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用安装包</font></font></font></a><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#updating-files-in-a-product-layout" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Updating files in a product layout<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">更新产品布局中的文件</font></font></font></a></li></ul></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#managed-custom-actions" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Managed Custom Actions<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">管理自定义操作</font></font></font></a><ul data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#proxy-for-managed-custom-actions" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Proxy for Managed Custom Actions<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">自定义操作的代理</font></font></font></a></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#how-to" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">How to<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如何</font></font></font></a></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#specifying-the-runtime-version" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Specifying the Runtime Version<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">指定运行时版本</font></font></font></a></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#sample-c-custom-action" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Sample C# Custom Action<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">示例 C# 自定义操作</font></font></font></a></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#building-managed-custom-actions" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Building Managed Custom Actions<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">构建托管自定义操作</font></font></font></a></li><li data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="#debugging-managed-custom-actions" class="table-of-contents__link toc-highlight" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Debugging Managed Custom Actions<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">调试托管自定义操作</font></font></font></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="container container-fluid" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="row footer__links" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="col footer__col" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="footer__title" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"></div><ul class="footer__items clean-list" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li class="footer__item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">
                  <p class="footer_label" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Support provided by<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">提供的支持</font></font></font></p>
                  <a href="https://www.firegiant.com/?utm_source=wixtoolset.org&amp;utm_medium=Display&amp;utm_content=footer" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">
                    <img src="/img/firegiant.png" alt="FireGiant" width="83.6875" height="22.5" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c">
                  </a>
                </li></ul></div><div class="col footer__col" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="footer__title" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Community<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">社区</font></font></font></div><ul class="footer__items clean-list" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li class="footer__item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="https://stackoverflow.com/questions/tagged/wix" target="_blank" rel="noopener noreferrer" class="footer__link-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Stack Overflow<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Stack 溢出</font></font></font><svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="https://www.youtube.com/wixtoolset" target="_blank" rel="noopener noreferrer" class="footer__link-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="https://twitter.com/wixtoolset" target="_blank" rel="noopener noreferrer" class="footer__link-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Twitter<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">推特</font></font></font><svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="footer__title" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">More<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">更多</font></font></font></div><ul class="footer__items clean-list" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><li class="footer__item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a class="footer__link-item" href="/wixtoolset/news/" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">News<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">新闻</font></font></font></a></li><li class="footer__item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="https://www.firegiant.com/services/" target="_blank" rel="noopener noreferrer" class="footer__link-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Enterprise<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">企业</font></font></font><svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><a href="https://github.com/wixtoolset/web" target="_blank" rel="noopener noreferrer" class="footer__link-item" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c"><div class="footer__copyright" data-immersive-translate-walked="a25d3281-3512-4562-883e-8eea5586d19c" data-immersive-translate-paragraph="1">Copyright © 2024 .NET Foundation and contributors.<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">版权所有 © 2024 .NET 基金会及贡献者。</font></font></font></div></div></div></footer></div>
<script src="/wixtoolset/assets/js/runtime~main.d4837c13.js"></script>
<script src="/wixtoolset/assets/js/main.81f55813.js"></script>

</body></html>