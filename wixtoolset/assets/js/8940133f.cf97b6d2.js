"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[45396],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>y});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(n),m=r,y=p["".concat(l,".").concat(m)]||p[m]||d[m]||a;return n?o.createElement(y,s(s({ref:t},u),{},{components:n})):o.createElement(y,s({ref:t},u))}));function y(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,s=new Array(a);s[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[p]="string"==typeof e?e:r,s[1]=i;for(var c=2;c<a;c++)s[c]=n[c];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},16756:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>l,default:()=>y,frontMatter:()=>i,metadata:()=>c,toc:()=>p});n(67294);var o=n(3905);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const i={title:"Adding Custom Actions",layout:"documentation",after:"extension_development_preprocessor"},l="Adding a Custom Action",c={unversionedId:"wixdev/extensions/authoring_custom_actions",id:"version-v3/wixdev/extensions/authoring_custom_actions",title:"Adding Custom Actions",description:"This example shows how to author a binary custom action called &quot;FooAction&quot;. A common example is a dll custom action that launches notepad.exe or some other application as part of their install. Before you start, you will need a sample dll that has an entrypoint called &quot;FooEntryPoint&quot;. This sample assumes you have already reviewed the Creating a Skeleton Extension topic.",source:"@site/versioned_docs/version-v3/wixdev/extensions/authoring_custom_actions.md",sourceDirName:"wixdev/extensions",slug:"/wixdev/extensions/authoring_custom_actions",permalink:"/wixtoolset/docs/v3/wixdev/extensions/authoring_custom_actions",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/versioned_docs/version-v3/wixdev/extensions/authoring_custom_actions.md",tags:[],version:"v3",frontMatter:{title:"Adding Custom Actions",layout:"documentation",after:"extension_development_preprocessor"}},u={},p=[{value:"Step 1: Create a Fragment",id:"step-1-create-a-fragment",level:2},{value:"Step 2: Add the custom action",id:"step-2-add-the-custom-action",level:2}],d={toc:p},m="wrapper";function y(e){var{components:t}=e,n=s(e,["components"]);return(0,o.kt)(m,a(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){r(e,t,n[t])}))}return e}({},d,n),{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"adding-a-custom-action"},"Adding a Custom Action"),(0,o.kt)("p",null,"This example shows how to author a binary custom action called ",'"',"FooAction",'"',". A common example is a dll custom action that launches notepad.exe or some other application as part of their install. Before you start, you will need a sample dll that has an entrypoint called ",'"',"FooEntryPoint",'"',". This sample assumes you have already reviewed the ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/wixdev/extensions/extension_development_simple_example"},"Creating a Skeleton Extension")," topic."),(0,o.kt)("h2",{id:"step-1-create-a-fragment"},"Step 1: Create a Fragment"),(0,o.kt)("p",null,"You could directly reference the custom action in the same source file as the product definition. However, that will not enable the same custom action to be used elsewhere. So rather than putting the custom action definition in the same source file, let","'","s exercise a little modularity and create a new source file to define the custom action called ",'"',"ca.wxs",'"',"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"&lt;?xml version='1.0'?&gt;\n&lt;Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'&gt;\n<b><span class=\"style1\">   &lt;Fragment&gt;</span>\n<span class=\"style1\">      &lt;CustomAction Id='FooAction' BinaryKey='FooBinary' DllEntry='FooEntryPoint' Execute='immediate'</span>\n<span class=\"style1\">                    Return='check'/&gt;</span>\n \n<span class=\"style1\">      &lt;Binary Id='FooBinary' SourceFile='foo.dll'/&gt;</span>\n<span class=\"style1\">   &lt;/Fragment&gt;</span></b>\n&lt;/Wix&gt;\n")),(0,o.kt)("p",null,"Okay, that","'","s it. We","'","re done with editing the ",'"',"ca.wxs",'"'," source file. That little bit of code should compile but it will not link. Remember linking requires that you have an entry section. A ","<","Fragment/",">"," alone is not an entry section. Go to the next step to link the source file."),(0,o.kt)("h2",{id:"step-2-add-the-custom-action"},"Step 2: Add the custom action"),(0,o.kt)("p",null,"We would need to link this source file along with a source file that contained ","<","Product/",">"," or ","<","Module/",">"," to successfully complete."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"&lt;?xml version='1.0'?&gt;\n&lt;Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'&gt;\n   &lt;Product Id='PUT-GUID-HERE' Name='Test Package' Language='1033' \n            Version='1.0.0.0' Manufacturer='.NET Foundation'&gt;\n      &lt;Package Description='My first Windows Installer package'\n            Comments='This is my first attempt at creating a Windows Installer database' \n            Manufacturer='.NET Foundation' InstallerVersion='200' Compressed='yes' /&gt;\n \n      &lt;Media Id='1' Cabinet='product.cab' EmbedCab='yes' /&gt;\n \n      &lt;Directory Id='TARGETDIR' Name='SourceDir'&gt;\n         &lt;Directory Id='ProgramFilesFolder' Name='PFiles'&gt;\n            &lt;Directory Id='MyDir' Name='Test Program'&gt;\n               &lt;Component Id='MyComponent' Guid='PUT-GUID-HERE'&gt;\n                  &lt;File Id='readme' Name='readme.txt' DiskId='1' Source='readme.txt' /&gt;\n               &lt;/Component&gt;\n \n               &lt;Merge Id='MyModule' Language='1033' SourceFile='module.msm' DiskId='1' /&gt;\n            &lt;/Directory&gt;\n         &lt;/Directory&gt;\n      &lt;/Directory&gt;\n \n      &lt;Feature Id='MyFeature' Title='My 1st Feature' Level='1'&gt;\n         &lt;ComponentRef Id='MyComponent' /&gt;\n         &lt;MergeRef Id='MyModule' /&gt;\n      &lt;/Feature&gt;\n<b>\n <span class=\"style1\">     &lt;InstallExecuteSequence&gt;</span>\n<span class=\"style1\">         &lt;Custom Action='FooAction' After='InstallFiles'/&gt;</span>\n<span class=\"style1\">      &lt;/InstallExecuteSequence&gt;</span></b>\n   &lt;/Product&gt;\n&lt;/Wix&gt;\n")),(0,o.kt)("p",null,"Those three lines are all you need to add to your Windows Installer package source file to call the ",'"',"FooAction",'"'," CustomAction. Now that we have two files to link together our call to light.exe gets a little more complicated. Here are the compile, link, and installation steps."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'C:\\test&gt; <span class="style2">candle product.wxs ca.wxs</span>\n \nC:\\test&gt; <span class="style2">light product.wixobj ca.wixobj &ndash;out product.msi</span>\n \nC:\\test&gt; <span class="style2">msiexec /i product.msi</span>\n')),(0,o.kt)("p",null,"Now as part of your installation, whatever ",'"',"FooAction",'"'," is supposed to perform, you should see happen after the InstallFiles action."))}y.isMDXComponent=!0}}]);