"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[70135],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>h});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var s=n.createContext({}),c=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(r),m=o,h=u["".concat(s,".").concat(m)]||u[m]||d[m]||a;return r?n.createElement(h,i(i({ref:t},p),{},{components:r})):n.createElement(h,i({ref:t},p))}));function h(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:o,i[1]=l;for(var c=2;c<a;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},1858:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>c,toc:()=>u});r(67294);var n=r(3905);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function i(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}const l={wip:4822,type:"Feature",by:"Sean Hall (r sean hall at gmail.com)",title:"Don't Write ARP Entry",draft:!1},s=void 0,c={unversionedId:"development/wips/dont-write-arp-entry",id:"development/wips/dont-write-arp-entry",title:"Don't Write ARP Entry",description:"User stories",source:"@site/docs/development/wips/4822-dont-write-arp-entry.md",sourceDirName:"development/wips",slug:"/development/wips/dont-write-arp-entry",permalink:"/wixtoolset/docs/development/wips/dont-write-arp-entry",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/docs/development/wips/4822-dont-write-arp-entry.md",tags:[],version:"current",sidebarPosition:4822,frontMatter:{wip:4822,type:"Feature",by:"Sean Hall (r sean hall at gmail.com)",title:"Don't Write ARP Entry",draft:!1},sidebar:"docsSidebar",previous:{title:"Modify Burn API",permalink:"/wixtoolset/docs/development/wips/modify-burn-api"},next:{title:"Literal Variables in ThmUtil",permalink:"/wixtoolset/docs/development/wips/thmutil-literal-variables"}},p={},u=[{value:"User stories",id:"user-stories",level:2},{value:"Scenario",id:"scenario",level:2},{value:"Proposal",id:"proposal",level:2},{value:"Decision - Declined",id:"decision---declined",level:2},{value:"See Also",id:"see-also",level:2}],d={toc:u},m="wrapper";function h(e){var{components:t}=e,r=i(e,["components"]);return(0,n.kt)(m,a(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){o(e,t,r[t])}))}return e}({},d,r),{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"user-stories"},"User stories"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"As a Setup developer I can create a bundle with permanent packages such that the ARP entry is not written until the bundle is actually installed.")),(0,n.kt)("h2",{id:"scenario"},"Scenario"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"User starts the per-machine bundle on a clean machine."),(0,n.kt)("li",{parentName:"ol"},"The bundle has an MBA and needs to install the .NET Framework."),(0,n.kt)("li",{parentName:"ol"},"The bundle caches itself into the package cache."),(0,n.kt)("li",{parentName:"ol"},"The bundle registers in ARP."),(0,n.kt)("li",{parentName:"ol"},"The bundle creates a RunOnce key."),(0,n.kt)("li",{parentName:"ol"},"The bundle installs the permanent .NET package, which requires a reboot."),(0,n.kt)("li",{parentName:"ol"},"The BA requests restart from OnPackageComplete."),(0,n.kt)("li",{parentName:"ol"},"The bundle updates the RunOnce key to resume after the reboot."),(0,n.kt)("li",{parentName:"ol"},"The user allows the prereq BA to reboot the machine."),(0,n.kt)("li",{parentName:"ol"},"RunOnce starts the bundle elevated.")),(0,n.kt)("p",null,"Because RunOnce always starts the target program elevated, Burn needs to cache the bundle into the package cache (or other protected area) to be secure. In order to allow the user to clean up their machine, Burn is registering in ARP to give them a way to clean the cache. The ARP entry is confusing since it implies that the installation is complete. To avoid this confusion, Burn needs to make sure the ARP entry does not exist by the end of step 8."),(0,n.kt)("h2",{id:"proposal"},"Proposal"),(0,n.kt)("p",null,"Relax the requirement that there must be an entry in ARP while any part of the bundle is cached.\nThis allows Burn to remove the ARP entry by the end of step 8 while meeting all of the other requirements."),(0,n.kt)("h2",{id:"decision---declined"},"Decision - Declined"),(0,n.kt)("p",null,"It is unacceptable for any possibility of the bundle being cached without a corresponding ARP entry.\nThe ARP entry must always be written at the beginning of the chain."),(0,n.kt)("h2",{id:"see-also"},"See Also"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/wixtoolset/issues/issues/4822"},"WIXFEAT:4822"))))}h.isMDXComponent=!0}}]);