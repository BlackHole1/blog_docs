"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[17063],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),c=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),d=o,h=u["".concat(s,".").concat(d)]||u[d]||m[d]||a;return n?r.createElement(h,i(i({ref:t},p),{},{components:n})):r.createElement(h,i({ref:t},p))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:o,i[1]=l;for(var c=2;c<a;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},83205:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>c,toc:()=>u});n(67294);var r=n(3905);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const l={},s="How To: Create an Uninstall Shortcut",c={unversionedId:"howtos/files_and_registry/create_uninstall_shortcut",id:"version-v3/howtos/files_and_registry/create_uninstall_shortcut",title:"How To: Create an Uninstall Shortcut",description:"When installing an application it is a common requirement to place a shortcut on the user&apos;s Start Menu to provide a method of uninstalling the application. This how to demonstrates the steps required to create an uninstall shortcut on the start menu that passes all ICE validation checks.",source:"@site/versioned_docs/version-v3/howtos/files_and_registry/create_uninstall_shortcut.md",sourceDirName:"howtos/files_and_registry",slug:"/howtos/files_and_registry/create_uninstall_shortcut",permalink:"/wixtoolset/docs/v3/howtos/files_and_registry/create_uninstall_shortcut",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/versioned_docs/version-v3/howtos/files_and_registry/create_uninstall_shortcut.md",tags:[],version:"v3",frontMatter:{}},p={},u=[{value:"Step 1: Add the Uninstall Shortcut",id:"step-1-add-the-uninstall-shortcut",level:2},{value:"The Complete Sample",id:"the-complete-sample",level:2}],m={toc:u},d="wrapper";function h(e){var{components:t}=e,n=i(e,["components"]);return(0,r.kt)(d,a(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){o(e,t,n[t])}))}return e}({},m,n),{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"how-to-create-an-uninstall-shortcut"},"How To: Create an Uninstall Shortcut"),(0,r.kt)("p",null,"When installing an application it is a common requirement to place a shortcut on the user","'","s Start Menu to provide a method of uninstalling the application. This how to demonstrates the steps required to create an uninstall shortcut on the start menu that passes all ICE validation checks."),(0,r.kt)("p",null,"This how to assumes you are starting with the sample described the ",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/howtos/files_and_registry/create_start_menu_shortcut"},"How To: Create a Shortcut on the Start Menu")," topic."),(0,r.kt)("h2",{id:"step-1-add-the-uninstall-shortcut"},"Step 1: Add the Uninstall Shortcut"),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/shortcut"},"Shortcut")," element is used to add the uninstall shortcut to the start menu, and the shortcut points to msiexec.exe (the Windows Installer executable used to actually invoke the uninstall process). Anywhere within the existing ApplicationShortcut component add the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<Shortcut Id="UninstallProduct"\n          Name="Uninstall My Application"\n          Target="[SystemFolder]msiexec.exe"\n          Arguments="/x [ProductCode]"\n          Description="Uninstalls My Application" />\n')),(0,r.kt)("p",null,"The Target attribute points to the location of msiexec.exe. The Windows Installer ",(0,r.kt)("a",{target:"_blank",href:"http://msdn.microsoft.com/en-us/library/aa372055.aspx"},"SystemFolder")," property will resolve to the ",(0,r.kt)("em",{parentName:"p"},"System32")," directory where msiexec.exe resides. The Arguments attribute is used to let msiexec.exe know which product to uninstall by passing in the ProductCode for the install package."),(0,r.kt)("p",null,"To avoid ICE validation errors at build it is important to couple the Shortcut element with a registry entry and a RemoteFolder element. Both of these are described in more detail in the ",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/howtos/files_and_registry/create_start_menu_shortcut"},"How To: Create a Shortcut on the Start Menu")," topic, and are shown in the complete sample below."),(0,r.kt)("h2",{id:"the-complete-sample"},"The Complete Sample"),(0,r.kt)("p",null,"The following is a complete sample that uses the above concepts. This example can be inserted into a WiX project and compiled, or compiled and linked from the command line, to generate an installer."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">\n    <Product Id="*" UpgradeCode="PUT-GUID-HERE" Version="1.0.0.0" Language="1033" Name="My Application Name" Manufacturer="My Manufacturer Name">\n        <Package InstallerVersion="300" Compressed="yes"/>\n        <Media Id="1" Cabinet="myapplication.cab" EmbedCab="yes" />\n\n        <Directory Id="TARGETDIR" Name="SourceDir">\n            <Directory Id="ProgramFilesFolder">\n                <Directory Id="APPLICATIONROOTDIRECTORY" Name="My Application Name"/>\n            </Directory>\n            <Directory Id="ProgramMenuFolder">\n                <Directory Id="ApplicationProgramsFolder" Name="My Application Name"/>\n            </Directory>\n        </Directory>\n\n        <DirectoryRef Id="APPLICATIONROOTDIRECTORY">\n            <Component Id="myapplication.exe" Guid="PUT-GUID-HERE">\n                <File Id="myapplication.exe" Source="MySourceFiles\\MyApplication.exe" KeyPath="yes" Checksum="yes"/>\n            </Component>\n            <Component Id="documentation.html" Guid="PUT-GUID-HERE">\n                <File Id="documentation.html" Source="MySourceFiles\\documentation.html" KeyPath="yes"/>\n            </Component>\n        </DirectoryRef>\n\n        <DirectoryRef Id="ApplicationProgramsFolder">\n            <Component Id="ApplicationShortcut" Guid="PUT-GUID-HERE">\n                <Shortcut Id="ApplicationStartMenuShortcut"\n                          Name="My Application Name"\n                          Description="My Application Description"\n                          Target="[#myapplication.exe]"\n                          WorkingDirectory="APPLICATIONROOTDIRECTORY"/>\n                \x3c!-- Step 1: Add the uninstall shortcut to your installer package --\x3e\n                <Shortcut Id="UninstallProduct"\n                          Name="Uninstall My Application"\n                          Description="Uninstalls My Application"\n                          Target="[System64Folder]msiexec.exe"\n                          Arguments="/x [ProductCode]"/>\n                <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>\n                <RegistryValue Root="HKCU" Key="Software\\MyCompany\\MyApplicationName" Name="installed" Type="integer" Value="1" KeyPath="yes"/>\n            </Component>\n        </DirectoryRef>\n\n        <Feature Id="MainApplication" Title="Main Application" Level="1">\n            <ComponentRef Id="myapplication.exe" />\n            <ComponentRef Id="documentation.html" />\n            <ComponentRef Id="ApplicationShortcut" />\n        </Feature>\n    </Product>\n</Wix>\n')))}h.isMDXComponent=!0}}]);