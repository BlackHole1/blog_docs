"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[34360],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),m=o,f=u["".concat(l,".").concat(m)]||u[m]||d[m]||i;return n?r.createElement(f,a(a({ref:t},p),{},{components:n})):r.createElement(f,a({ref:t},p))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:o,a[1]=s;for(var c=2;c<i;c++)a[c]=n[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4510:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>f,frontMatter:()=>s,metadata:()=>c,toc:()=>u});n(67294);var r=n(3905);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function a(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const s={},l="How To: NGen Managed Assemblies During Installation",c={unversionedId:"howtos/files_and_registry/ngen_managed_assemblies",id:"version-v3/howtos/files_and_registry/ngen_managed_assemblies",title:"How To: NGen Managed Assemblies During Installation",description:"NGen during installation can improve your managed application&apos;s startup time by creating native images of the managed assemblies on the target machine. This how to describes using the WiX support to NGen managed assemblies at install time.",source:"@site/versioned_docs/version-v3/howtos/files_and_registry/ngen_managed_assemblies.md",sourceDirName:"howtos/files_and_registry",slug:"/howtos/files_and_registry/ngen_managed_assemblies",permalink:"/wixtoolset/docs/v3/howtos/files_and_registry/ngen_managed_assemblies",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/versioned_docs/version-v3/howtos/files_and_registry/ngen_managed_assemblies.md",tags:[],version:"v3",frontMatter:{}},p={},u=[{value:"Step 1: Add the WiX .NET extensions library to your project",id:"step-1-add-the-wix-net-extensions-library-to-your-project",level:2},{value:"Step 2: Add the WiX .NET extensions namespace to your project",id:"step-2-add-the-wix-net-extensions-namespace-to-your-project",level:2},{value:"Step 3: Mark the managed files for NGen",id:"step-3-mark-the-managed-files-for-ngen",level:2}],d={toc:u},m="wrapper";function f(e){var{components:t}=e,n=a(e,["components"]);return(0,r.kt)(m,i(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){o(e,t,n[t])}))}return e}({},d,n),{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"how-to-ngen-managed-assemblies-during-installation"},"How To: NGen Managed Assemblies During Installation"),(0,r.kt)("a",{target:"_blank",href:"http://msdn.microsoft.com/en-us/magazine/cc163808.aspx"},"NGen")," during installation can improve your managed application's startup time by creating native images of the managed assemblies on the target machine. This how to describes using the WiX support to NGen managed assemblies at install time.",(0,r.kt)("h2",{id:"step-1-add-the-wix-net-extensions-library-to-your-project"},"Step 1: Add the WiX .NET extensions library to your project"),(0,r.kt)("p",null,"The WiX support for NGen is included in a WiX extension library that must be added to your project prior to use. If you are using WiX on the command-line you need to add the following to your candle and light command lines:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"-ext WixNetFxExtension\n")),(0,r.kt)("p",null,"If you are using WiX in Visual Studio you can add the extensions using the Add Reference dialog:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Open your WiX project in Visual Studio"),(0,r.kt)("li",{parentName:"ol"},"Right click on your project in Solution Explorer and select Add Reference..."),(0,r.kt)("li",{parentName:"ol"},"Select the ",(0,r.kt)("strong",null,"WixNetFxExtension.dll")," assembly from the list and click Add"),(0,r.kt)("li",{parentName:"ol"},"Close the Add Reference dialog")),(0,r.kt)("h2",{id:"step-2-add-the-wix-net-extensions-namespace-to-your-project"},"Step 2: Add the WiX .NET extensions namespace to your project"),(0,r.kt)("p",null,"Once the library is added to your project you need to add the .NET extensions namespace to your project so you can access the appropriate WiX elements. To do this modify the top-level ",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/wix/"},"Wix")," element in your project by adding the following attribute:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension"\n')),(0,r.kt)("p",null,"A complete Wix element with the standard namespace and the .NET extensions namespace added looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"\n     xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension">\n')),(0,r.kt)("h2",{id:"step-3-mark-the-managed-files-for-ngen"},"Step 3: Mark the managed files for NGen"),(0,r.kt)("p",null,"Once you have the .NET extension library and namespace added to your project you can use the ",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/netfx/nativeimage"},"NetFx:NativeImage")," element to enable NGen on your managed assemblies. The NativeImage element goes inside a parent File element:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<Component Id="myapplication.exe" Guid="PUT-GUID-HERE">\n    <File Id="myapplication.exe" Source="MySourceFiles\\MyApplication.exe" KeyPath="yes" Checksum="yes">\n        <netfx:NativeImage Id="ngen_MyApplication.exe" Platform="32bit" Priority="0" AppBaseDirectory="APPLICATIONROOTDIRECTORY"/>\n    </File>\n</Component>\n')),(0,r.kt)("p",null,"The Id attribute is a unique identifier for the native image. The Platform attribute specifies the platforms for which the native image should be generated, in this case 32-bit. The Priority attribute specifies when the image generation should occur, in this case immediately during the setup process. The AppBaseDirectory attribute identifies the directory to use to search for dependent assemblies during the image generation. In this case it is set to the install directory for the application."))}f.isMDXComponent=!0}}]);