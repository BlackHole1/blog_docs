"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[4037],{3905:(e,t,i)=>{i.d(t,{Zo:()=>u,kt:()=>h});var n=i(67294);function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)i=r[n],t.indexOf(i)>=0||(o[i]=e[i]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}var s=n.createContext({}),p=function(e){var t=n.useContext(s),i=t;return e&&(i="function"==typeof e?e(t):a(a({},t),e)),i},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},v=n.forwardRef((function(e,t){var i=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(i),v=o,h=c["".concat(s,".").concat(v)]||c[v]||d[v]||r;return i?n.createElement(h,a(a({ref:t},u),{},{components:i})):n.createElement(h,a({ref:t},u))}));function h(e,t){var i=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=i.length,a=new Array(r);a[0]=v;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:o,a[1]=l;for(var p=2;p<r;p++)a[p]=i[p];return n.createElement.apply(null,a)}return n.createElement.apply(null,i)}v.displayName="MDXCreateElement"},54912:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>p,toc:()=>c});i(67294);var n=i(3905);function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function r(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}(Object(t)).forEach((function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})),e}function a(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)i=r[n],t.indexOf(i)>=0||(o[i]=e[i]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}const l={wip:5492,type:"Feature",by:"Rob Mensching (rob at firegiant.com)",title:"Votive via VS Marketplace"},s=void 0,p={unversionedId:"development/wips/votive-via-vs-marketplace",id:"development/wips/votive-via-vs-marketplace",title:"Votive via VS Marketplace",description:"User stories",source:"@site/docs/development/wips/5492-votive-via-vs-marketplace.md",sourceDirName:"development/wips",slug:"/development/wips/votive-via-vs-marketplace",permalink:"/wixtoolset/docs/development/wips/votive-via-vs-marketplace",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/docs/development/wips/5492-votive-via-vs-marketplace.md",tags:[],version:"current",sidebarPosition:5492,frontMatter:{wip:5492,type:"Feature",by:"Rob Mensching (rob at firegiant.com)",title:"Votive via VS Marketplace"},sidebar:"docsSidebar",previous:{title:"Repository Reorganization",permalink:"/wixtoolset/docs/development/wips/repository-reorganization"},next:{title:"XML file search",permalink:"/wixtoolset/docs/development/wips/add-search-capability-inside-xml-file"}},u={},c=[{value:"User stories",id:"user-stories",level:2},{value:"Proposal",id:"proposal",level:2},{value:"Considerations",id:"considerations",level:2},{value:"See Also",id:"see-also",level:2}],d={toc:c},v="wrapper";function h(e){var{components:t}=e,i=a(e,["components"]);return(0,n.kt)(v,r(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){o(e,t,i[t])}))}return e}({},d,i),{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"user-stories"},"User stories"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"As a setup developer I can install Votive such that I can use the WiX\nToolset in Visual Studio 2017.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"As a setup developer I can install the WiX Toolset quickly.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"As a non-setup developer I can install only Votive such that opening a\nsolution with a .wixproj does not error.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"As a WiX developer I can see how many times Votive is installed into each\nVisual Studio version such that I can make educated decisions about future\nVisual Studio support."))),(0,n.kt)("h2",{id:"proposal"},"Proposal"),(0,n.kt)("p",null,"Visual Studio 2017 introduced a number of breaking changes that makes it\nchallenging to impossible to distribute Visual Studio Extensions purely via an MSI\npackage. To support VS2017, the WiX Toolset will publish Votive via VSIX to\nthe ",(0,n.kt)("a",{parentName:"p",href:"https://marketplace.visualstudio.com/"},"Visual Studio Marketplace"),". When the ",(0,n.kt)("a",{parentName:"p",href:"/wixtoolset/docs/development/wips/repository-reorganization"},"Repository Reorganization"),"\nwork is complete, Votive will be removed from the WiX Toolset bundle and\nonly available from the Visual Studio Marketplace for all versions of Visual Studio."),(0,n.kt)("p",null,'The "WiX Toolset Visual Studio YYYY Extension" (where YYYY is 2010, 2012, 2013,\n2015 or 2017) will be the display name for Votive in the Marketplace. There will be\na separate entry in the Marketplace for each Visual Studio version so we get\naccurate download numbers of Votive per Visual Studio version.'),(0,n.kt)("p",null,"In addition to VS2017 support, publishing Votive independent of the WiX Toolset\nenables non-setup developers to install the Votive without installing all of\nthe WiX Toolset. This will allow .sln files with .wixprojs to load without error\nalthough the projects cannot be built. However, it is easy to use Visual Studio's\nusing Solution Build Configuration Manager to create a build configuration that\nskips .wixprojs."),(0,n.kt)("p",null,"A final benefit of extracting Votive from the WiX Toolset bundle, is that the WiX\nToolset will now install/uninstall/update very quickly. Today the bulk of the\ntime spent in installation is executing ",(0,n.kt)("inlineCode",{parentName:"p"},"devenv /setup")," so Visual Studio will\nrecognize Votive. That will no longer be necessary when Votive is available\nonly via the Visual Studio Marketplace."),(0,n.kt)("p",null,'There is a singular disadvantage. The WiX Toolset bundle will longer install\n"everything you need to get going" for everyone. On a clean machine it will\ntake two steps for developers to get Visual Studio fully configured. We could\nre-create the single installation experience if we introduced the VSIX installs\ninto the bundle. But this would skew installation numbers via Visual Studio\nMarketplace and slow the installation again (VSIXs take a bit to detect whether\nthey are applicable).'),(0,n.kt)("p",null,'For now we\'ll go with the simple solution of distributing the "WiX Toolset Visual\nStudio YYYY Extension" solely via the Visual Studio Marketplace.'),(0,n.kt)("h2",{id:"considerations"},"Considerations"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},'When the "WiX Toolset Visual Studio YYYY Extension" is available for pre-2017\nVisual Studio versions there is the potential for confusion in WiX v3.x since\nVotive is still installed as part of the WiX Toolset. One consideration is to\nintroduce this change into WiX v3.11 so developers are exposed to the change\nas soon as possible.')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"The VSIX identifiers will use ",(0,n.kt)("inlineCode",{parentName:"p"},"WixToolset.Dev##")," where ",(0,n.kt)("inlineCode",{parentName:"p"},"##"),' is the codename\nfor Visual Studio. This removes the necessity of updating pre-released VSIXs\nwhen the marketing name of Visual Studio is finally known. For example,\n"WiX Toolset Visual Studio 2017 Extension" will always use the id\n',(0,n.kt)("inlineCode",{parentName:"p"},"WixToolset.Dev15")," even though the display name metdata would be updated\nwhen the VS marketing name is known.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"It is technically possibile to ship VS2010-VS2015 support or VS2012-VS2017\nsupport in a single VSIX. However, it is not possible to ship VS2010 and\nVS2017 support in the same VSIX. This is moot since we want separate entries\nin the Visual Studio Marketplace for each VS version to track download\nnumbers correctly."))),(0,n.kt)("h2",{id:"see-also"},"See Also"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/wixtoolset/issues/issues/5492"},"WIXFEAT:5492 - Votive via VS Marketplace"))))}h.isMDXComponent=!0}}]);