"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[49613],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>d});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),m=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=m(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=m(n),g=r,d=p["".concat(l,".").concat(g)]||p[g]||u[g]||i;return n?a.createElement(d,o(o({ref:t},c),{},{components:n})):a.createElement(d,o({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=g;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:r,o[1]=s;for(var m=2;m<i;m++)o[m]=n[m];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},79756:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>s,metadata:()=>m,toc:()=>p});n(67294);var a=n(3905);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const s={title:"WixGamingExtension",layout:"documentation",after:"using_standard_customactions"},l="WixGamingExtension",m={unversionedId:"customactions/wixgamingextension",id:"version-v3/customactions/wixgamingextension",title:"WixGamingExtension",description:"The WixGamingExtension lets you register your application as a game in Windows Vista and later, in three main categories:",source:"@site/versioned_docs/version-v3/customactions/wixgamingextension.md",sourceDirName:"customactions",slug:"/customactions/wixgamingextension",permalink:"/wixtoolset/docs/v3/customactions/wixgamingextension",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/versioned_docs/version-v3/customactions/wixgamingextension.md",tags:[],version:"v3",frontMatter:{title:"WixGamingExtension",layout:"documentation",after:"using_standard_customactions"}},c={},p=[{value:"Game Explorer integration",id:"game-explorer-integration",level:2},{value:"Game Explorer tasks",id:"game-explorer-tasks",level:2},{value:"Rich saved-game preview",id:"rich-saved-game-preview",level:2}],u={toc:p},g="wrapper";function d(e){var{components:t}=e,n=o(e,["components"]);return(0,a.kt)(g,i(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){r(e,t,n[t])}))}return e}({},u,n),{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"wixgamingextension"},"WixGamingExtension"),(0,a.kt)("p",null,"The ",(0,a.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/gaming/"},"WixGamingExtension")," lets you register your application as a game in Windows Vista and later, in three main categories:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Game Explorer integration with game definition file"),(0,a.kt)("li",{parentName:"ul"},"Game Explorer tasks"),(0,a.kt)("li",{parentName:"ul"},"Rich saved-game preview")),(0,a.kt)("h2",{id:"game-explorer-integration"},"Game Explorer integration"),(0,a.kt)("p",null,"For an overview of Game Explorer, see ",(0,a.kt)("a",{href:"http://msdn.microsoft.com/library/bb173446.aspx",target:"_blank"},"Getting Started With Game Explorer"),". Game Explorer relies on an embedded file (game definition file or GDF) to control the data displayed about the game. For details about GDFs, see ",(0,a.kt)("a",{href:"http://msdn.microsoft.com/library/bb173445.aspx",target:"_blank"},"The Game-Definition-File (GDF) Schema")," and ",(0,a.kt)("a",{href:"http://msdn.microsoft.com/library/bb173443.aspx",target:"_blank"},"GDF Delivery and Localization"),". Using WixGamingExtension, you register a game with Game Explorer using the Game element as a child of your game executable","'","s File element:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'    <File Id="MyGameExeFile" Name="passenger_simulator.exe" KeyPath="yes">\n        <gaming:Game Id="985D5FD3-FC40-4CE9-9EE5-F2AAAB959230">\n        ...\n    </File>\n')),(0,a.kt)("p",null,"The Game/@Id attribute is used as the InstanceID attribute discussed ",(0,a.kt)("a",{href:"http://msdn.microsoft.com/library/bb173446.aspx#Step_4_Call_IGameExplorer_AddGame",target:"_blank"},"here"),", rather than generating new GUIDs at install time, which would require persisting the generated GUID and loading it for uninstall and maintenance mode."),(0,a.kt)("span",{class:"signature"},"Implementation note: Using the Game element adds a row to a custom table in your .msi package and schedules the Gaming custom action; at install time, that custom action adds/updates/removes the game in Game Explorer and for operating system upgrades. (See ",(0,a.kt)("a",{href:"http://msdn.microsoft.com/library/bb173449.aspx",target:"_blank"},"Supporting an Upgrade from Windows XP to Windows Vista")," for details.)"),(0,a.kt)("h2",{id:"game-explorer-tasks"},"Game Explorer tasks"),(0,a.kt)("p",null,"In Game Explorer, a game","'","s context menu includes custom ",(0,a.kt)("em",{parentName:"p"},"tasks"),":"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"Play tasks")," start the game with optional arguments."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"Support tasks")," start the user","'","s default browser to go to a specific URL.")),(0,a.kt)("p",null,"For details, see ",(0,a.kt)("a",{href:"http://msdn.microsoft.com/library/bb173450.aspx",target:"_blank"},"Game Explorer Tasks"),". In WixGameExtension, PlayTask and SupportTask are child elements of the Game element:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'    <File Id="MyGameExeFile" Name="passenger_simulator.exe" KeyPath="yes">\n        <gaming:Game Id="985D5FD3-FC40-4CE9-9EE5-F2AAAB959230">\n            <gaming:PlayTask Name="Play" Arguments="-go" />\n            <gaming:SupportTask Name="Help!" Address="http://example.com" />\n            ...\n        ...\n    </File>\n')),(0,a.kt)("p",null,"For details, see the ",(0,a.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/gaming/"},"Gaming schema documentation"),"."),(0,a.kt)("span",{class:"signature"},"Implementation note: Game Explorer tasks are shortcuts, so the Gaming compiler extension translates the PlayTask into rows in [Shortcuts](/wixtoolset/docs/v3/xsd/wix/shortcut) and SupportTask into WixUtilExtension [InternetShortcuts](/wixtoolset/docs/v3/xsd/util/internetshortcut). It also creates directories to hold the shortcuts and custom actions to set the directories."),(0,a.kt)("h2",{id:"rich-saved-game-preview"},"Rich saved-game preview"),(0,a.kt)("p",null,"Windows Vista includes a shell handler that lets games expose metadata in their saved-game files. For details, see ",(0,a.kt)("a",{href:"http://msdn.microsoft.com/library/bb173448.aspx",target:"_blank"},"Rich Saved Games"),". If your game supports rich saved games, you can register it for the rich saved-game preview using the WixGamingExtension IsRichSavedGame attribute on the ",(0,a.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/extension"},"Extension element"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'    <ProgId Id="MyGameProgId">\n        <Extension Id="MyGameSave" gaming:IsRichSavedGame="yes" />\n    </ProgId>\n')),(0,a.kt)("span",{class:"signature"},"Implementation note: The Gaming compiler extension translates the IsRichSavedGame attribute to rows in the MSI ",(0,a.kt)("a",{href:"http://msdn.microsoft.com/library/aa371168.aspx",target:"_blank"},"Registry")," table."))}d.isMDXComponent=!0}}]);