"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[38454],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>m});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var s=n.createContext({}),u=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},f=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,l=e.originalType,s=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),d=u(r),f=o,m=d["".concat(s,".").concat(f)]||d[f]||p[f]||l;return r?n.createElement(m,i(i({ref:t},c),{},{components:r})):n.createElement(m,i({ref:t},c))}));function m(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var l=r.length,i=new Array(l);i[0]=f;var a={};for(var s in t)hasOwnProperty.call(t,s)&&(a[s]=t[s]);a.originalType=e,a[d]="string"==typeof e?e:o,i[1]=a;for(var u=2;u<l;u++)i[u]=r[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}f.displayName="MDXCreateElement"},16987:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>m,frontMatter:()=>a,metadata:()=>u,toc:()=>d});r(67294);var n=r(3905);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function i(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}const a={title:"RemoveFolderEx Element (Util Extension)",layout:"documentation_xsd_extension"},s=void 0,u={unversionedId:"xsd/util/removefolderex",id:"version-v3/xsd/util/removefolderex",title:"RemoveFolderEx Element (Util Extension)",description:"Description",source:"@site/versioned_docs/version-v3/xsd/util/removefolderex.md",sourceDirName:"xsd/util",slug:"/xsd/util/removefolderex",permalink:"/wixtoolset/docs/v3/xsd/util/removefolderex",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/versioned_docs/version-v3/xsd/util/removefolderex.md",tags:[],version:"v3",frontMatter:{title:"RemoveFolderEx Element (Util Extension)",layout:"documentation_xsd_extension"}},c={},d=[],p={toc:d},f="wrapper";function m(e){var{components:t}=e,r=i(e,["components"]);return(0,n.kt)(f,l(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){o(e,t,r[t])}))}return e}({},p,r),{components:t,mdxType:"MDXLayout"}),(0,n.kt)("dl",null,(0,n.kt)("dt",null,"Description"),(0,n.kt)("dd",null,"               Remove a folder and all contained files and folders if the parent component is selected for installation or removal.               The folder must be specified in the Property attribute as the name of a property that will have a value that resolves                to the full path of the folder before the CostInitialize action. Note that Directory ids cannot be used.                For more details, see the Remarks.           "),(0,n.kt)("dt",null,"Windows Installer references"),(0,n.kt)("dd",null,(0,n.kt)("a",{href:"http://msdn.microsoft.com/library/aa371201.aspx",target:"_blank"},"RemoveFile Table")),(0,n.kt)("dt",null,"Parents"),(0,n.kt)("dd",null,(0,n.kt)("a",{href:"../../wix/component/"},"Component")),(0,n.kt)("dt",null,"Inner Text"),(0,n.kt)("dd",null,"None"),(0,n.kt)("dt",null,"Children"),(0,n.kt)("dd",null,"None"),(0,n.kt)("dt",null,"Attributes"),(0,n.kt)("dd",null,(0,n.kt)("table",{cellspacing:"0",cellpadding:"0",class:"schema"},(0,n.kt)("tr",null,(0,n.kt)("th",{width:"15%"},"Name"),(0,n.kt)("th",{width:"15%"},"Type"),(0,n.kt)("th",{width:"65%"},"Description"),(0,n.kt)("th",{width:"15%"},"Required")),(0,n.kt)("tr",null,(0,n.kt)("td",null,"Id"),(0,n.kt)("td",null,"String"),(0,n.kt)("td",null,"Primary key used to identify this particular entry. If this is not specified, a stable identifier                   will be generated at compile time based on the other attributes."),(0,n.kt)("td",null,"\xa0")),(0,n.kt)("tr",null,(0,n.kt)("td",null,"On"),(0,n.kt)("td",null,"Enumeration"),(0,n.kt)("td",null,"                       This value determines when the folder may be removed.                     This attribute's value must be one of the following:",(0,n.kt)("dl",null,(0,n.kt)("dt",{class:"enumerationValue"},(0,n.kt)("dfn",null,"install")),(0,n.kt)("dd",null,"                                   Removes the folder only when the parent component is being installed (msiInstallStateLocal or msiInstallStateSource).                               "),(0,n.kt)("dt",{class:"enumerationValue"},(0,n.kt)("dfn",null,"uninstall")),(0,n.kt)("dd",null,"                                   Default: Removes the folder only when the parent component is being removed (msiInstallStateAbsent).                               "),(0,n.kt)("dt",{class:"enumerationValue"},(0,n.kt)("dfn",null,"both")),(0,n.kt)("dd",null,"                                   Removes the folder when the parent component is being installed or removed.                               "))),(0,n.kt)("td",null,"\xa0")),(0,n.kt)("tr",null,(0,n.kt)("td",null,"Property"),(0,n.kt)("td",null,"String"),(0,n.kt)("td",null,"                       The id of a property that resolves to the full path of the source directory.  The property does not have                       to exist in the installer database at creation time; it could be created at installation time by a custom                       action, on the command line, etc. The property value can contain environment variables surrounded by                        percent signs such as from a REG_EXPAND_SZ registry value; environment variables will be expanded before                        being evaluated for a full path.                   "),(0,n.kt)("td",null,"\xa0")))),(0,n.kt)("dt",null,"Remarks"),(0,n.kt)("dd",null,(0,n.kt)("p",null,"The custom action that implements RemoveFolderEx does so by writing temporary rows to the RemoveFile table                 for each subfolder of the root folder you specify. Because it might dramatically affect Windows Installer's                 ",(0,n.kt)("a",{href:"http://msdn.microsoft.com/en-us/library/aa368593.aspx"},"File Costing"),",                  the temporary rows must be written before the CostInitialize standard action. Unfortunately, MSI doesn't                 create properties for the Directory hierarchy in your package until later, in the CostFinalize action."),(0,n.kt)("p",null,"An easy workaround for a typical use case of removing a folder during uninstall is to write the directory                 path to the registry and to load it during uninstall. See                  ",(0,n.kt)("a",{href:"http://robmensching.com/blog/posts/2010/5/2/the-wix-toolsets-remember-property-pattern"},'The WiX toolset\'s "Remember Property" pattern'),"                 for an example."),(0,n.kt)("p",null,"If you use custom actions to set properties, ensure that they are scheduled before the WixRemoveFoldersEx custom action.")),(0,n.kt)("dt",null,"See Also"),(0,n.kt)("dd",null,(0,n.kt)("a",{href:"../"},"Util Schema"))))}m.isMDXComponent=!0}}]);