"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[14671],{3905:(t,e,n)=>{n.d(e,{Zo:()=>p,kt:()=>k});var a=n(67294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},l=Object.keys(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var s=a.createContext({}),c=function(t){var e=a.useContext(s),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},p=function(t){var e=c(t.components);return a.createElement(s.Provider,{value:e},t.children)},d="mdxType",m={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},u=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,l=t.originalType,s=t.parentName,p=o(t,["components","mdxType","originalType","parentName"]),d=c(n),u=r,k=d["".concat(s,".").concat(u)]||d[u]||m[u]||l;return n?a.createElement(k,i(i({ref:e},p),{},{components:n})):a.createElement(k,i({ref:e},p))}));function k(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var l=n.length,i=new Array(l);i[0]=u;var o={};for(var s in e)hasOwnProperty.call(e,s)&&(o[s]=e[s]);o.originalType=t,o[d]="string"==typeof t?t:r,i[1]=o;for(var c=2;c<l;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},33117:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>p,contentTitle:()=>s,default:()=>k,frontMatter:()=>o,metadata:()=>c,toc:()=>d});n(67294);var a=n(3905);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t}function i(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},l=Object.keys(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}const o={custom_edit_url:null,toc_max_heading_level:2},s="Transaction Class",c={unversionedId:"api/wixtoolset.dtf.windowsinstaller/transaction",id:"api/wixtoolset.dtf.windowsinstaller/transaction",title:"Transaction Class",description:"[MSI 4.5] Handle to a multi-session install transaction.",source:"@site/docs/api/wixtoolset.dtf.windowsinstaller/transaction.md",sourceDirName:"api/wixtoolset.dtf.windowsinstaller",slug:"/api/wixtoolset.dtf.windowsinstaller/transaction",permalink:"/wixtoolset/docs/api/wixtoolset.dtf.windowsinstaller/transaction",draft:!1,editUrl:null,tags:[],version:"current",frontMatter:{custom_edit_url:null,toc_max_heading_level:2},sidebar:"docsSidebar",previous:{title:"TextStyles Enumeration",permalink:"/wixtoolset/docs/api/wixtoolset.dtf.windowsinstaller/textstyles"},next:{title:"TransactionAttributes Enumeration",permalink:"/wixtoolset/docs/api/wixtoolset.dtf.windowsinstaller/transactionattributes"}},p={},d=[{value:"Methods",id:"methods",level:2},{value:"Properties",id:"properties",level:2},{value:"Events",id:"events",level:2},{value:"Remarks",id:"remarks",level:3},{value:"Commit() Method",id:"commit_nop",level:2},{value:"Declaration",id:"declaration",level:3},{value:"Remarks",id:"remarks-1",level:3},{value:"Exceptions",id:"exceptions",level:3},{value:"FromHandle(handle, ownsHandle) Method",id:"fromhandle_handle_ownshandle",level:2},{value:"Declaration",id:"declaration-1",level:3},{value:"Parameters",id:"parameters",level:3},{value:"Join(attributes) Method",id:"join_attributes",level:2},{value:"Declaration",id:"declaration-2",level:3},{value:"Parameters",id:"parameters-1",level:3},{value:"Remarks",id:"remarks-2",level:3},{value:"Exceptions",id:"exceptions-1",level:3},{value:"Rollback() Method",id:"rollback_nop",level:2},{value:"Declaration",id:"declaration-3",level:3},{value:"Remarks",id:"remarks-3",level:3},{value:"Exceptions",id:"exceptions-2",level:3},{value:"Name Property",id:"name",level:2},{value:"Declaration",id:"declaration-4",level:3},{value:"OwnerChanged Event",id:"ownerchanged",level:2},{value:"Declaration",id:"declaration-5",level:3},{value:"Value",id:"value",level:3}],m={toc:d},u="wrapper";function k(t){var{components:e}=t,n=i(t,["components"]);return(0,a.kt)(u,l(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),a.forEach((function(e){r(t,e,n[e])}))}return t}({},m,n),{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"transaction-class"},"Transaction Class"),(0,a.kt)("p",null,"[MSI 4.5]"," Handle to a multi-session install transaction."),(0,a.kt)("h2",{id:"methods"},"Methods"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Method"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"#commit_nop"},"Commit()")),(0,a.kt)("td",{parentName:"tr",align:null},"Ends the install transaction and commits all changes to the system belonging to the transaction.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"#fromhandle_handle_ownshandle"},"FromHandle(handle, ownsHandle)")),(0,a.kt)("td",{parentName:"tr",align:null},"Creates a new Transaction object from an integer handle.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"#join_attributes"},"Join(attributes)")),(0,a.kt)("td",{parentName:"tr",align:null},"Makes the current process the owner of the multi-package installation transaction.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"#rollback_nop"},"Rollback()")),(0,a.kt)("td",{parentName:"tr",align:null},"Ends the install transaction and undoes changes to the system belonging to the transaction.")))),(0,a.kt)("h2",{id:"properties"},"Properties"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Property"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"#name"},"Name")),(0,a.kt)("td",{parentName:"tr",align:null},"Gets the name of the transaction.")))),(0,a.kt)("h2",{id:"events"},"Events"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Event"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"#ownerchanged"},"OwnerChanged")),(0,a.kt)("td",{parentName:"tr",align:null},"Notifies listeners when the process that owns the transaction changed.")))),(0,a.kt)("h3",{id:"remarks"},"Remarks"),(0,a.kt)("p",null,"Win32 MSI APIs: ",(0,a.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/library/en-us/msi/setup/msibegintransaction.asp"},"MsiBeginTransaction"),"  ",(0,a.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/library/en-us/msi/setup/msijointransaction.asp"},"MsiJoinTransaction"),"  ",(0,a.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/library/en-us/msi/setup/msiendtransaction.asp"},"MsiEndTransaction")," "),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"WixToolset.Dtf.WindowsInstaller.dll")," version ",(0,a.kt)("inlineCode",{parentName:"p"},"5.0.0+41e11442b2ca93e444b60213b5ae99dcbab787d8")),(0,a.kt)("h2",{id:"commit_nop"},"Commit() Method"),(0,a.kt)("p",null,"Ends the install transaction and commits all changes to the system belonging to the transaction."),(0,a.kt)("h3",{id:"declaration"},"Declaration"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},"public void Commit()\n")),(0,a.kt)("h3",{id:"remarks-1"},"Remarks"),(0,a.kt)("p",null,"Runs any Commit Custom Actions and commits to the system any changes to Win32 or common language runtime assemblies. Deletes the rollback script, and after using this option, the transaction's changes can no longer be undone with a Rollback Installation.\nThis method can only be called by the current owner of the transaction.\nWin32 MSI API: ",(0,a.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/library/en-us/msi/setup/msiendtransaction.asp"},"MsiEndTransaction")," "),(0,a.kt)("h3",{id:"exceptions"},"Exceptions"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Exception"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"T:WixToolset.Dtf.WindowsInstaller.InstallerException"),(0,a.kt)("td",{parentName:"tr",align:null},"The transaction could not be committed.")))),(0,a.kt)("h2",{id:"fromhandle_handle_ownshandle"},"FromHandle(handle, ownsHandle) Method"),(0,a.kt)("p",null,"Creates a new Transaction object from an integer handle."),(0,a.kt)("h3",{id:"declaration-1"},"Declaration"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},"public static Transaction FromHandle(\n  IntPtr handle,\n  bool ownsHandle\n)\n")),(0,a.kt)("h3",{id:"parameters"},"Parameters"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"handle"),(0,a.kt)("td",{parentName:"tr",align:null},"IntPtr"),(0,a.kt)("td",{parentName:"tr",align:null},"Integer transaction handle")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"ownsHandle"),(0,a.kt)("td",{parentName:"tr",align:null},"bool"),(0,a.kt)("td",{parentName:"tr",align:null},"true to close the handle when this object is disposed")))),(0,a.kt)("h2",{id:"join_attributes"},"Join(attributes) Method"),(0,a.kt)("p",null,"Makes the current process the owner of the multi-package installation transaction."),(0,a.kt)("h3",{id:"declaration-2"},"Declaration"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},"public void Join(\n  TransactionAttributes attributes\n)\n")),(0,a.kt)("h3",{id:"parameters-1"},"Parameters"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"attributes"),(0,a.kt)("td",{parentName:"tr",align:null},"TransactionAttributes"),(0,a.kt)("td",{parentName:"tr",align:null},"Select optional behavior when joining the transaction.")))),(0,a.kt)("h3",{id:"remarks-2"},"Remarks"),(0,a.kt)("p",null,"Win32 MSI API: ",(0,a.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/library/en-us/msi/setup/msijointransaction.asp"},"MsiJoinTransaction")," "),(0,a.kt)("h3",{id:"exceptions-1"},"Exceptions"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Exception"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"T:WixToolset.Dtf.WindowsInstaller.InvalidHandleException"),(0,a.kt)("td",{parentName:"tr",align:null},"The transaction handle is not valid.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"T:WixToolset.Dtf.WindowsInstaller.InstallerException"),(0,a.kt)("td",{parentName:"tr",align:null},"The transaction could not be joined.")))),(0,a.kt)("h2",{id:"rollback_nop"},"Rollback() Method"),(0,a.kt)("p",null,"Ends the install transaction and undoes changes to the system belonging to the transaction."),(0,a.kt)("h3",{id:"declaration-3"},"Declaration"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},"public void Rollback()\n")),(0,a.kt)("h3",{id:"remarks-3"},"Remarks"),(0,a.kt)("p",null,"This method can only be called by the current owner of the transaction.\nWin32 MSI API: ",(0,a.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/library/en-us/msi/setup/msiendtransaction.asp"},"MsiEndTransaction")," "),(0,a.kt)("h3",{id:"exceptions-2"},"Exceptions"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Exception"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"T:WixToolset.Dtf.WindowsInstaller.InstallerException"),(0,a.kt)("td",{parentName:"tr",align:null},"The transaction could not be rolled back.")))),(0,a.kt)("h2",{id:"name"},"Name Property"),(0,a.kt)("p",null,"Gets the name of the transaction."),(0,a.kt)("h3",{id:"declaration-4"},"Declaration"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},"public string Name { get; set; } \n")),(0,a.kt)("h2",{id:"ownerchanged"},"OwnerChanged Event"),(0,a.kt)("p",null,"Notifies listeners when the process that owns the transaction changed."),(0,a.kt)("h3",{id:"declaration-5"},"Declaration"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},"public System.EventHandler<System.EventArgs> OwnerChanged\n")),(0,a.kt)("h3",{id:"value"},"Value"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"System.EventHandler<System.EventArgs>")))}k.isMDXComponent=!0}}]);