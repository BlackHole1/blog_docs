"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[70968],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=p(n),d=a,h=m["".concat(s,".").concat(d)]||m[d]||u[d]||o;return n?r.createElement(h,i(i({ref:t},c),{},{components:n})):r.createElement(h,i({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:a,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},17014:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>p,toc:()=>m});n(67294);var r=n(3905);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const l={custom_edit_url:null,sidebar_position:34},s="Class element",p={unversionedId:"schema/wxs/class",id:"schema/wxs/class",title:"Class element",description:"COM Class registration for parent Component.",source:"@site/docs/schema/wxs/class.md",sourceDirName:"schema/wxs",slug:"/schema/wxs/class",permalink:"/wixtoolset/docs/schema/wxs/class",draft:!1,editUrl:null,tags:[],version:"current",sidebarPosition:34,frontMatter:{custom_edit_url:null,sidebar_position:34},sidebar:"docsSidebar",previous:{title:"Chain element",permalink:"/wixtoolset/docs/schema/wxs/chain"},next:{title:"Column element",permalink:"/wixtoolset/docs/schema/wxs/column"}},c={},m=[{value:"Windows Installer references",id:"windows-installer-references",level:2},{value:"Parents",id:"parents",level:2},{value:"Children",id:"children",level:2},{value:"Remarks",id:"remarks",level:2},{value:"Attributes",id:"attributes",level:2},{value:"See also",id:"see-also",level:2}],u={toc:m},d="wrapper";function h(e){var{components:t}=e,n=i(e,["components"]);return(0,r.kt)(d,o(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){a(e,t,n[t])}))}return e}({},u,n),{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"class-element"},"Class element"),(0,r.kt)("p",null,"COM Class registration for parent Component."),(0,r.kt)("h2",{id:"windows-installer-references"},"Windows Installer references"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/win32/msi/class-table"},"Class Table"),", ",(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/win32/msi/progid-table"},"ProgId Table"),", ",(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/win32/msi/registry-table"},"Registry Table"),", ",(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/win32/msi/appid-table"},"AppId Table")),(0,r.kt)("h2",{id:"parents"},"Parents"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/file"},"File"),", ",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/typelib"},"TypeLib"),", ",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/appid"},"AppId"),", ",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/component"},"Component")),(0,r.kt)("h2",{id:"children"},"Children"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/wixtoolset/docs/schema/wxs/filetypemask"},"FileTypeMask")," "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/wixtoolset/docs/schema/wxs/interface"},"Interface")," "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/wixtoolset/docs/schema/wxs/progid"},"ProgId")," : A ProgId associated with Class must be a child element of the Class element")),(0,r.kt)("h2",{id:"remarks"},"Remarks"),(0,r.kt)("p",null,"When being used in unadvertised mode, the attributes in the Class element correspond to registry\nvalues under the ",(0,r.kt)("inlineCode",{parentName:"p"},"[HKCR\\CLSID\\{'{'}Id{'}'}]")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"[HKCR\\CLSID\\{'{'}Id{'}'}\\Context]")," keys as follows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Id, Context"),": ","[HKCR\\CLSID","{","'{'}Id{'}'}\\Context]"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Server"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}\\LocalServer32]",'\\@="',"[!comserv.dll]",'"'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ForeignServer"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}\\LocalServer32]",'\\@="mscoree.dll"'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"AppId"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}]",'\\AppId="{00000000-89AB-0000-0123-000000000000}"'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Argument"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}\\LocalServer32]",'\\@="',"[!comserv.dll]",' /arg1 /arg2 /arg3"'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Control"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}\\Control]"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Description"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}]",'\\@="Description of Example COM Component"'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Handler"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}\\InprocHandler32]",'\\@="handler.dll"'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Insertable"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}\\Insertable]"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Insertable"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}\\NotInsertable]"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Programmable"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}\\Programmable]"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"SafeForInitializing"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}\\Implemented Categories","{","7DD95801-9882-11CF-9FA9-00AA006C42C4}]"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ThreadingModel"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}\\LocalServer32]",'\\ThreadingModel="Apartment"'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"TypeLibId"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}\\TypeLib]",'\\@="{11111111-89AB-1111-0123-111111111111}"'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Version"),": ","[HKCR\\CLSID","{","01234567-89AB-CDEF-0123-456789ABCDEF}\\Version]",'\\@="1.0.0.0"')),(0,r.kt)("h2",{id:"attributes"},"Attributes"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Advertise")," (",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/yesnotype",title:'Values of this type will either be "yes"/"true" or "no"/"false".'},"YesNoTypeUnion"),')\n: Set this value to "yes" in order to create a normal Class table row. Set this value to\n"no" in order to generate Registry rows that perform similar registration (without the\noften problematic Windows Installer advertising behavior).'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"AppId")," (",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/guid",title:'Values of this type will look like: "01234567-89AB-CDEF-0123-456789ABCDEF" or "{01234567-89AB-CDEF-0123-456789ABCDEF}". Also allows "PUT-GUID-HERE" for use in examples.'},"Guid"),")\n: This attribute is only allowed when a Class is advertised. Using this attribute will reference an Application ID\ncontaining DCOM information for the associated application GUID. The value must correspond to an AppId/@Id of an\nAppId element nested under a Fragment, Module, or Package element. To associate an AppId with a non-advertised\nclass, nest the class within a parent AppId element."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Argument"),' (String)\n: This column is optional only when the Context column is set to "LocalServer"\nor "LocalServer32" server context. The text is registered as the argument against\nthe OLE server and is used by OLE for invoking the server. Note that the resolution\nof properties in the Argument field is limited. A property formatted as ',"[Property]",' in\nthis field can only be resolved if the property already has the intended value when\nthe component owning the class is installed. For example, for the argument "',"[#MyDoc.doc]",'"\nto resolve to the correct value, the same process must be installing the file MyDoc.doc and the\ncomponent that owns the class.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Context"),' ()\n: The server context(s) for this COM server. This attribute is optional for VB6 libraries that are marked "PublicNotCreateable".\nClass elements marked Advertised must specify at least one server context. It is most common for there to be a single value\nfor the Context attribute.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Control")," (",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/yesnotype",title:'Values of this type will either be "yes"/"true" or "no"/"false".'},"YesNoTypeUnion"),")\n: Set this attribute's value to 'yes' to identify an object as an ActiveX Control. The default value is 'no'."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Description")," (String)\n: Localized description associated with the Class ID and Program ID."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"ForeignServer"),' (String)\n: May only be specified if the value of the Advertise attribute is "no" and Server has not been specified. In addition, it may only\nbe used when the Class element is directly under the Component element. The value can be\nthat of an registry type (REG_SZ). This attribute should be used to specify foreign servers, such as mscoree.dll if needed.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Handler"),' (String)\n: The default inproc handler. May be optionally provided only for Context = LocalServer or\nLocalServer32. Value of "1" creates a 16-bit InprocHandler (appearing as the InprocHandler\nvalue). Value of "2" creates a 32-bit InprocHandler (appearing as the InprocHandler32 value).\nValue of "3" creates 16-bit as well as 32-bit InprocHandlers. A non-numeric value is treated\nas a system file that serves as the 32-bit InprocHandler (appearing as the InprocHandler32 value).'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Icon"),' (String)\n: The file providing the icon associated with this CLSID. Reference to an Icon element\n(should match the Id attribute of an Icon element). This is currently not supported if the\nvalue of the Advertise attribute is "no".'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"IconIndex")," (",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/integer",title:"Values of this type must be a non-negative integer or a preprocessor variable with the format `$(Variable)` or `$(var.Variable)`."},"Integer"),")\n: Icon index into the icon file."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Id")," (",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/guid",title:'Values of this type will look like: "01234567-89AB-CDEF-0123-456789ABCDEF" or "{01234567-89AB-CDEF-0123-456789ABCDEF}". Also allows "PUT-GUID-HERE" for use in examples.'},"Guid"),", required)\n: The Class identifier (CLSID) of a COM server."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Insertable")," (",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/yesnotype",title:'Values of this type will either be "yes"/"true" or "no"/"false".'},"YesNoTypeUnion"),")\n: Specifies the CLSID may be insertable."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Programmable")," (",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/yesnotype",title:'Values of this type will either be "yes"/"true" or "no"/"false".'},"YesNoTypeUnion"),")\n: Specifies the CLSID may be programmable."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"RelativePath")," (",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/yesnotype",title:'Values of this type will either be "yes"/"true" or "no"/"false".'},"YesNoTypeUnion"),')\n: When the value is "yes", the bare file name can be used for COM servers. The installer\nregisters the file name only instead of the complete path. This enables the server in\nthe current directory to take precedence and allows multiple copies of the same component.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"SafeForInitializing")," (",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/yesnotype",title:'Values of this type will either be "yes"/"true" or "no"/"false".'},"YesNoTypeUnion"),')\n: May only be specified if the value of the Advertise attribute is "no".'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"SafeForScripting")," (",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/yesnotype",title:'Values of this type will either be "yes"/"true" or "no"/"false".'},"YesNoTypeUnion"),')\n: May only be specified if the value of the Advertise attribute is "no".'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Server"),' (String)\n: May only be specified if the value of the Advertise attribute is "no" and the ForeignServer attribute is not specified. File Id of the\nCOM server file. If this element is nested under a File element, this value defaults to\nthe value of the parent File/@Id.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"ShortPath")," (",(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/yesnotype",title:'Values of this type will either be "yes"/"true" or "no"/"false".'},"YesNoTypeUnion"),")\n: Specifies whether or not to use the short path for the COM server. This can only apply when Advertise is set to 'no'. The default is 'no' meaning that it will use the long file name for the COM server."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"ThreadingModel")," (enumeration)\n: Threading model for the CLSID. This attribute's value must be one of the following:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"apartment")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"free")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"both")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"neutral")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"single")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"rental"))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Version")," (String)\n: Version for the CLSID."),(0,r.kt)("h2",{id:"see-also"},"See also"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/wixtoolset/docs/schema/wxs/appid"},"AppId")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/wixtoolset/web/blob/master/src/xsd4/wix.xsd"},"Edit the schema for this page")))}h.isMDXComponent=!0}}]);