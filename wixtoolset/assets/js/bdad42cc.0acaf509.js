"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[42734],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(n),h=r,f=d["".concat(s,".").concat(h)]||d[h]||u[h]||a;return n?o.createElement(f,i(i({ref:t},p),{},{components:n})):o.createElement(f,i({ref:t},p))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:r,i[1]=l;for(var c=2;c<a;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},56076:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>f,frontMatter:()=>l,metadata:()=>c,toc:()=>d});n(67294);var o=n(3905);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const l={},s="How To: Add a File To Your Installer",c={unversionedId:"howtos/files_and_registry/add_a_file",id:"version-v3/howtos/files_and_registry/add_a_file",title:"How To: Add a File To Your Installer",description:"Installing files is the most fundamental aspect of any installer, and is usually what leads people to build an installer in the first place. Learning how to place a file on disk using Windows Installer best practices not only ensures maintainability going forward, but also enables you to build patches later if necessary.",source:"@site/versioned_docs/version-v3/howtos/files_and_registry/add_a_file.md",sourceDirName:"howtos/files_and_registry",slug:"/howtos/files_and_registry/add_a_file",permalink:"/wixtoolset/docs/v3/howtos/files_and_registry/add_a_file",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/versioned_docs/version-v3/howtos/files_and_registry/add_a_file.md",tags:[],version:"v3",frontMatter:{}},p={},d=[{value:"Step 1: Define the directory structure",id:"step-1-define-the-directory-structure",level:2},{value:"Step 2: Add files to your installer package",id:"step-2-add-files-to-your-installer-package",level:2},{value:"Step 3: Tell Windows Installer to install the files",id:"step-3-tell-windows-installer-to-install-the-files",level:2},{value:"The Complete Sample",id:"the-complete-sample",level:2}],u={toc:d},h="wrapper";function f(e){var{components:t}=e,n=i(e,["components"]);return(0,o.kt)(h,a(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){r(e,t,n[t])}))}return e}({},u,n),{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"how-to-add-a-file-to-your-installer"},"How To: Add a File To Your Installer"),(0,o.kt)("p",null,"Installing files is the most fundamental aspect of any installer, and is usually what leads people to build an installer in the first place. Learning how to place a file on disk using Windows Installer best practices not only ensures maintainability going forward, but also enables you to build patches later if necessary."),(0,o.kt)("h2",{id:"step-1-define-the-directory-structure"},"Step 1: Define the directory structure"),(0,o.kt)("p",null,"Installers frequently have many files to install into a few locations on disk. To improve the readability of the WiX file, it is a good practice to define your installation directories first before listing the files you'll install. Directories are defined using the ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/directory"},"Directory")," element and describe the hierarchy of folders you would like to see on the target machine. The following sample defines a directory for the installation of the main application executable."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<Directory Id="TARGETDIR" Name="SourceDir">\n    <Directory Id="ProgramFilesFolder">\n        <Directory Id="APPLICATIONROOTDIRECTORY" Name="My Application Name"/>\n    </Directory>\n</Directory>\n')),(0,o.kt)("p",null,"The element with the id ",(0,o.kt)("a",{href:"http://msdn.microsoft.com/library/aa372064.aspx",target:"_blank"},"TARGETDIR")," is required by the Windows Installer and is the root of all directory structures for your installation. Every WiX project will have this directory element. The second element, with the id ",(0,o.kt)("a",{href:"http://msdn.microsoft.com/library/aa370881.aspx",target:"_blank"},"ProgramFilesFolder"),", uses a pre-defined Windows Installer property to reference the Program Files folder on the user's machine. In most cases this will resolve to ",(0,o.kt)("strong",null,"c:\\Program Files","\\"),". The third directory element creates your application's folder under Program Files, and it is given the id APPLICATIONROOTDIRECTORY for later use in the WiX project. The id is in all capital letters to make it a ",(0,o.kt)("a",{href:"http://msdn.microsoft.com/library/aa370912.aspx",target:"_blank"},"public property")," that can be set from UI or via the command line."),(0,o.kt)("p",null,"The result of these tags is a ",(0,o.kt)("strong",{parentName:"p"},"c:\\Program Files\\My Application Name")," folder on the target machine."),(0,o.kt)("h2",{id:"step-2-add-files-to-your-installer-package"},"Step 2: Add files to your installer package"),(0,o.kt)("p",null,"A file is added to the installer using two elements: a ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/component"},"Component")," element to specify an atomic unit of installation and a ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/file"},"File")," element to specify the file that should be installed."),(0,o.kt)("p",null,"The component element describes a set of resources (usually files, registry entries, and shortcuts) that need to be installed as a single unit. This is separate from whether the set of items consist of a logical feature the user can select to install which is discussed in Step 3. While it may not seem like a big deal when you are first authoring your installer, components play a critical role when you decide to build patches at a later date."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"In general, you should restrict yourself to a single file per component.")," The Windows Installer is designed to support thousands of components in a single installer, so unless you have a very good reason, keep to one file per component. ",(0,o.kt)("strong",{parentName:"p"},"Every component must have its own unique GUID"),". Failure to follow these two basic rules can lead to many problems down the road when it comes to servicing."),(0,o.kt)("p",null,"The following sample uses the directory structure defined in Step 1 to install two files: an application executable and a documentation file."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<DirectoryRef Id="APPLICATIONROOTDIRECTORY">\n    <Component Id="myapplication.exe" Guid="PUT-GUID-HERE">\n        <File Id="myapplication.exe" Source="MySourceFiles\\MyApplication.exe" KeyPath="yes" Checksum="yes"/>\n    </Component>\n    <Component Id="documentation.html" Guid="PUT-GUID-HERE">\n        <File Id="documentation.html" Source="MySourceFiles\\documentation.html" KeyPath="yes"/>\n    </Component>\n</DirectoryRef>\n')),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/directoryref"},"DirectoryRef")," element is used to refer to the directory structure created in step 1. By referencing the APPLICATIONROOTDIRECTORY directory, the files will be installed into the ",(0,o.kt)("strong",{parentName:"p"},"c:\\program files\\My Application Name")," folder. Underneath the DirectoryRef are two Component elements, one for each of the two files that will be installed. This is in keeping with the best practice of having one component per file. Each Component element is given an Id and a Guid. The Id is used to refer to the component later in the WiX project. The Guid is used later for patches and must be unique for each component. For information on generating GUIDs see ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/howtos/general/generate_guids"},"How To: Generate a GUID"),"."),(0,o.kt)("p",null,"Beneath each component is a File element that does the actual work of packaging your source files into the installer. The Id is used to refer to the file elsewhere in the WiX project. The Source attribute specifies the location of the file on your machine, so WiX can find it and build it into the installer."),(0,o.kt)("p",null,"The KeyPath attribute is set to yes to tell the Windows Installer that this particular file should be used to determine whether the component is installed. If you do not set the KeyPath attribute, WiX will look at the child elements under the component in sequential order and try to automatically select one of them as a key path. Allowing WiX to automatically select a key path can be dangerous because adding or removing child elements under the component can inadvertantly cause the key path to change, which can lead to installation problems. In general, you should always set the KeyPath attribute to yes to ensure that the key path will not inadvertantly change if you update your setup authoring in the future."),(0,o.kt)("p",null,"The Checksum attribute should be set to yes for executable files that have a checksum value in the file header (this is generally true for all executables), and is used by the Windows Installer to verify the validity of the file on re-install."),(0,o.kt)("h2",{id:"step-3-tell-windows-installer-to-install-the-files"},"Step 3: Tell Windows Installer to install the files"),(0,o.kt)("p",null,"After defining the directory structure and listing the files to package into the installer, the last step is to tell Windows Installer to actually install the files. The ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/feature"},"Feature")," element is used to do this, and is where you break up your installer into logical pieces that the user can install independently. The following example creates a single feature that installs the application executable and documentation from Step 2."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<Feature Id="MainApplication" Title="Main Application" Level="1">\n    <ComponentRef Id="myapplication.exe" />\n    <ComponentRef Id="documentation.html" />\n</Feature>\n')),(0,o.kt)("p",null,"The Feature is given a Id. If you are using an installer UI sequence that includes feature selection, the Title attribute contains the text displayed in the UI for the feature. The Level attribute should be set to 1 to enable the installation of the feature by default."),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/componentref"},"ComponentRef")," element is used to reference the components created in Step 2 via the Id attribute."),(0,o.kt)("h2",{id:"the-complete-sample"},"The Complete Sample"),(0,o.kt)("p",null,"The following is a complete sample that uses the above concepts. This example can be inserted into a WiX project and compiled, or compiled and linked from the command line, to generate an installer."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">\n    <Product Id="*" UpgradeCode="PUT-GUID-HERE" Version="1.0.0.0" Language="1033" Name="My Application Name" Manufacturer="My Manufacturer Name">\n        <Package InstallerVersion="300" Compressed="yes"/>\n        <Media Id="1" Cabinet="myapplication.cab" EmbedCab="yes" />\n\n        \x3c!-- Step 1: Define the directory structure --\x3e\n        <Directory Id="TARGETDIR" Name="SourceDir">\n            <Directory Id="ProgramFilesFolder">\n                <Directory Id="APPLICATIONROOTDIRECTORY" Name="My Application Name"/>\n            </Directory>\n        </Directory>\n\n        \x3c!-- Step 2: Add files to your installer package --\x3e\n        <DirectoryRef Id="APPLICATIONROOTDIRECTORY">\n            <Component Id="myapplication.exe" Guid="PUT-GUID-HERE">\n                <File Id="myapplication.exe" Source="MySourceFiles\\MyApplication.exe" KeyPath="yes" Checksum="yes"/>\n            </Component>\n            <Component Id="documentation.html" Guid="PUT-GUID-HERE">\n                <File Id="documentation.html" Source="MySourceFiles\\documentation.html" KeyPath="yes"/>\n            </Component>\n        </DirectoryRef>\n\n        \x3c!-- Step 3: Tell WiX to install the files --\x3e\n        <Feature Id="MainApplication" Title="Main Application" Level="1">\n            <ComponentRef Id="myapplication.exe" />\n            <ComponentRef Id="documentation" />\n        </Feature>\n    </Product>\n</Wix>\n')))}f.isMDXComponent=!0}}]);