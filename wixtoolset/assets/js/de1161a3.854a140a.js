"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[96577],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>x});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),d=o,x=u["".concat(s,".").concat(d)]||u[d]||m[d]||r;return n?a.createElement(x,i(i({ref:t},p),{},{components:n})):a.createElement(x,i({ref:t},p))}));function x(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:o,i[1]=l;for(var c=2;c<r;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},14189:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>x,frontMatter:()=>l,metadata:()=>c,toc:()=>u});n(67294);var a=n(3905);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const l={sidebar_position:40},s="WiX extensions and custom actions",c={unversionedId:"tools/wixext/index",id:"tools/wixext/index",title:"WiX extensions and custom actions",description:"WiX extends the functionality of Windows Installer by providing WiX Extensions that typically include compiler extensions to provide custom elements and attributes in your WiX authoring and custom actions to implement the extended functionality.",source:"@site/docs/tools/wixext/index.md",sourceDirName:"tools/wixext",slug:"/tools/wixext/",permalink:"/wixtoolset/docs/tools/wixext/",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/docs/tools/wixext/index.md",tags:[],version:"current",sidebarPosition:40,frontMatter:{sidebar_position:40},sidebar:"docsSidebar",previous:{title:"Wix.exe command-line reference",permalink:"/wixtoolset/docs/tools/wixexe"},next:{title:"WixUI dialog library",permalink:"/wixtoolset/docs/tools/wixext/wixui"}},p={},u=[{value:"Using extensions",id:"using-extensions",level:2},{value:"Loading extensions using the Wix.exe command-line tool",id:"loading-extensions-using-the-wixexe-command-line-tool",level:3},{value:"Loading extensions in a .wixproj MSBuild project",id:"loading-extensions-in-a-wixproj-msbuild-project",level:3},{value:"Declare the extension namespace",id:"declare-the-extension-namespace",level:3}],m={toc:u},d="wrapper";function x(e){var{components:t}=e,n=i(e,["components"]);return(0,a.kt)(d,r(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){o(e,t,n[t])}))}return e}({},m,n),{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"wix-extensions-and-custom-actions"},"WiX extensions and custom actions"),(0,a.kt)("p",null,"WiX extends the functionality of Windows Installer by providing ",(0,a.kt)("em",{parentName:"p"},"WiX Extensions")," that typically include compiler extensions to provide custom elements and attributes in your WiX authoring and custom actions to implement the extended functionality."),(0,a.kt)("p",null,"The following WiX extensions are provided by the WiX team:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Extension"),(0,a.kt)("th",{parentName:"tr",align:null},"Documentation"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.Bal.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/bal/"},"Bal schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.ComPlus.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/complus/"},"Complus schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.Dependency.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/dependency/"},"Dependency schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.DifxApp.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/difxapp/"},"Difxapp schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.DirectX.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/directx/"},"Directx schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.Firewall.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/firewall/"},"Firewall schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.Http.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/http/"},"Http schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.Iis.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/iis/"},"Iis schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.Msmq.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/msmq/"},"Msmq schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.Netfx.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/netfx/"},"Netfx schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.PowerShell.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/powershell/"},"Powershell schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.Sql.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/sql/"},"Sql schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.UI.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/ui/"},"UI schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.Util.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/util/"},"Util schema"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WixToolset.VisualStudio.wixext"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/wixtoolset/docs/schema/vs/"},"Vs schema"))))),(0,a.kt)("h2",{id:"using-extensions"},"Using extensions"),(0,a.kt)("p",null,"To use a WiX extension during the build of your project, you need to load the extension and reference its namespace in your WiX authoring."),(0,a.kt)("h3",{id:"loading-extensions-using-the-wixexe-command-line-tool"},"Loading extensions using the Wix.exe command-line tool"),(0,a.kt)("p",null,"To use a WiX extension when using the Wix.exe command-line .NET tool, you need to:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"/wixtoolset/docs/tools/wixexe#extensionadd"},"Add the extension to the WiX extension cache.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"/wixtoolset/docs/tools/wixexe#build"},"Use the extension when building."))),(0,a.kt)("p",null,"For example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},"wix extension add -g WixToolset.Util.wixext\nwix extension add -g WixToolset.Bal.wixext\nwix build Bundle.wxs Bundle.en-us.wxl -ext WixToolset.Util.wixext -ext WixToolset.Bal.wixext\n")),(0,a.kt)("h3",{id:"loading-extensions-in-a-wixproj-msbuild-project"},"Loading extensions in a .wixproj MSBuild project"),(0,a.kt)("p",null,"WiX extensions are available as NuGet packages on NuGet.org. You can reference them as ",(0,a.kt)("inlineCode",{parentName:"p"},"PackageReference")," items in your .wixproj MSBuild projects:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<ItemGroup>\n  <PackageReference Include="WixToolset.Bal.wixext" />\n  <PackageReference Include="WixToolset.Util.wixext" />\n</ItemGroup>\n')),(0,a.kt)("p",null,"You might need to specify a version for WiX extension packages (such as when they're prerelease packages):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<ItemGroup>\n  <PackageReference Include="WixToolset.Bal.wixext" Version="5.0.0-rc.2" />\n  <PackageReference Include="WixToolset.Util.wixext" Version="5.0.0-rc.2" />\n</ItemGroup>\n')),(0,a.kt)("p",null,"You need to restore package references. When using the ",(0,a.kt)("inlineCode",{parentName:"p"},"dotnet build")," command, restore is automatic. When using .NET Framework MSBuild, you can use the ",(0,a.kt)("inlineCode",{parentName:"p"},"-Restore")," switch on your ",(0,a.kt)("inlineCode",{parentName:"p"},"msbuild")," command line to run package restore before building."),(0,a.kt)("h3",{id:"declare-the-extension-namespace"},"Declare the extension namespace"),(0,a.kt)("p",null,"When you need to use a custom element from a WiX extension in your WiX authoring, you need to use the namespace of that extension. For example, the WixToolset.VisualStudio.wixext extension uses the ",(0,a.kt)("inlineCode",{parentName:"p"},"http://wixtoolset.org/schemas/v4/wxs/vs")," namespace for its elements so to use the WixToolset.VisualStudio.wixext extension element ",(0,a.kt)("inlineCode",{parentName:"p"},"FindVisualStudio"),", you might have authoring that looks like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml",metastring:"{3,6}","{3,6}":!0},'<Wix\n    xmlns="http://wixtoolset.org/schemas/v4/wxs"\n    xmlns:vs="http://wixtoolset.org/schemas/v4/wxs/vs">\n\n  <Package>\n    <vs:FindVisualStudio />\n\n    <PropertyRef Id="VS2022_ROOT_FOLDER" />\n  </Package>\n</Wix>\n')))}x.isMDXComponent=!0}}]);