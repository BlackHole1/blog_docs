"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[64553],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>x});var i=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var u=i.createContext({}),s=function(e){var t=i.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},l=function(e){var t=s(e.components);return i.createElement(u.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,u=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),p=s(n),d=o,x=p["".concat(u,".").concat(d)]||p[d]||m[d]||r;return n?i.createElement(x,a(a({ref:t},l),{},{components:n})):i.createElement(x,a({ref:t},l))}));function x(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,a=new Array(r);a[0]=d;var c={};for(var u in t)hasOwnProperty.call(t,u)&&(c[u]=t[u]);c.originalType=e,c[p]="string"==typeof e?e:o,a[1]=c;for(var s=2;s<r;s++)a[s]=n[s];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},49383:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>u,default:()=>x,frontMatter:()=>c,metadata:()=>s,toc:()=>p});n(67294);var i=n(3905);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function a(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const c={sidebar_position:30},u="Quiet execution custom actions",s={unversionedId:"tools/wixext/quietexec",id:"tools/wixext/quietexec",title:"Quiet execution custom actions",description:"The WixQuietExec custom action family allows you to run an arbitrary command line without showing any UI -- like the console windows that would otherwise appear appear when invoking the executable via Windows Installer's built-in custom action types. WixQuietExec and friends are included in WixToolset.Util.wixext.",source:"@site/docs/tools/wixext/quietexec.md",sourceDirName:"tools/wixext",slug:"/tools/wixext/quietexec",permalink:"/wixtoolset/docs/tools/wixext/quietexec",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/docs/tools/wixext/quietexec.md",tags:[],version:"current",sidebarPosition:30,frontMatter:{sidebar_position:30},sidebar:"docsSidebar",previous:{title:"Utility custom actions",permalink:"/wixtoolset/docs/tools/wixext/util"},next:{title:"Windows information custom actions",permalink:"/wixtoolset/docs/tools/wixext/wininfo"}},l={},p=[{value:"Architecture-specific custom action DLLs",id:"architecture-specific-custom-action-dlls",level:2},{value:"Quiet running as immediate custom actions",id:"quiet-running-as-immediate-custom-actions",level:2},{value:"Quiet running as deferred custom actions",id:"quiet-running-as-deferred-custom-actions",level:2},{value:"Silent running",id:"silent-running",level:2},{value:"64-bit awareness",id:"64-bit-awareness",level:2}],m={toc:p},d="wrapper";function x(e){var{components:t}=e,n=a(e,["components"]);return(0,i.kt)(d,r(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){o(e,t,n[t])}))}return e}({},m,n),{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"quiet-execution-custom-actions"},"Quiet execution custom actions"),(0,i.kt)("p",null,"The WixQuietExec custom action family allows you to run an arbitrary command line without showing any UI -- like the console windows that would otherwise appear appear when invoking the executable via Windows Installer's built-in custom action types. WixQuietExec and friends are included in WixToolset.Util.wixext."),(0,i.kt)("h2",{id:"architecture-specific-custom-action-dlls"},"Architecture-specific custom action DLLs"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/wixtoolset/docs/fourthree/faqs#customactionids"},"As noted in ",(0,i.kt)("em",{parentName:"a"},"Frequently-asked questions about upgrading from WiX v3 to WiX v4")),", some extra effort is sometimes required due to WiX v4's support for architecture-specific custom actions. That effort for WixQuietExec and friends is a little bit different:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The custom action ids are architecture-neutral (that is, they don't have architecture-specific suffixes)."),(0,i.kt)("li",{parentName:"ul"},"The custom action DLLs have architecture-specific ids.")),(0,i.kt)("p",null,"The preprocessor is your friend: The ",(0,i.kt)("inlineCode",{parentName:"p"},"$(sys.BUILDARCHSHORT)")," preprocessor variable contains the suffix you need for the custom action DLL id based on the architecture of the package you're building. For example, you can use ",(0,i.kt)("inlineCode",{parentName:"p"},'BinaryRef="Wix4UtilCA_$(sys.BUILDARCHSHORT)"')," in your ",(0,i.kt)("inlineCode",{parentName:"p"},"CustomAction")," authoring."),(0,i.kt)("h2",{id:"quiet-running-as-immediate-custom-actions"},"Quiet running as immediate custom actions"),(0,i.kt)("p",null,"When WixQuietExec is run as an immediate custom action, it executes the command stored in the WixQuietExecCmdLine property. The following is an example of authoring an immediate WixQuietExec custom action:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<SetProperty\n  Id="WixQuietExecCmdLine"\n  Value="&quot;[%ComSpec]&quot; /c ECHO %NUMBER_OF_PROCESSORS%"\n  Before="ConvolutedCoreCountCustomAction"\n  Sequence="execute"\n  />\n<CustomAction\n  Id="ConvolutedCoreCountCustomAction"\n  BinaryRef="Wix4UtilCA_$(sys.BUILDARCHSHORT)"\n  DllEntry="WixQuietExec"\n  Execute="immediate"\n  Return="check"\n  />\n...\n<InstallExecuteSequence>\n  <Custom Action="ConvolutedCoreCountCustomAction" Before="AppSearch" />\n</InstallExecuteSequence>\n')),(0,i.kt)("p",null,"If the exit code of the command line is nonzero, WixQuietExec returns ERROR_INSTALL_FAILURE. In this example, the setup fails because ",(0,i.kt)("inlineCode",{parentName:"p"},'Return="check"'),". Changing the Return attribute value to ",(0,i.kt)("inlineCode",{parentName:"p"},"ignore")," means the failure will be shown in the log (as normal) but execution will continue instead of failing."),(0,i.kt)("p",null,"WixQuietExec logs the command line and any console output from the processes it executes. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},'WixQuietExec:  "C:\\WINDOWS\\SysWOW64\\cmd.exe" /c ECHO %NUMBER_OF_PROCESSORS%\nWixQuietExec:  16\n')),(0,i.kt)("h2",{id:"quiet-running-as-deferred-custom-actions"},"Quiet running as deferred custom actions"),(0,i.kt)("p",null,"When WixQuietExec is run as a deferred custom action, it executes the command stored in the custom action data -- which is the value of the property with the same id as the custom action. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<SetProperty\n  Id="ConvolutedWhoAmICustomAction"\n  Value="&quot;[%ComSpec]&quot; /c WHOAMI"\n  Before="ConvolutedWhoAmICustomAction"\n  Sequence="execute"\n  />\n<CustomAction\n  Id="ConvolutedWhoAmICustomAction"\n  BinaryRef="Wix4UtilCA_$(sys.BUILDARCHSHORT)"\n  DllEntry="WixQuietExec"\n  Execute="deferred"\n  Impersonate="no"\n  Return="check"\n  />\n\n<InstallExecuteSequence>\n  <Custom Action="ConvolutedWhoAmICustomAction" After="InstallInitialize" />\n</InstallExecuteSequence>\n')),(0,i.kt)("p",null,"If the exit code of the command line is nonzero, WixQuietExec returns ERROR_INSTALL_FAILURE. In this example, the setup fails because ",(0,i.kt)("inlineCode",{parentName:"p"},'Return="check"'),". Changing the Return attribute value to ",(0,i.kt)("inlineCode",{parentName:"p"},"ignore")," means the failure will be shown in the log (as normal) but execution will continue instead of failing."),(0,i.kt)("p",null,"WixQuietExec logs the command line and any console output from the processes it executes. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},'WixQuietExec:  "C:\\WINDOWS\\SysWOW64\\cmd.exe" /c WHOAMI\nWixQuietExec:  nt authority\\system\n')),(0,i.kt)("h2",{id:"silent-running"},"Silent running"),(0,i.kt)("p",null,"As noted earlier, WixQuietExec's primary purpose is to hide any UI from launched processes. Also as noted above, WixQuietExec logs the console output from those processes. If you want to hide the UI ",(0,i.kt)("em",{parentName:"p"},"and")," hide the console output from being added to the log, use WixSilentExec and WixSilentExecCmdLine instead of WixQuietExec and WixQuietExecCmdLine:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<SetProperty\n  Id="WixSilentExecCmdLine"\n  Value="&quot;[%ComSpec]&quot; /c ECHO %NUMBER_OF_PROCESSORS%"\n  Before="ConvolutedCoreCountCustomAction"\n  Sequence="execute"\n  />\n<CustomAction\n  Id="ConvolutedCoreCountCustomAction"\n  BinaryRef="Wix4UtilCA_$(sys.BUILDARCHSHORT)"\n  DllEntry="WixSilentExec"\n  Execute="immediate"\n  Return="check"\n  />\n\n<InstallExecuteSequence>\n  <Custom Action="ConvolutedCoreCountCustomAction" Before="AppSearch" />\n</InstallExecuteSequence>\n')),(0,i.kt)("p",null,"WixSilentExec supports silent and deferred execution like WixQuietExec."),(0,i.kt)("h2",{id:"64-bit-awareness"},"64-bit awareness"),(0,i.kt)("p",null,"WixQuietExec64 and WixSilentExec64 are variants of WixQuietExec and WixSilentExec that are 32-bit custom actions (regardless of name) that are 64-bit aware. Specifically, they know how to turn off file-system redirections (for example) to support running 64-bit processes. WiX v4 has native custom actions for all three supported platforms (x86, x64, and Arm64), so if you need to call a 64-bit process from a 32-bit package, use those by hard-coding the ",(0,i.kt)("inlineCode",{parentName:"p"},"BinaryRef"),". For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<CustomAction\n  Id="MyDeferredCustomAction"\n  BinaryRef="Wix4UtilCA_X64"\n  DllEntry="WixQuietExec"\n  Execute="deferred"\n  Impersonate="no"\n  Return="check"\n  />\n')),(0,i.kt)("p",null,"WixQuietExec64 and WixSilentExec64 will be removed in the next major version of WiX."))}x.isMDXComponent=!0}}]);