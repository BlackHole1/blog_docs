"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[48193],{3905:(t,e,l)=>{l.d(e,{Zo:()=>s,kt:()=>g});var n=l(67294);function r(t,e,l){return e in t?Object.defineProperty(t,e,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[e]=l,t}function o(t,e){var l=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),l.push.apply(l,n)}return l}function a(t){for(var e=1;e<arguments.length;e++){var l=null!=arguments[e]?arguments[e]:{};e%2?o(Object(l),!0).forEach((function(e){r(t,e,l[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):o(Object(l)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(l,e))}))}return t}function i(t,e){if(null==t)return{};var l,n,r=function(t,e){if(null==t)return{};var l,n,r={},o=Object.keys(t);for(n=0;n<o.length;n++)l=o[n],e.indexOf(l)>=0||(r[l]=t[l]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)l=o[n],e.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(t,l)&&(r[l]=t[l])}return r}var u=n.createContext({}),p=function(t){var e=n.useContext(u),l=e;return t&&(l="function"==typeof t?t(e):a(a({},e),t)),l},s=function(t){var e=p(t.components);return n.createElement(u.Provider,{value:e},t.children)},k="mdxType",c={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},d=n.forwardRef((function(t,e){var l=t.components,r=t.mdxType,o=t.originalType,u=t.parentName,s=i(t,["components","mdxType","originalType","parentName"]),k=p(l),d=r,g=k["".concat(u,".").concat(d)]||k[d]||c[d]||o;return l?n.createElement(g,a(a({ref:e},s),{},{components:l})):n.createElement(g,a({ref:e},s))}));function g(t,e){var l=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var o=l.length,a=new Array(o);a[0]=d;var i={};for(var u in e)hasOwnProperty.call(e,u)&&(i[u]=e[u]);i.originalType=t,i[k]="string"==typeof t?t:r,a[1]=i;for(var p=2;p<o;p++)a[p]=l[p];return n.createElement.apply(null,a)}return n.createElement.apply(null,l)}d.displayName="MDXCreateElement"},76842:(t,e,l)=>{l.r(e),l.d(e,{assets:()=>s,contentTitle:()=>u,default:()=>g,frontMatter:()=>i,metadata:()=>p,toc:()=>k});l(67294);var n=l(3905);function r(t,e,l){return e in t?Object.defineProperty(t,e,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[e]=l,t}function o(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var l=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),l.push.apply(l,n)}return l}(Object(e)).forEach((function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(e,l))})),t}function a(t,e){if(null==t)return{};var l,n,r=function(t,e){if(null==t)return{};var l,n,r={},o=Object.keys(t);for(n=0;n<o.length;n++)l=o[n],e.indexOf(l)>=0||(r[l]=t[l]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)l=o[n],e.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(t,l)&&(r[l]=t[l])}return r}const i={},u="Harvest Tool (Heat)",p={unversionedId:"overview/heat",id:"version-v3/overview/heat",title:"Harvest Tool (Heat)",description:"Generates WiX authoring from various input formats.",source:"@site/versioned_docs/version-v3/overview/heat.md",sourceDirName:"overview",slug:"/overview/heat",permalink:"/wixtoolset/docs/v3/overview/heat",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/versioned_docs/version-v3/overview/heat.md",tags:[],version:"v3",frontMatter:{}},s={},k=[{value:"Usage Information",id:"usage-information",level:2},{value:"Command line examples",id:"command-line-examples",level:2},{value:"Harvest a directory",id:"harvest-a-directory",level:3},{value:"Harvest a file",id:"harvest-a-file",level:4},{value:"Harvest a Visual Studio project",id:"harvest-a-visual-studio-project",level:4},{value:"Harvest a Website",id:"harvest-a-website",level:4},{value:"Harvest a VB6 COM component",id:"harvest-a-vb6-com-component",level:4},{value:"Harvest performance counters",id:"harvest-performance-counters",level:4},{value:"Harvest a registry file",id:"harvest-a-registry-file",level:4}],c={toc:k},d="wrapper";function g(t){var{components:e}=t,l=a(t,["components"]);return(0,n.kt)(d,o(function(t){for(var e=1;e<arguments.length;e++){var l=null!=arguments[e]?arguments[e]:{},n=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(l).filter((function(t){return Object.getOwnPropertyDescriptor(l,t).enumerable})))),n.forEach((function(e){r(t,e,l[e])}))}return t}({},c,l),{components:e,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"harvest-tool-heat"},"Harvest Tool (Heat)"),(0,n.kt)("p",null,"Generates WiX authoring from various input formats."),(0,n.kt)("p",null,"Every time heat is run it regenerates the output file and any changes are lost."),(0,n.kt)("h2",{id:"usage-information"},"Usage Information"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"heat.exe [-?] harvestType <harvester arguments> -out sourceFile.wxs\n")),(0,n.kt)("p",null,"Heat supports the harvesting types:"),(0,n.kt)("table",{border:"1",cellspacing:"0",cellpadding:"2"},(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,(0,n.kt)("b",null,"Harvest Type"))),(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,(0,n.kt)("b",null,"Meaning")))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"dir\xa0")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Harvest a directory."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"file")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Harvest a file."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"project")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Harvest outputs of a Visual Studio project."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"website")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Harvest an IIS web site."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"perf")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Harvest performance counters from a category."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"reg")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Harvest registy information from a reg file..")))),(0,n.kt)("p",null,"Heat supports the following command line parameters:"),(0,n.kt)("table",{border:"1",cellspacing:"0",cellpadding:"2"},(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,(0,n.kt)("b",null,"Switch"))),(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,(0,n.kt)("b",null,"Meaning")))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-ag")),(0,n.kt)("td",null,(0,n.kt)("p",null,'Auto generate component guids at compile time, e.g. set Guid="*".'))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-cg <ComponentGroupName>")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Component group name (cannot contain spaces e.g -cg MyComponentGroup)."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-configuration")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Configuration to set when harvesting the project."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-directoryid")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Overridden directory id for generated directory elements."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-dr <DirectoryName>")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Directory reference to root directories (cannot contains spaces e.g. -dr MyAppDirRef)."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-ext <extension>")),(0,n.kt)("td",null,(0,n.kt)("p",null,'Extension assembly or "class, assembly".'))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-generate")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Specify what elements to generate, one of: components, container, payloadgroup, layout (default is components)."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-gg")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Generate guids now. All components are given a guid when heat is run."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-g1")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Generate component guids without curly braces."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-ke")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Keep empty directories."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-nologo")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Skip printing heat logo information."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-out")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Specify output file (default: write to current directory)."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-platform")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Platform to set when harvesting the project."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-pog:<group>")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Specify output group of Visual Studio project, one of: Binaries, Symbols, Documents, Satellites, Sources, Content."),(0,n.kt)("ul",null,(0,n.kt)("li",null,"Binaries - primary output of the project, e.g. the assembly exe or dll."),(0,n.kt)("li",null,"Symbols - debug symbol files, e.g. pdb."),(0,n.kt)("li",null,"Documents - documentation files."),(0,n.kt)("li",null,"Satellites - the localized resource assemblies."),(0,n.kt)("li",null,"Sources - source files."),(0,n.kt)("li",null,"Content - content files.")),(0,n.kt)("p",null,"This option may be repeated for multiple output groups; e.g. -pog:Binaries -pog:Content."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-projectname")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Overridden project name to use in variables."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-scom")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Suppress COM elements."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-sfrag")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Suppress generation of fragments for directories and components."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-srd")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Suppress harvesting the root directory as an element."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-sreg")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Suppress registry harvesting."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-suid")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Suppress unique identifiers for files, components, & directories."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-svb6")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Suppress VB6 COM registration entries. When registering a COM component created in VB6 it adds registry entries that are part of the VB6 runtime component. This flag is recommend for VB6 components to avoid breaking the VB6 runtime on uninstall."),(0,n.kt)("p",null,"The following values are excluded:",(0,n.kt)("ul",null,(0,n.kt)("li",null,"CLSID\\","{","D5DE8D20-ABB8-D1D1-A1E3-A0A0C90F2731","}"),(0,n.kt)("li",null,"Typelib\\","{","EA544A21-C82D-CCD1-A3E4-A0A0C90AEA82","}"),(0,n.kt)("li",null,"Typelib\\","{","F00204EF-A000-A000-C000-B00000000046","}"),(0,n.kt)("li",null,"Any Interfaces that reference these two type libraries"))))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-sw<N>")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Suppress all warnings or a specific message ID, e.g. -sw1011 -sw1012."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-swall")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Suppress all warnings (",(0,n.kt)("em",null,"deprecated"),")."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-t <xsl>")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Transform harvested output with XSL file."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-indent <n>")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Indentation multiple (overrides default of 4)."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-template <template>")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Use template, one of: fragment, module, product.",(0,n.kt)("br",null),"Default: fragment."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-v")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Verbose output."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-var <VariableName>")),(0,n.kt)("td",null,(0,n.kt)("p",null,'Substitute File/@Source="SourceDir" with a preprocessor or a wix variable (e.g. -var var.MySource will become File/@Source="$(var.MySource)\\myfile.txt" and -var wix.MySource will become File/@Source="!(wix.MySource)\\myfile.txt".'))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-wixvar")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Generate binder variables instead of preprocessor variables."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-wx[N]")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Treat all warnings or a specific message ID as an error. e.g. -wx1011 -wx1012."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-wxall")),(0,n.kt)("td",null,(0,n.kt)("p",null,"Treat all warnings as errors (",(0,n.kt)("em",null,"deprecated"),")."))),(0,n.kt)("tr",null,(0,n.kt)("td",{valign:"top"},(0,n.kt)("p",null,"-? | -help")),(0,n.kt)("td",null,(0,n.kt)("p",null,"\xa0Display heat help information.")))),(0,n.kt)("h2",{id:"command-line-examples"},"Command line examples"),(0,n.kt)("h3",{id:"harvest-a-directory"},"Harvest a directory"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'heat dir ".\\My Files" -gg -sfrag -template:fragment -out directory.wxs\n')),(0,n.kt)("p",null,"This will harvest the sub folder ",'"',"My Files",'"'," as a single fragment to the\nfile directory.wxs. It will generate guids for all the files as they are found."),(0,n.kt)("h4",{id:"harvest-a-file"},"Harvest a file"),(0,n.kt)("p",null,'heat file ".\\My Files\\File.dll" -ag -template:fragment -out file.wxs'),(0,n.kt)("p",null,"This will harvest the file ",'"',"File.dll",'"'," as a single fragment to the file\nfile.wxs. The component guid will be set to ",'"',"*",'"',"."),(0,n.kt)("h4",{id:"harvest-a-visual-studio-project"},"Harvest a Visual Studio project"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'heat project "MyProject.csproj" -pog:Binaries -ag -template:fragment -out project.wxs\n')),(0,n.kt)("p",null,"This will harvest the binary output files from the Visual Studio project ",'"',"MyProject.csproj",'"',"\nas a single fragment to the file project.wxs. The component guid will be set to ",'"',"*",'"',"."),(0,n.kt)("h4",{id:"harvest-a-website"},"Harvest a Website"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'heat website "Default Web Site" -template:fragment -out website.wxs\n')),(0,n.kt)("p",null,"This will harvest the website ",'"',"Default Web Site",'"'," as a single fragment\nto the file website.wxs."),(0,n.kt)("h4",{id:"harvest-a-vb6-com-component"},"Harvest a VB6 COM component"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'heat file ".\\My Files\\VB6File.dll" -ag -template:fragment -svb6 -out vb6file.wxs\n')),(0,n.kt)("p",null,"This will harvest the VB6 COM component ",'"',"VB6File.dll",'"',"as a single fragment\nto the file vb6file.wxs and suppress the VB6 runtime specific registy entries."),(0,n.kt)("h4",{id:"harvest-performance-counters"},"Harvest performance counters"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'heat perf "My Category" -out perf.wxs\n')),(0,n.kt)("p",null,"This will harvest all the performance counters from the category ",'"',"My Category",'"',"."),(0,n.kt)("h4",{id:"harvest-a-registry-file"},"Harvest a registry file"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"heat reg registry.reg -out reg.wxs\n")),(0,n.kt)("p",null,"This will harvest all the registry information from the file registry.reg. The registry\nfile can be either a standard ",'"',"Windows Registry Editor Version 5.00",'"'," reigstry\nfile or a legacy Win9.x/NT4 (REGEDIT4) reigstry file."))}g.isMDXComponent=!0}}]);