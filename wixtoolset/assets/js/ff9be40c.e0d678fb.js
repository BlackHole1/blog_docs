"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[77463],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>x});var i=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var u=i.createContext({}),l=function(e){var t=i.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},s=function(e){var t=l(e.components);return i.createElement(u.Provider,{value:t},e.children)},m="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,u=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),m=l(n),d=o,x=m["".concat(u,".").concat(d)]||m[d]||p[d]||r;return n?i.createElement(x,a(a({ref:t},s),{},{components:n})):i.createElement(x,a({ref:t},s))}));function x(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,a=new Array(r);a[0]=d;var c={};for(var u in t)hasOwnProperty.call(t,u)&&(c[u]=t[u]);c.originalType=e,c[m]="string"==typeof e?e:o,a[1]=c;for(var l=2;l<r;l++)a[l]=n[l];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},95293:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>u,default:()=>x,frontMatter:()=>c,metadata:()=>l,toc:()=>m});n(67294);var i=n(3905);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function a(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const c={title:"Quiet Execution Custom Action",layout:"documentation",after:"using_standard_customactions"},u="Quiet Execution Custom Action",l={unversionedId:"customactions/qtexec",id:"version-v3/customactions/qtexec",title:"Quiet Execution Custom Action",description:"The QtExec custom action allows you to run an arbitrary command line in an MSI-based setup in silent mode. QtExec is commonly used to suppress console windows that would otherwise appear appear when invoking the executable directly. The custom action is located in the WixCA library, which is a part of the WixUtilExtension.",source:"@site/versioned_docs/version-v3/customactions/qtexec.md",sourceDirName:"customactions",slug:"/customactions/qtexec",permalink:"/wixtoolset/docs/v3/customactions/qtexec",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/versioned_docs/version-v3/customactions/qtexec.md",tags:[],version:"v3",frontMatter:{title:"Quiet Execution Custom Action",layout:"documentation",after:"using_standard_customactions"}},s={},m=[{value:"Naming in WiX v3.x and WiX v4.0",id:"naming-in-wix-v3x-and-wix-v40",level:2},{value:"Immediate execution",id:"immediate-execution",level:2},{value:"Silent execution",id:"silent-execution",level:2},{value:"Deferred execution",id:"deferred-execution",level:2},{value:"Running 64-bit executables",id:"running-64-bit-executables",level:2},{value:"Building an MSI that uses QtExec",id:"building-an-msi-that-uses-qtexec",level:2}],p={toc:m},d="wrapper";function x(e){var{components:t}=e,n=a(e,["components"]);return(0,i.kt)(d,r(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){o(e,t,n[t])}))}return e}({},p,n),{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"quiet-execution-custom-action"},"Quiet Execution Custom Action"),(0,i.kt)("p",null,"The QtExec custom action allows you to run an arbitrary command line in an MSI-based setup in silent mode. QtExec is commonly used to suppress console windows that would otherwise appear appear when invoking the executable directly. The custom action is located in the WixCA library, which is a part of the WixUtilExtension."),(0,i.kt)("h2",{id:"naming-in-wix-v3x-and-wix-v40"},"Naming in WiX v3.x and WiX v4.0"),(0,i.kt)("p",null,"Prior to WiX v3.10, only ",(0,i.kt)("inlineCode",{parentName:"p"},"CAQuietExec")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"CAQuietExec64")," are available, which used the properties ",(0,i.kt)("inlineCode",{parentName:"p"},"QtExecCmdTimeout")," (used for both 32-bit and 64-bit custom actions), ",(0,i.kt)("inlineCode",{parentName:"p"},"QtExecCmdLine"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"QtExec64CmdLine"),"."),(0,i.kt)("p",null,"Starting in WiX v3.10, those same identifiers are available but the new, preferred custom action names are ",(0,i.kt)("inlineCode",{parentName:"p"},"WixQuietExec")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"WixQuietExec64")," with properties named ",(0,i.kt)("inlineCode",{parentName:"p"},"WixQuietExecCmdTimeout"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"WixQuietExec64CmdTimeout"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"WixQuietExecCmdLine"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"WixQuietExec64CmdLine"),"."),(0,i.kt)("p",null,"In WiX v4.0, only the ",(0,i.kt)("inlineCode",{parentName:"p"},"WixQuietExec")," names will be supported."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"WixSilentExec")," actions introduced in WiX v3.10 already support the new naming scheme."),(0,i.kt)("h2",{id:"immediate-execution"},"Immediate execution"),(0,i.kt)("p",null,"When the QtExec action is run as an immediate custom action, it will try to execute the command stored in the WixQuietExecCmdLine property. The following is an example of authoring an immediate QtExec custom action:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'    <Property Id="WixQuietExecCmdLine" Value="command line to run"/>\n    <CustomAction Id="QtExecExample" BinaryKey="WixCA" DllEntry="WixQuietExec" Execute="immediate" Return="check"/>\n    .\n    .\n    .\n    <InstallExecuteSequence>\n      <Custom Action="QtExecExample" After="TheActionYouWantItAfter"/>\n    </InstallExecuteSequence>\n')),(0,i.kt)("p",null,'This will result in running the command line in the immediate sequence. If the exit code of the command line in this example indicates an error (meaning that the return code is not equal to 0) then the setup will fail because the Return value is set to "check". Changing the Return value to "ignore" will cause the setup to log the failure but skip it and continue instead of failing the entire setup.'),(0,i.kt)("p",null,"If you want to run more than one command line in the immediate sequence then you will need to schedule multiple QtExec custom actions and set the WixQuietExecCmdLine property to a new value by scheduling a property-setting custom action immediately before each instance of the QtExec custom action."),(0,i.kt)("h2",{id:"silent-execution"},"Silent execution"),(0,i.kt)("p",null,"If you need to run a program without logging any of the input parameters or output of the executable ",(0,i.kt)("strong",{parentName:"p"},"for example, for security or privacy reasons,")," you want WixSilentExec:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'    <Property Id="WixSilentExecCmdLine" Value="command line to run" Hidden="yes"/>\n    <CustomAction Id="SilentExecExample" BinaryKey="WixCA" DllEntry="WixSilentExec" Execute="immediate" Return="check"/>\n    .\n    .\n    .\n    <InstallExecuteSequence>\n      <Custom Action="SilentExecExample" After="TheActionYouWantItAfter"/>\n    </InstallExecuteSequence>\n')),(0,i.kt)("p",null,"The ",(0,i.kt)("em",{parentName:"p"},"only")," difference in behavior between WixQuietExec and WixSilentExec is that WixSilentExec never logs the input or output of the command line. Take special note to mark the input property and other properties as hidden if you do not want them logged automatically by MSI."),(0,i.kt)("h2",{id:"deferred-execution"},"Deferred execution"),(0,i.kt)("p",null,"When the WixQuietExec (or WixSilentExec) action is run as a deferred custom action, it will try to execute the command line stored in the value of the custom action data. For deferred QtExec custom actions, the custom action data is a property that has the same Id value as the custom action Id. The following is an example of authoring a deferred QtExec custom action:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'    <Property Id="QtExecDeferredExample" Value="command line to run"/>\n    <CustomAction Id="QtExecDeferredExample" BinaryKey="WixCA" DllEntry="WixQuietExec"\n                Execute="deferred" Return="check" Impersonate="no"/>\n    .\n    .\n    .\n    <InstallExecuteSequence>\n      <Custom Action="QtExecDeferredExample" After="TheActionYouWantItAfter"/>\n    </InstallExecuteSequence>\n')),(0,i.kt)("p",null,"If you need to set a command line that uses other Windows Installer properties, you must schedule an immediate custom action to set the command line property value and schedule a deferred custom action to run QtExec. The property Id used in the SetProperty custom action must match the Id value used in the deferred custom action. A common use of this pattern for QtExec custom actions is to run an executable that will be installed as a part of the setup. The following is an example of authoring a deferred QtExec custom action that relies on another property value:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'    <SetProperty Id="QtExecDeferredExampleWithProperty" Value=""[#MyExecutable.exe]""\n                Sequence="execute" Before="QtExecDeferredExampleWithProperty" />\n    <CustomAction Id="QtExecDeferredExampleWithProperty" BinaryKey="WixCA" DllEntry="WixQuietExec"\n                Execute="deferred" Return="check" Impersonate="no"/>\n    .\n    .\n    .\n    <InstallExecuteSequence>\n      <Custom Action="QtExecDeferredExampleWithProperty" After="TheActionYouWantItAfter"/>\n    </InstallExecuteSequence>\n')),(0,i.kt)("h2",{id:"running-64-bit-executables"},"Running 64-bit executables"),(0,i.kt)("p",null,"If you need to run a 64-bit executable, use the 64-bit aware QtExec. To use the 64-bit QtExec (or WixSilentExec) change the CustomAction element","'",'s DllEntry attribute to "WixQuietExec64" (or "WixSilentExec64") and for immediate execution use the "WixQuietExec64CmdLine" (or "WixSilentExec64CmdLine") property. The following example combines the examples above the 64-bit aware QtExec for both. Notice that the CustomAction element',"'","s Id attributes do not need to change:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'    <Property Id="WixQuietExec64CmdLine" Value="64-bit command line to run"/>\n    <CustomAction Id="QtExecExample" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="immediate" Return="check"/>\n    .\n    .\n    .\n    <SetProperty Id="QtExecDeferredExampleWithProperty" Value=""[#MyExecutable.exe]"" \n                Before="QtExecDeferredExampleWithProperty" Sequence="execute" />\n    <CustomAction Id="QtExecDeferredExampleWithProperty" BinaryKey="WixCA" DllEntry="WixQuietExec64"\n                Execute="deferred" Return="check" Impersonate="no"/>\n    .\n    .\n    .\n    <InstallExecuteSequence>\n      <Custom Action="QtExecExample" After="TheImmediateActionYouWantItAfter"/>\n      <Custom Action="QtExecDeferredExampleWithProperty" After="TheDeferredActionYouWantItAfter"/>\n    </InstallExecuteSequence>\n')),(0,i.kt)("h2",{id:"building-an-msi-that-uses-qtexec"},"Building an MSI that uses QtExec"),(0,i.kt)("p",null,"In order to use QtExec, you must include a reference to the WixUtilExtension when building your MSI. To do this, add the command line argument ",(0,i.kt)("inlineCode",{parentName:"p"},"-ext WixUtilExtension.dll")," when calling Light.exe."))}x.isMDXComponent=!0}}]);