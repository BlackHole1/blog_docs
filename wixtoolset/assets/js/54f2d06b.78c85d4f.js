"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[41214],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>b});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),u=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=u(e.components);return o.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),p=u(n),m=r,b=p["".concat(s,".").concat(m)]||p[m]||d[m]||i;return n?o.createElement(b,l(l({ref:t},c),{},{components:n})):o.createElement(b,l({ref:t},c))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=m;var a={};for(var s in t)hasOwnProperty.call(t,s)&&(a[s]=t[s]);a.originalType=e,a[p]="string"==typeof e?e:r,l[1]=a;for(var u=2;u<i;u++)l[u]=n[u];return o.createElement.apply(null,l)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},7051:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>b,frontMatter:()=>a,metadata:()=>u,toc:()=>p});n(67294);var o=n(3905);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const a={title:"MSI Tables to WiX Schema",layout:"documentation",after:"lux"},s="MSI Tables to WiX Schema",u={unversionedId:"overview/msitowix",id:"version-v3/overview/msitowix",title:"MSI Tables to WiX Schema",description:"In the WiX schema, its not always entirely obvious how the tables from the Windows Installer schema map to the WiX schema. Below are some helpful hints on how to figure out the relationships between the two schemas.",source:"@site/versioned_docs/version-v3/overview/msitowix.md",sourceDirName:"overview",slug:"/overview/msitowix",permalink:"/wixtoolset/docs/v3/overview/msitowix",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/versioned_docs/version-v3/overview/msitowix.md",tags:[],version:"v3",frontMatter:{title:"MSI Tables to WiX Schema",layout:"documentation",after:"lux"}},c={},p=[{value:"DuplicateFile Table",id:"duplicatefile-table",level:2},{value:"LaunchCondition Table",id:"launchcondition-table",level:2},{value:"MoveFile Table",id:"movefile-table",level:2},{value:"PublishComponent Table",id:"publishcomponent-table",level:2},{value:"RemoveIniFile",id:"removeinifile",level:2},{value:"RemoveRegistry Table",id:"removeregistry-table",level:2}],d={toc:p},m="wrapper";function b(e){var{components:t}=e,n=l(e,["components"]);return(0,o.kt)(m,i(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){r(e,t,n[t])}))}return e}({},d,n),{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"msi-tables-to-wix-schema"},"MSI Tables to WiX Schema"),(0,o.kt)("p",null,"In the WiX schema, its not always entirely obvious how the tables from the Windows Installer schema map to the WiX schema. Below are some helpful hints on how to figure out the relationships between the two schemas."),(0,o.kt)("h2",{id:"duplicatefile-table"},"DuplicateFile Table"),(0,o.kt)("p",null,"This is authored using a ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/copyfile"},"CopyFile")," node nested under a File node. You only need to set the Id, DestinationFolder, and DestinationName attributes."),(0,o.kt)("h2",{id:"launchcondition-table"},"LaunchCondition Table"),(0,o.kt)("p",null,"This is authored using a ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/condition"},"Condition")," node authored under Fragment or Product. You only need to set the Message attribute."),(0,o.kt)("p",null,"##LockPermissions Table"),(0,o.kt)("p",null,"This is authored using ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/permission"},"Permission"),"."),(0,o.kt)("h2",{id:"movefile-table"},"MoveFile Table"),(0,o.kt)("p",null,"This is authored using a ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/copyfile"},"CopyFile")," node nested under a Component node. You will need to set all attributes except Delete. Set Delete to ","'","yes","'"," in order to use the msidbMoveFileOptionsMove option."),(0,o.kt)("h2",{id:"publishcomponent-table"},"PublishComponent Table"),(0,o.kt)("p",null,"The PublishComponent functionality is available in WiX by using a ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/category"},"Category"),". Here is a small sample of what a PublishComponent record would look like in MSI, then in WiX notation."),(0,o.kt)("dl",null,(0,o.kt)("dt",null,"MSI"),(0,o.kt)("dd",null,(0,o.kt)("table",null,(0,o.kt)("tr",null,(0,o.kt)("th",null,"ComponentId"),(0,o.kt)("th",null,"Qualifier"),(0,o.kt)("th",null,"Component_"),(0,o.kt)("th",null,"AppData"),(0,o.kt)("th",null,"Feature_")),(0,o.kt)("tr",null,(0,o.kt)("td",null,-5555544454443),(0,o.kt)("td",null,"1033"),(0,o.kt)("td",null,"MyComponent"),(0,o.kt)("td",null,"Random Data"),(0,o.kt)("td",null,"MyFeature"))))),(0,o.kt)("dl",null,(0,o.kt)("dt",null,"WiX"),(0,o.kt)("dd",null,(0,o.kt)("table",{class:"command"},(0,o.kt)("tr",null,(0,o.kt)("td",null,"``` <Component Id='MyComponent' Guid='87654321-4321-4321-4321-110987654321'>",(0,o.kt)("b",null,"<Category Id='11111111-2222-3333-4444-5555555555555' AppData='Random Data' Qualifier='1033'/>"),"</Component> . . . <Feature Id='MyFeature' Level='1'> <ComponentRef Id='MyComponent'/> </Feature> ```"))))),(0,o.kt)("h2",{id:"removeinifile"},"RemoveIniFile"),(0,o.kt)("p",null,"This is authored using ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/inifile"},"IniFile"),". Just set the Action attribute to ","'","removeLine","'"," or ","'","removeTag","'"," as appropriate."),(0,o.kt)("h2",{id:"removeregistry-table"},"RemoveRegistry Table"),(0,o.kt)("p",null,"This is authored using ",(0,o.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/registry"},"Registry"),". Simply set the Action attribute to ","'","remove","'"," or ","'","removeKey","'"," (as appropriate) in order to get an entry in the RemoveRegistry table."))}b.isMDXComponent=!0}}]);