"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[39200],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>d});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},s=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",f={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},b=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),u=c(n),b=o,d=u["".concat(l,".").concat(b)]||u[b]||f[b]||a;return n?r.createElement(d,i(i({ref:t},s),{},{components:n})):r.createElement(d,i({ref:t},s))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=b;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p[u]="string"==typeof e?e:o,i[1]=p;for(var c=2;c<a;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}b.displayName="MDXCreateElement"},93430:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>p,metadata:()=>c,toc:()=>u});n(67294);var r=n(3905);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const p={title:"Bootstrapper Application Interface",layout:"documentation"},l="Bootstrapper Application Interface",c={unversionedId:"bundle/ba/bootstrapper_application_interface",id:"version-v3/bundle/ba/bootstrapper_application_interface",title:"Bootstrapper Application Interface",description:"The engine communicates with the bootstrapper application through callbacks to the IBootstrapperApplication interface. The first call from the engine is IBootstrapperApplication:",source:"@site/versioned_docs/version-v3/bundle/ba/bootstrapper_application_interface.md",sourceDirName:"bundle/ba",slug:"/bundle/ba/bootstrapper_application_interface",permalink:"/wixtoolset/docs/v3/bundle/ba/bootstrapper_application_interface",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/versioned_docs/version-v3/bundle/ba/bootstrapper_application_interface.md",tags:[],version:"v3",frontMatter:{title:"Bootstrapper Application Interface",layout:"documentation"}},s={},u=[],f={toc:u},b="wrapper";function d(e){var{components:t}=e,n=i(e,["components"]);return(0,r.kt)(b,a(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){o(e,t,n[t])}))}return e}({},f,n),{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"bootstrapper-application-interface"},"Bootstrapper Application Interface"),(0,r.kt)("p",null,"The engine communicates with the bootstrapper application through callbacks to the IBootstrapperApplication interface. The first call from the engine is IBootstrapperApplication::OnStartup():"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"// IBootstrapperApplication::OnStartup\nSTDMETHOD(OnStartup)() = 0;\n")),(0,r.kt)("p",null,"Typically, the BA uses this callback to start a new thread and display a user interface. After the BA returns from OnStartup, the engine enters its idle loop and waits for commands from the BA via IBootstrapperEngine."),(0,r.kt)("p",null,"The first action the BA should take is detection. The BA does this by a call to IBootstrapperEngine::Detect:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"// IBootstrapperEngine::Detect\nSTDMETHOD(Detect)() = 0;\n")),(0,r.kt)("p",null,"After detection, the BA should determine what operation the user wants to take. Historically this happens as a wizard sequence, prompting the user for installation location, feature selection, etc. When the decisions are made, the BA plans the operation by calling IBootstrapperEngine::Plan:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"// IBootstrapperEngine::Plan\nSTDMETHOD(Plan)(\n     __in BOOTSTRAPPER_ACTION action\n     ) = 0;\n")),(0,r.kt)("p",null,"The BOOTSTRAPPER_ACTION is an enumeration that specifies the overall action.  The most common actions are install, uninstall, and repair. After the plan is complete, the BA can apply the changes by calling IBootstrapperEngine::Apply:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"// IBootstrapperEngine::Apply\nSTDMETHOD(Apply)(\n     __in_opt HWND hwndParent\n     ) = 0;\n")),(0,r.kt)("p",null,"The BA should provide a window handle to ensure that the elevation prompt, if one is required, is active and displayed above other windows. The bulk of the BA time will be spent handling callbacks from the Apply action."),(0,r.kt)("p",null,"When the BA is done, it should notify the engine by calling IBootstrapperEngine::Shutdown:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"// IBootstrapperEngine::Shutdown\nSTDMETHOD(Shutdown)(\n     __in DWORD dwExitCode,\n     __in BOOL fRestart\n     ) = 0;\n")),(0,r.kt)("p",null,"The engine will then call the BA one last time via IBootstrapperApplication::OnShutdown:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"// IBootstrapperApplication::OnShutdown\nSTDMETHOD_(void, OnShutdown)() = 0;\n")))}d.isMDXComponent=!0}}]);