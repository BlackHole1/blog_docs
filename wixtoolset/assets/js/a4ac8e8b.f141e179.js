"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[42842],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>m});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(r),h=o,m=u["".concat(l,".").concat(h)]||u[h]||d[h]||a;return r?n.createElement(m,i(i({ref:t},p),{},{components:r})):n.createElement(m,i({ref:t},p))}));function m(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:o,i[1]=s;for(var c=2;c<a;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},81095:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>c,toc:()=>u});r(67294);var n=r(3905);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function i(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}const s={},l="How To: Create a Shortcut on the Start Menu",c={unversionedId:"howtos/files_and_registry/create_start_menu_shortcut",id:"version-v3/howtos/files_and_registry/create_start_menu_shortcut",title:"How To: Create a Shortcut on the Start Menu",description:"When installing applications it is a common requirement to place a shortcut on the user&apos;s Start Menu to provide a launching point for the program. This how to walks through how to create a shortcut on the start menu. It assumes you have a WiX source file based on the concepts described in How To: Add a file to your installer.",source:"@site/versioned_docs/version-v3/howtos/files_and_registry/create_start_menu_shortcut.md",sourceDirName:"howtos/files_and_registry",slug:"/howtos/files_and_registry/create_start_menu_shortcut",permalink:"/wixtoolset/docs/v3/howtos/files_and_registry/create_start_menu_shortcut",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/versioned_docs/version-v3/howtos/files_and_registry/create_start_menu_shortcut.md",tags:[],version:"v3",frontMatter:{}},p={},u=[{value:"Step 1: Define the directory structure",id:"step-1-define-the-directory-structure",level:2},{value:"Step 2: Add the shortcut to your installer package",id:"step-2-add-the-shortcut-to-your-installer-package",level:2},{value:"Step 3: Tell Windows Installer to install the shortcut",id:"step-3-tell-windows-installer-to-install-the-shortcut",level:2},{value:"The Complete Sample",id:"the-complete-sample",level:2}],d={toc:u},h="wrapper";function m(e){var{components:t}=e,r=i(e,["components"]);return(0,n.kt)(h,a(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){o(e,t,r[t])}))}return e}({},d,r),{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"how-to-create-a-shortcut-on-the-start-menu"},"How To: Create a Shortcut on the Start Menu"),(0,n.kt)("p",null,"When installing applications it is a common requirement to place a shortcut on the user","'","s Start Menu to provide a launching point for the program. This how to walks through how to create a shortcut on the start menu. It assumes you have a WiX source file based on the concepts described in ",(0,n.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/howtos/files_and_registry/add_a_file"},"How To: Add a file to your installer"),"."),(0,n.kt)("h2",{id:"step-1-define-the-directory-structure"},"Step 1: Define the directory structure"),(0,n.kt)("p",null,"Start Menu shortcuts are installed in a different directory than regular application files, so modifications to the installer","'","s directory structure are required. The following WiX fragment should be placed inside a ",(0,n.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/directory"},"Directory")," element with the TARGETDIR ID and adds directory structure information for the Start Menu:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-xml"},'<Directory Id="ProgramMenuFolder">\n    <Directory Id="ApplicationProgramsFolder" Name="My Application Name"/>\n</Directory>\n')),(0,n.kt)("p",null,"The ",(0,n.kt)("a",{href:"http://msdn.microsoft.com/library/aa370882.aspx",target:"_blank"},"ProgramMenuFolder")," Id is a standard Windows Installer property that points to the Start Menu folder on the target machine. The second Directory element creates a subfolder on the Start Menu called My Application Name, and gives it an id for use later in the WiX project."),(0,n.kt)("h2",{id:"step-2-add-the-shortcut-to-your-installer-package"},"Step 2: Add the shortcut to your installer package"),(0,n.kt)("p",null,"A shortcut is added to the installer using three elements: a ",(0,n.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/component"},"Component")," element to specify an atomic unit of installation, a ",(0,n.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/shortcut"},"Shortcut")," element to specify the shortcut that should be installed, and a ",(0,n.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/removefolder"},"RemoveFolder")," element to ensure proper cleanup when your application is uninstalled."),(0,n.kt)("p",null,"The following sample uses the directory structure defined in Step 1 to create the Start Menu shortcut."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-xml"},'<DirectoryRef Id="ApplicationProgramsFolder">\n    <Component Id="ApplicationShortcut" Guid="PUT-GUID-HERE">\n        <Shortcut Id="ApplicationStartMenuShortcut" \n                  Name="My Application Name"\n                  Description="My Application Description"\n                  Target="[#myapplication.exe]"\n                  WorkingDirectory="APPLICATIONROOTDIRECTORY"/>\n        <RemoveFolder Id="CleanUpShortCut" Directory="ApplicationProgramsFolder" On="uninstall"/>\n        <RegistryValue Root="HKCU" Key="Software\\MyCompany\\MyApplicationName" Name="installed" Type="integer" Value="1" KeyPath="yes"/>\n    </Component>\n</DirectoryRef>\n')),(0,n.kt)("p",null,"The ",(0,n.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/directoryref"},"DirectoryRef")," element is used to refer to the directory structure created in step 1. By referencing the ApplicationProgramsFolder directory the shortcut will be installed into the user","'","s Start Menu inside the My Application Name folder."),(0,n.kt)("p",null,"Underneath the DirectoryRef is a single Component to group the elements used to install the Shortcut. The first element is Shortcut and it creates the actual shortcut in the Start Menu. The Id attribute is a unique id for the shortcut. The Name attribute is the text that will be displayed in the Start Menu. The description is an optional attribute for an additional application description. The Target attribute points to the executable to launch on disk. Notice how it references the full path using the ",(0,n.kt)("inlineCode",{parentName:"p"},"[#FileId]")," syntax where ",(0,n.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/howtos/files_and_registry/add_a_file"},(0,n.kt)("inlineCode",{parentName:"a"},"myapplication.exe")," was previously defined"),". The WorkingDirectory attribute sets the working directory for the shortcut."),(0,n.kt)("p",null,"To set an optional icon for the shortcut you need to first include the icon in your installer using the ",(0,n.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/icon"},"Icon")," element, then reference it using the Icon attribute on the Shortcut element."),(0,n.kt)("p",null,"In addition to creating the shortcut the component contains two other important pieces. The first is a RemoveFolder element, which ensures the ApplicationProgramsFolder is correctly removed from the Start Menu when the user uninstalls the application. The second creates a registry entry on install that indicates the application is installed. This is required as a Shortcut cannot serve as the KeyPath for a component when installing non-advertised shortcuts for the current users. For more information on creating registry entries see ",(0,n.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/howtos/files_and_registry/write_a_registry_entry"},"How To: Write a registry entry during installation"),"."),(0,n.kt)("h2",{id:"step-3-tell-windows-installer-to-install-the-shortcut"},"Step 3: Tell Windows Installer to install the shortcut"),(0,n.kt)("p",null,"After defining the directory structure and listing the shortcuts to package into the installer, the last step is to tell Windows Installer to actually install the shortcut. The ",(0,n.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/feature"},"Feature")," element is used to do this. The following snippet adds a reference to the shortcut component, and should be inserted inside a parent Feature element."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-xml"},'<ComponentRef Id="ApplicationShortcut" />\n')),(0,n.kt)("p",null,"The ",(0,n.kt)("a",{parentName:"p",href:"/wixtoolset/docs/v3/xsd/wix/componentref"},"ComponentRef")," element is used to reference the component created in Step 2 via the Id attribute."),(0,n.kt)("h2",{id:"the-complete-sample"},"The Complete Sample"),(0,n.kt)("p",null,"The following is a complete sample that uses the above concepts. This example can be inserted into a WiX project and compiled, or compiled and linked from the command line, to generate an installer."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">\n    <Product Id="*" UpgradeCode="PUT-GUID-HERE" Version="1.0.0.0" Language="1033" Name="My Application Name" Manufacturer="My Manufacturer Name">\n        <Package InstallerVersion="300" Compressed="yes"/>\n        <Media Id="1" Cabinet="myapplication.cab" EmbedCab="yes" />\n\n        <Directory Id="TARGETDIR" Name="SourceDir">\n            <Directory Id="ProgramFilesFolder">\n                <Directory Id="APPLICATIONROOTDIRECTORY" Name="My Application Name"/>\n            </Directory>\n            \x3c!-- Step 1: Define the directory structure --\x3e\n            <Directory Id="ProgramMenuFolder">\n                <Directory Id="ApplicationProgramsFolder" Name="My Application Name"/>\n            </Directory>\n        </Directory>\n\n        <DirectoryRef Id="APPLICATIONROOTDIRECTORY">\n            <Component Id="myapplication.exe" Guid="PUT-GUID-HERE">\n                <File Id="myapplication.exe" Source="MySourceFiles\\MyApplication.exe" KeyPath="yes" Checksum="yes"/>\n            </Component>\n            <Component Id="documentation.html" Guid="PUT-GUID-HERE">\n                <File Id="documentation.html" Source="MySourceFiles\\documentation.html" KeyPath="yes"/>\n            </Component>\n        </DirectoryRef>\n\n        \x3c!-- Step 2: Add the shortcut to your installer package --\x3e\n        <DirectoryRef Id="ApplicationProgramsFolder">\n            <Component Id="ApplicationShortcut" Guid="PUT-GUID-HERE">\n                <Shortcut Id="ApplicationStartMenuShortcut"\n                          Name="My Application Name"\n                          Description="My Application Description"\n                          Target="[#myapplication.exe]"\n                          WorkingDirectory="APPLICATIONROOTDIRECTORY"/>\n                <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>\n                <RegistryValue Root="HKCU" Key="Software\\MyCompany\\MyApplicationName" Name="installed" Type="integer" Value="1" KeyPath="yes"/>\n            </Component>\n        </DirectoryRef>\n\n        <Feature Id="MainApplication" Title="Main Application" Level="1">\n            <ComponentRef Id="myapplication.exe" />\n            <ComponentRef Id="documentation.html" />\n            \x3c!-- Step 3: Tell WiX to install the shortcut --\x3e\n            <ComponentRef Id="ApplicationShortcut" />   \n        </Feature>\n    </Product>\n</Wix>\n')))}m.isMDXComponent=!0}}]);