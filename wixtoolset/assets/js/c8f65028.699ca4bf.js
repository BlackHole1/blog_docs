"use strict";(self.webpackChunkwixweb=self.webpackChunkwixweb||[]).push([[18735],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>h});var i=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var c=i.createContext({}),l=function(e){var t=i.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},u=function(e){var t=l(e.components);return i.createElement(c.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=l(r),m=n,h=p["".concat(c,".").concat(m)]||p[m]||d[m]||o;return r?i.createElement(h,a(a({ref:t},u),{},{components:r})):i.createElement(h,a({ref:t},u))}));function h(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,a=new Array(o);a[0]=m;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[p]="string"==typeof e?e:n,a[1]=s;for(var l=2;l<o;l++)a[l]=r[l];return i.createElement.apply(null,a)}return i.createElement.apply(null,r)}m.displayName="MDXCreateElement"},96147:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>l,toc:()=>p});r(67294);var i=r(3905);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function a(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}const s={title:"WixExitEarlyWithSuccess Custom Action",layout:"documentation",after:"using_standard_customactions"},c="WixExitEarlyWithSuccess Custom Action",l={unversionedId:"customactions/wixexitearlywithsuccess",id:"version-v3/customactions/wixexitearlywithsuccess",title:"WixExitEarlyWithSuccess Custom Action",description:"The WixExitEarlyWithSuccess custom action is an immediate custom action that does nothing except return the value ERROR\\NO\\MORE\\_ITEMS. This return value causes Windows Installer to skip all remaining actions in the .msi and return a process exit code that indicates a successful installation.",source:"@site/versioned_docs/version-v3/customactions/wixexitearlywithsuccess.md",sourceDirName:"customactions",slug:"/customactions/wixexitearlywithsuccess",permalink:"/wixtoolset/docs/v3/customactions/wixexitearlywithsuccess",draft:!1,editUrl:"https://github.com/wixtoolset/web/tree/master/src/Docusaurus/versioned_docs/version-v3/customactions/wixexitearlywithsuccess.md",tags:[],version:"v3",frontMatter:{title:"WixExitEarlyWithSuccess Custom Action",layout:"documentation",after:"using_standard_customactions"}},u={},p=[{value:"Step 1: Add the WiX utilities extensions library to your project",id:"step-1-add-the-wix-utilities-extensions-library-to-your-project",level:2},{value:"Step 2: Add a reference to the WixExitEarlyWithSuccess custom action",id:"step-2-add-a-reference-to-the-wixexitearlywithsuccess-custom-action",level:2},{value:"Step 3: Add logic to define the NEWERVERSIONDETECTED property at the appropriate times",id:"step-3-add-logic-to-define-the-newerversiondetected-property-at-the-appropriate-times",level:2}],d={toc:p},m="wrapper";function h(e){var{components:t}=e,r=a(e,["components"]);return(0,i.kt)(m,o(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),i.forEach((function(t){n(e,t,r[t])}))}return e}({},d,r),{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"wixexitearlywithsuccess-custom-action"},"WixExitEarlyWithSuccess Custom Action"),(0,i.kt)("p",null,"The WixExitEarlyWithSuccess custom action is an immediate custom action that does nothing except return the value ",(0,i.kt)("a",{href:"http://msdn.microsoft.com/library/aa368072.aspx",target:"_blank"},"ERROR","_","NO","_","MORE","_","ITEMS"),". This return value causes Windows Installer to skip all remaining actions in the .msi and return a process exit code that indicates a successful installation."),(0,i.kt)("p",null,"This custom action is useful in cases where you want setup to exit without actually installing anything, but want it to return success to the calling process. A common scenario where this type of behavior is useful is in an out-of-order installation scenario for an .msi that implements ",(0,i.kt)("a",{href:"http://msdn.microsoft.com/library/aa369786.aspx",target:"_blank"},"major upgrades"),". When a user has version 2 of an .msi installed and then attempts to install version 1, this custom action can be used in conjunction with the ",(0,i.kt)("a",{href:"http://msdn.microsoft.com/library/aa372379.aspx",target:"_blank"},"Upgrade table")," to detect that version 2 is already installed to cause setup to exit without installing anything and return success. If any applications redistribute version 1 of the .msi, their installation processes will continue to work even if the user has version 2 of the .msi installed on their system."),(0,i.kt)("p",null,"There are 3 steps you need to take to use the WixExitEarlyWithSuccess custom action in your MSI:"),(0,i.kt)("h2",{id:"step-1-add-the-wix-utilities-extensions-library-to-your-project"},"Step 1: Add the WiX utilities extensions library to your project"),(0,i.kt)("p",null,"The WiX support for WixExitEarlyWithSuccess is included in a WiX extension library that must be added to your project prior to use. If you are using WiX on the command line you need to add the following to your light command line:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"light.exe myproject.wixobj -ext WixUtilExtension\n")),(0,i.kt)("p",null,"If you are using Votive you can add the extension using the Add Reference dialog:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Open your Votive project in Visual Studio"),(0,i.kt)("li",{parentName:"ol"},"Right click on your project in Solution Explorer and select Add Reference..."),(0,i.kt)("li",{parentName:"ol"},"Select the ",(0,i.kt)("strong",{parentName:"li"},"WixUtilExtension.dll")," assembly from the list and click Add"),(0,i.kt)("li",{parentName:"ol"},"Close the Add Reference dialog")),(0,i.kt)("h2",{id:"step-2-add-a-reference-to-the-wixexitearlywithsuccess-custom-action"},"Step 2: Add a reference to the WixExitEarlyWithSuccess custom action"),(0,i.kt)("p",null,"To add a reference to the WixExitEarlyWithSuccess custom action, include the following in your WiX setup authoring:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'    <CustomActionRef Id="WixExitEarlyWithSuccess" />\n')),(0,i.kt)("p",null,"This will cause WiX to add the WixExitEarlyWithSuccess custom action to your MSI, schedule it immediately after the ",(0,i.kt)("a",{href:"http://msdn.microsoft.com/library/aa368600.aspx",target:"_blank"},"FindRelatedProducts")," action and condition it to only run if the property named NEWERVERSIONDETECTED is set."),(0,i.kt)("h2",{id:"step-3-add-logic-to-define-the-newerversiondetected-property-at-the-appropriate-times"},"Step 3: Add logic to define the NEWERVERSIONDETECTED property at the appropriate times"),(0,i.kt)("p",null,"In order to cause the WixExitEarlyWithSuccess to run at the desired times, you must add logic to your installer to create the NEWERVERSIONDETECTED property. To implement the major upgrade example described above, you can add an Upgrade element like the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'    <Upgrade Id="!(loc.Property_UpgradeCode)">\n      <UpgradeVersion Minimum="$(var.ProductVersion)" OnlyDetect="yes" Property="NEWERVERSIONDETECTED" />\n    </Upgrade>\n')))}h.isMDXComponent=!0}}]);