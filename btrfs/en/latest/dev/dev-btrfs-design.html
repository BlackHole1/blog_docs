<html><head><style data-id="immersive-translate-default-injected-css">:root {
  --immersive-translate-theme-underline-borderColor: #72ece9;
  --immersive-translate-theme-nativeUnderline-borderColor: #72ece9;
  --immersive-translate-theme-nativeDashed-borderColor: #72ece9;
  --immersive-translate-theme-nativeDotted-borderColor: #72ece9;
  --immersive-translate-theme-highlight-backgroundColor: #ffff00;
  --immersive-translate-theme-dashed-borderColor: #59c1bd;
  --immersive-translate-theme-blockquote-borderColor: #cc3355;
  --immersive-translate-theme-thinDashed-borderColor: #ff374f;
  --immersive-translate-theme-dashedBorder-borderColor: #94a3b8;
  --immersive-translate-theme-dashedBorder-borderRadius: 0;
  --immersive-translate-theme-solidBorder-borderColor: #94a3b8;
  --immersive-translate-theme-solidBorder-borderRadius: 0;
  --immersive-translate-theme-dotted-borderColor: #94a3b8;
  --immersive-translate-theme-wavy-borderColor: #72ece9;
  --immersive-translate-theme-dividingLine-borderColor: #94a3b8;
  --immersive-translate-theme-grey-textColor: #2f4f4f;
  --immersive-translate-theme-marker-backgroundColor: #fbda41;
  --immersive-translate-theme-marker-backgroundColor-rgb: 251, 218, 65;
  --immersive-translate-theme-marker2-backgroundColor: #ffff00;
  --immersive-translate-theme-opacity-opacity: 10;
}

.immersive-translate-target-translation-pre-whitespace {
  white-space: pre-wrap !important;
}

.immersive-translate-pdf-target-container {
  position: absolute;
  background-color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
    sans-serif;
  top: 0;
  width: 600px;
  height: 100%;
  z-index: 2;
  line-height: 1.3;
  font-size: 16px;
}
.immersive-translate-target-wrapper[dir='rtl'] {
  text-align: right;
}

.immersive-translate-pdf-target-container .immersive-translate-target-wrapper {
  color: rgb(0, 0, 0);
  white-space: normal;
  position: absolute;
}

.immersive-translate-pdf-target-container .immersive-translate-target-wrapper font {
  color: inherit;
  white-space: inherit;
  position: unset;
}

.immersive-translate-state-dual>br {
  display: none;
}

.immersive-translate-target-translation-block-wrapper {
  margin: 8px 0 !important;
  display: inline-block;
}

.immersive-translate-target-translation-pdf-block-wrapper {
  margin: 0 !important;
  display: block;
}

.immersive-translate-target-translation-theme-grey-inner {
  color: var(--immersive-translate-theme-grey-textColor);
}


.immersive-translate-target-translation-theme-underline-inner {
  border-bottom: 1px solid var(--immersive-translate-theme-underline-borderColor) !important;
}

.immersive-translate-target-translation-theme-nativeUnderline-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeUnderline-borderColor) !important;
}

.immersive-translate-target-translation-block-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

.immersive-translate-target-translation-inline-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
  padding: 2px;
}

.immersive-translate-target-translation-block-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

.immersive-translate-target-translation-inline-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
  padding: 2px;
}

.immersive-translate-target-translation-theme-nativeDashed-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeDashed-borderColor) !important;
  text-decoration-style: dashed !important;
}

.immersive-translate-target-translation-theme-thinDashed-inner {
  border-bottom: 1px dashed var(--immersive-translate-theme-thinDashed-borderColor) !important;
}

.immersive-translate-target-translation-theme-dotted-inner {
  background-image: linear-gradient(to right,
      var(--immersive-translate-theme-dotted-borderColor) 30%,
      rgba(255, 255, 255, 0) 0%);
  background-position: bottom;
  background-size: 5px 1px;
  background-repeat: repeat-x;
  padding-bottom: 3px;
}

.immersive-translate-target-translation-theme-nativeDotted-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeDotted-borderColor) !important;
  text-decoration-style: dotted !important;
}

.immersive-translate-target-translation-theme-wavy-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-wavy-borderColor) !important;
  text-decoration-style: wavy !important;
}

.immersive-translate-target-translation-theme-dashed-inner {
  background: linear-gradient(to right,
      var(--immersive-translate-theme-dashed-borderColor) 0%,
      var(--immersive-translate-theme-dashed-borderColor) 50%,
      transparent 50%,
      transparent 100%) repeat-x left bottom;
  background-size: 8px 2px;
  padding-bottom: 2px;
}

.immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
  content: "";
  display: block;
  max-width: 80px;
  width: 10%;
  border-top: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
  padding-top: 8px;
}

.immersive-translate-target-translation-inline-wrapper-theme-dividingLine::before {
  content: "";
  border-left: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
  max-height: 16px;
  height: 16px;
  padding-left: 8px;
}

.immersive-translate-target-translation-theme-highlight-inner {
  background: var(--immersive-translate-theme-highlight-backgroundColor);
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

.immersive-translate-target-translation-block-wrapper-theme-marker {
  line-height: 1.5em;
}

.immersive-translate-target-translation-theme-marker2-inner {
  font-weight: bold;
  text-shadow: 10px 0px 3px var(--immersive-translate-theme-marker2-backgroundColor),
    16px 3px 9px var(--immersive-translate-theme-marker2-backgroundColor),
    2px 0px 6px var(--immersive-translate-theme-marker2-backgroundColor),
    -12px 0px 12px var(--immersive-translate-theme-marker2-backgroundColor) !important;
}

.immersive-translate-target-translation-theme-marker-inner {
  /* TODO: add more texture */
  background: linear-gradient(to right,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.1),
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 3%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 35%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 70%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.8) 95%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.3));
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

.immersive-translate-target-translation-theme-weakening {
  opacity: 0.618 !important;
}

.immersive-translate-target-translation-theme-italic {
  font-style: italic !important;
}

.immersive-translate-target-translation-theme-bold {
  font-weight: bold !important;
}

.immersive-translate-target-translation-block-wrapper-theme-paper {
  margin: 8px 0;
  box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
  padding: 16px 32px;
  display: block;
}

.immersive-translate-target-translation-block-wrapper-theme-blockquote {
  border-left: 4px solid var(--immersive-translate-theme-blockquote-borderColor) !important;
  padding-left: 12px !important;
  margin-top: 4px;
  margin-bottom: 4px;
  padding-top: 4px;
  padding-bottom: 4px;
  display: block;
}

.immersive-translate-target-translation-theme-mask-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-mask-inner {
  filter: none !important;
}

[data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}


/* opacity theme start */

.immersive-translate-target-translation-theme-opacity-inner {
  filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-opacity-inner {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner,.immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

.immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: none !important;
}


.immersive-translate-target-translation-theme-mask-inner:hover {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner:hover {
  filter: none !important;
}


[data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner:hover {
  filter: none !important;
}

/* opacity theme end */

/* vertical css , please remain it in the last one. */
.immersive-translate-target-translation-vertical-block-wrapper {
  margin: 0px 8px !important;
}

.immersive-translate-text {
  font-size: 15px !important;
}

.immersive-translate-error-toast {
  position: fixed;
  top: 5%;
  z-index: 99999999;
  left: 0;
  right: 0;
  margin: auto;
  max-width: 300px;
  padding: 16px;
  border-radius: 12px;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  flex-direction: row;
  justify-content: space-between;
}

@media all and (min-width: 750px) {
  .immersive-translate-error-toast {
    max-width: 400px;
  }
}


.immersive-translate-clickable-button {
  cursor: pointer;
}

.immersive-translate-help-button {
  cursor: pointer;
}

.immersive-translate-loading-text:before {
  content: "...";
}


/* dark mode for loading */

@media only screen and (prefers-color-scheme: dark) {
  .immersive-translate-loading {
    border: 2px rgba(255, 255, 255, 0.25) solid !important;
    border-top: 2px rgba(255, 255, 255, 1) solid !important;
  }
}

.immersive-translate-error-wrapper {
  position: relative;
  display: inline-flex;
  padding: 6px;
  margin: 0 12px;
  white-space: nowrap;
  font-size: 0.9em;
}
[lang="zh-CN"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}
[lang="zh-TW"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}


.immersive-translate-tooltip {
  position: relative;
  display: inline-flex;
  /* little indicater to indicate it's hoverable */
}

.immersive-translate-tooltip-content {
  /* here's the magic */
  position: absolute;
  z-index: 100000000000;

  left: 50%;
  bottom: 0;
  transform: translate(-50%, 110%);
  line-height: 1;
  /* and add a small left margin */

  /* basic styles */
  width: max-content;
  max-width: 250px;
  word-wrap: break-word;
  white-space: pre-line;
  padding: 10px;
  border-radius: 10px;
  background: #000C;
  color: #fff;
  text-align: center;
  font-size: 14px;
  display: none;
  /* hide by default */
}

.immersive-translate-tooltip:hover .immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip:hover+.immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip-content-table {
  left: unset !important;
  bottom: unset !important;
  transform: translate(-10%, 50%) !important;
}


.immersive-translate-tooltip:hover:before {
  display: block;
}



.immersive-translate-loading-spinner {
  vertical-align: middle !important;
  width: 10px !important;
  height: 10px !important;
  display: inline-block !important;
  margin: 0 4px !important;
  border: 2px rgba(221, 244, 255, 0.6) solid !important;
  border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-radius: 50% !important;
  padding: 0 !important;
  -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
  animation: immersive-translate-loading-animation 0.6s infinite linear !important;
}

@-webkit-keyframes immersive-translate-loading-animation {
  from {
    -webkit-transform: rotate(0deg);
  }

  to {
    -webkit-transform: rotate(359deg);
  }
}

@keyframes immersive-translate-loading-animation {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(359deg);
  }
}
</style><style data-id="immersive-translate-user-custom-style">:root {

.immersive-translate-target-inner { font-family: inherit; }
}
</style><style data-id="immersive-translate-dynamic-injected-css">.immersive-translate-target-wrapper[dir='rtl'] {text-align: right;}
.immersive-translate-target-wrapper[dir='rtl'] [data-immersive-translate-class-bak*='block-wrapper'] {display:block;}
</style></head><body data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">


  <meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Btrfs design — BTRFS  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css">
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css">

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script async="async" src="../../../_/static/javascript/readthedocs-doc-embed.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html">
    <link rel="search" title="Search" href="../search.html">
    <link rel="next" title="Btrees" href="dev-btrees.html">
    <link rel="prev" title="Experimental features" href="Experimental.html">
    <link href="../_static/style.css" rel="stylesheet" type="text/css">


<!-- RTD Extra Head -->

<link rel="stylesheet" href="../../../_/static/css/readthedocs-doc-embed.css" type="text/css">

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": false, "api_host": "https://readthedocs.org", "builder": "sphinx", "canonical_url": null, "docroot": "/Documentation/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "dev/dev-btrfs-design", "programming_language": "words", "project": "btrfs", "proxied_api_host": "/_", "source_suffix": ".rst", "subprojects": {}, "theme": "sphinx_rtd_theme", "user_analytics_code": "", "version": "latest"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="../../../_/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->


 
  <div class="wy-grid-for-nav" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
      <div class="wy-side-scroll" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
        <div class="wy-side-nav-search" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">

          
          
          <a href="../index.html" class="icon icon-home" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">
            BTRFS
          </a>
              <div class="version" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">
                latest
              <font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">最新</font></font></font></div>
<div role="search" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
    <input type="hidden" name="check_keywords" value="yes" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
    <input type="hidden" name="area" value="default" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
              <p class="caption" role="heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><span class="caption-text" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Overview<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">概述</font></font></font></span></p>
<ul data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Introduction.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Introduction<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">介绍</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Status.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Status<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">状态</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../man-index.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Manual pages<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">手册页面</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Administration.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Administration<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">管理</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Hardware.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Hardware considerations<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">硬件考虑</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Feature-by-version.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Changes (feature/version)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">变更（功能/版本）</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Kernel-by-version.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Changes (kernel/version)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">变更（内核/版本）</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../CHANGES.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Changes (btrfs-progs)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">变更（btrfs-progs）</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Contributors.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Contributors<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">贡献者</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Glossary.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Glossary<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">术语表</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../INSTALL.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Installation instructions<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">安装说明</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Source-repositories.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Source repositories<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">源代码库</font></font></font></a></li>
</ul>
<p class="caption" role="heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><span class="caption-text" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Features<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">特性</font></font></font></span></p>
<ul data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Common-features.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Common Linux features<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">常见的 Linux 特性</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Custom-ioctls.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Custom ioctls<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">自定义 ioctls</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Auto-repair.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Auto-repair on read<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">读取时自动修复</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Balance.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Balance<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">平衡</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Compression.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Compression<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">压缩</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Checksumming.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Checksumming<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">校验和</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Convert.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Convert<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">转换</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Deduplication.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Deduplication<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">重复数据删除</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Defragmentation.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Defragmentation<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">碎片整理</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Inline-files.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Inline files<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">内联文件</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Qgroups.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Quota groups<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">配额组</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Reflink.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Reflink<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">引用链接</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Resize.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Resize<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">调整大小</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Scrub.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Scrub<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">擦拭</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Seeding-device.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Seeding device<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">种子设备</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Send-receive.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Send/receive<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">发送/接收</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Subpage.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Subpage support<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">子页面支持</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Subvolumes.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Subvolumes<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">子卷</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Swapfile.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Swapfile<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">交换文件</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Tree-checker.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Tree checker<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">树检查器</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Trim.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Trim/discard<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">修剪/丢弃</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Volume-management.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Volume management<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">卷管理</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Zoned-mode.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Zoned mode<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">分区模式</font></font></font></a></li>
</ul>
<p class="caption" role="heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><span class="caption-text" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Developer documentation<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">开发者文档</font></font></font></span></p>
<ul class="current" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="Development-notes.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Development notes<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">开发说明</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="Developer-s-FAQ.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Developer’s FAQ<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">开发者常见问题解答</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../DocConventions.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Conventions and style for documentation<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文档约定和风格</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="Experimental.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Experimental features<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">实验性功能</font></font></font></a></li>
<li class="toctree-l1 current" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="current reference internal" href="#" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btrfs design<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Btrfs 设计</font></font></font></a><ul data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<li class="toctree-l2" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#btree-data-structures" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btree Data structures<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">B 树数据结构</font></font></font></a></li>
<li class="toctree-l2" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#filesystem-data-structures" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Filesystem Data Structures<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件系统数据结构</font></font></font></a></li>
<li class="toctree-l2" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#inodes" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Inodes<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">索引节点</font></font></font></a></li>
<li class="toctree-l2" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#files" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Files<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件</font></font></font></a></li>
<li class="toctree-l2" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#directories" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Directories<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">目录</font></font></font></a></li>
<li class="toctree-l2" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#reference-counted-extents" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Reference Counted Extents<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">引用计数的范围</font></font></font></a></li>
<li class="toctree-l2" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#extent-block-groups" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Extent Block Groups<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">范围块组</font></font></font></a></li>
<li class="toctree-l2" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#extent-trees-and-dm-integration" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Extent Trees and DM integration<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">范围树和 DM 集成</font></font></font></a></li>
<li class="toctree-l2" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#explicit-back-references" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Explicit Back References<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">明确的反向引用</font></font></font></a><ul data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<li class="toctree-l3" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#file-extent-backrefs" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">File Extent Backrefs<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件范围反向引用</font></font></font></a></li>
<li class="toctree-l3" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#btree-extent-backrefs" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btree Extent Backrefs<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">B 树范围反向引用</font></font></font></a></li>
<li class="toctree-l3" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#back-reference-key-construction" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Back Reference Key Construction<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">反向引用键构建</font></font></font></a></li>
</ul>
</li>
<li class="toctree-l2" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#snapshots-and-subvolumes" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Snapshots and Subvolumes<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">快照和子卷</font></font></font></a></li>
<li class="toctree-l2" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#btree-roots" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btree Roots<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">B 树根</font></font></font></a></li>
<li class="toctree-l2" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#copy-on-write-logging" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Copy on Write Logging<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">写时复制日志</font></font></font></a></li>
<li class="toctree-l2" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="#btrfsck" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btrfsck</a></li>
</ul>
</li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="dev-btrees.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btrees</a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="On-disk-format.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">On-disk Format<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">磁盘格式</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="dev-send-stream.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Send stream format<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">发送流格式</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="dev-json.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">JSON output<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">JSON 输出</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="dev-internal-apis.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Internal APIs<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">内部 API</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="ReleaseChecklist.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Release checklist<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">发布清单</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../btrfs-ioctl.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">btrfs-ioctl(2)</a></li>
</ul>
<p class="caption" role="heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><span class="caption-text" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">TODO<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">待办事项</font></font></font></span></p>
<ul data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Quick-start.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Quick start<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">快速开始</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../Interoperability.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Interoperability<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">互操作性</font></font></font></a></li>
<li class="toctree-l1" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a class="reference internal" href="../trouble-index.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Troubleshooting pages<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">故障排除页面</font></font></font></a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><nav class="wy-nav-top" aria-label="Mobile navigation menu" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">BTRFS</a>
      </nav>

      <div class="wy-nav-content" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
        <div class="rst-content" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
          <div role="navigation" aria-label="Page navigation" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
  <ul class="wy-breadcrumbs" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
      <li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a href="../index.html" class="icon icon-home" aria-label="Home" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a></li>
      <li class="breadcrumb-item active" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btrfs design<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Btrfs 设计</font></font></font></li>
      <li class="wy-breadcrumbs-aside" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
              <a href="https://github.com/kdave/btrfs-progs/blob/devel/Documentation/dev/dev-btrfs-design.rst" class="fa fa-github" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1"> Edit on GitHub<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在 GitHub 上编辑</font></font></font></a>
      </li>
  </ul>
  <hr>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
           <div itemprop="articleBody" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
             
  <section id="btrfs-design" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h1 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btrfs design<a class="headerlink" href="#btrfs-design" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Btrfs 设计</font></font></font></h1>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btrfs is implemented with simple and well known constructs. It should
perform well, but the long term goal of maintaining performance as the
FS system ages and grows is more important than winning a short lived
benchmark. To that end, benchmarks are being used to try to simulate
performance over the life of a filesystem.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Btrfs 是用简单和众所周知的结构实现的。它应该表现良好，但随着文件系统的老化和增长，保持性能的长期目标比赢得短暂的基准测试更重要。为此，基准测试被用来尝试模拟文件系统寿命内的性能。</font></font></font></p>
<section id="btree-data-structures" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h2 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btree Data structures<a class="headerlink" href="#btree-data-structures" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">B 树数据结构</font></font></font></h2>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The Btrfs btree provides a generic facility to store a variety of data
types. Internally it only knows about three data structures: keys,
items, and a block header:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Btrfs btree 提供了一个通用的设施来存储各种数据类型。在内部，它只知道三种数据结构：键、项和块头：</font></font></font></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct btrfs_header {
        u8 csum[32];
        u8 fsid[16];
        __le64 bytenr;
        __le64 flags;

        u8 chunk_tree_uid[16];
        __le64 generation;
        __le64 owner;
        __le32 nritems;
        u8 level;
}
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct btrfs_disk_key {
       __le64 objectid;
       u8 type;
       __le64 offset;
}
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct btrfs_item {
       struct btrfs_disk_key key;
       __le32 offset;
       __le32 size;
}
</pre></div>
</div>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Upper nodes of the trees contain only [ key, block pointer ] pairs. Tree
leaves are broken up into two sections that grow toward each other.
Leaves have an array of fixed sized items, and an area where item data
is stored. The offset and size fields in the item indicate where in the
leaf the item data can be found. Example:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">树的上层节点仅包含 [键，块指针] 对。树叶被分成两个朝向彼此增长的部分。叶子节点具有一个固定大小项的数组，以及存储项数据的区域。项中的偏移和大小字段指示了在叶子节点中可以找到项数据的位置。示例：</font></font></font></p>
<img alt="Leaf structure" src="../_images/Leaf-structure.png" width="121.203125" height="22.5" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Item data is variably size, and various filesystem data structures are
defined as different types of item data. The type field in struct
btrfs_disk_key indicates the type of data stored in the item.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">项数据的大小可变，各种文件系统数据结构被定义为不同类型的项数据。在 struct btrfs_disk_key 中的类型字段指示了存储在项中的数据类型。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The block header contains a checksum for the block contents, the uuid of
the filesystem that owns the block, the level of the block in the tree,
and the block number where this block is supposed to live. These fields
allow the contents of the metadata to be verified when the data is read.
Everything that points to a btree block also stores the generation field
it expects that block to have. This allows Btrfs to detect phantom or
misplaced writes on the media.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">区块头包含了区块内容的校验和、拥有该区块的文件系统的 UUID、区块在树中的级别以及该区块应该存放的区块号。这些字段允许在读取数据时验证元数据的内容。指向 btree 区块的所有内容也会存储它期望该区块具有的生成字段。这使得 Btrfs 能够检测介质上的幻影或错位写入。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The checksum of the lower node is not stored in the node pointer to
simplify the FS writeback code. The generation number will be known at
the time the block is inserted into the btree, but the checksum is only
calculated before writing the block to disk. Using the generation will
allow Btrfs to detect phantom writes without having to find and update
the upper node each time the lower node checksum is updated.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">为了简化文件系统写回代码，下层节点的校验和不会存储在节点指针中。在将区块插入到 btree 时会知道生成号，但校验和只会在将区块写入磁盘之前计算。使用生成号将允许 Btrfs 在不必每次更新下层节点校验和时找到并更新上层节点的情况下检测到幻影写入。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The generation field corresponds to the transaction id that allocated
the block, which enables easy incremental backups and is used by the
copy on write transaction subsystem.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">生成字段对应于分配该区块的事务 ID，这使得容易进行增量备份，并被写时复制事务子系统使用。</font></font></font></p>
</section>
<section id="filesystem-data-structures" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h2 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Filesystem Data Structures<a class="headerlink" href="#filesystem-data-structures" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件系统数据结构</font></font></font></h2>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Each object in the filesystem has an objectid, which is allocated
dynamically on creation. A free objectid is simply a hole in the key
space of the filesystem btree; objectids that don’t already exist in the
tree. The objectid makes up the most significant bits of the key,
allowing all of the items for a given filesystem object to be logically
grouped together in the btree.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件系统中的每个对象都有一个对象 ID，在创建时动态分配。空闲的对象 ID 只是文件系统 B 树键空间中的一个空洞；这些对象 ID 在树中尚不存在。对象 ID 组成键的最高有效位，允许将给定文件系统对象的所有项在 B 树中逻辑分组在一起。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The offset field of the key stores indicates the byte offset for a
particular item in the object. For file extents, this would be the byte
offset of the start of the extent in the file. The type field stores the
item type information, and has extra room for expanded use.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">键的偏移字段指示对象中特定项的字节偏移量。对于文件范围，这将是文件中范围起始处的字节偏移量。类型字段存储项类型信息，并具有用于扩展使用的额外空间。</font></font></font></p>
</section>
<section id="inodes" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h2 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Inodes<a class="headerlink" href="#inodes" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">索引节点</font></font></font></h2>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Inodes are stored in struct btrfs_inode_item at offset zero in the key,
and have a type value of one. Inode items are always the lowest valued
key for a given object, and they store the traditional stat data for
files and directories. The inode structure is relatively small, and will
not contain embedded file data or extended attribute data. These things
are stored in other item types.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">索引节点存储在键的偏移零处的 struct btrfs_inode_item 中，并且具有类型值为一。索引节点项始终是给定对象的键中值最低的项，它们存储文件和目录的传统 stat 数据。索引节点结构相对较小，不包含嵌入的文件数据或扩展属性数据。这些内容存储在其他项类型中。</font></font></font></p>
</section>
<section id="files" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h2 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Files<a class="headerlink" href="#files" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件</font></font></font></h2>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Small files that occupy less than one leaf block may be packed into the
btree inside the extent item. In this case the key offset is the byte
offset of the data in the file, and the size field of struct btrfs_item
indicates how much data is stored. There may be more than one of these
per file.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">占用少于一个叶块的小文件可以打包到范围项内的 btree 中。在这种情况下，键偏移量是文件中数据的字节偏移量，struct btrfs_item 的大小字段指示存储了多少数据。一个文件中可能有多个这样的项。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Larger files are stored in extents. struct btrfs_file_extent_item
records a generation number for the extent and a [ disk block, disk num
blocks ] pair to record the area of disk corresponding to the file.
Extents also store the logical offset and the number of blocks used by
this extent record into the extent on disk. This allows Btrfs to satisfy
a rewrite into the middle of an extent without having to read the old
file data first. For example, writing 1MB into the middle of a existing
128MB extent may result in three extent records:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">较大的文件存储在范围内。struct btrfs_file_extent_item 记录了范围的生成编号和一个[磁盘块，磁盘块数]对，用于记录与文件对应的磁盘区域。范围还存储了逻辑偏移量和用于将此范围记录写入磁盘的块数。这使得 Btrfs 能够在不必先读取旧文件数据的情况下满足对范围中间的重写。例如，将 1MB 写入现有的 128MB 范围中间可能会导致三个范围记录：</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><code class="docutils literal notranslate" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><span class="pre">[&nbsp;old&nbsp;extent:&nbsp;bytes&nbsp;0-64MB&nbsp;],&nbsp;[&nbsp;new&nbsp;extent&nbsp;1MB&nbsp;],&nbsp;[&nbsp;old&nbsp;extent:&nbsp;bytes&nbsp;65MB&nbsp;–&nbsp;128MB]</span></code></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">File data checksums are stored in a dedicated btree in a struct
btrfs_csum_item. The offset of the key corresponds to the byte number of
the extent. The data is checksummed after any compression or encryption
is done and it reflects the bytes sent to the disk.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件数据校验和存储在 struct btrfs_csum_item 中的专用 btree 中。键的偏移量对应于范围的字节编号。数据在执行任何压缩或加密后进行校验和，并且它反映了发送到磁盘的字节。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">A single item may store a number of checksums. struct btrfs_csum_items
are only used for file extents. File data inline in the btree is covered
by the checksum at the start of the btree block.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">单个项目可以存储多个校验和。struct btrfs_csum_items 仅用于文件范围。B 树中内联的文件数据由 B 树块开头的校验和覆盖。</font></font></font></p>
</section>
<section id="directories" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h2 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Directories<a class="headerlink" href="#directories" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">目录</font></font></font></h2>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Directories are indexed in two different ways. For filename lookup,
there is an index comprised of keys:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">目录有两种不同的索引方式。对于文件名查找，有一个由键组成的索引：</font></font></font></p>
<table class="docutils align-default" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<tbody data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<tr class="row-odd" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><td data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Directory Objectid<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">目录对象 ID</font></font></font></p></td>
<td><p>BTRFS_DIR_ITEM_KEY</p></td>
<td data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">64 bit filename hash<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">64 位文件名哈希</font></font></font></p></td>
</tr>
</tbody>
</table>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The default directory hash used is crc32c, although other hashes may be
added later on. A flags field in the super block will indicate which
hash is used for a given FS.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">默认目录哈希使用的是 crc32c，尽管以后可能会添加其他哈希。 超级块中的标志字段将指示对于给定的文件系统使用哪个哈希。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The second directory index is used by readdir to return data in inode
number order. This more closely resembles the order of blocks on disk
and generally provides better performance for reading data in bulk
(backups, copies, etc). Also, it allows fast checking that a given inode
is linked into a directory when verifying inode link counts. This index
uses an additional set of keys:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">readdir 使用第二个目录索引以 inode 编号顺序返回数据。这更接近磁盘上块的顺序，通常为批量读取数据（备份、复制等）提供更好的性能。此外，它允许快速检查给定的 inode 是否链接到目录中，从而验证 inode 链接计数。此索引使用额外的一组键：</font></font></font></p>
<table class="docutils align-default" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<tbody data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<tr class="row-odd" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><td data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Directory Objectid<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">目录对象 ID</font></font></font></p></td>
<td><p>BTRFS_DIR_INDEX_KEY</p></td>
<td data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Inode Sequence number<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Inode 序列号</font></font></font></p></td>
</tr>
</tbody>
</table>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The inode sequence number comes from the directory. It is increased each
time a new file or directory is added.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">i 节点序列号来自目录。每次添加新文件或目录时都会增加。</font></font></font></p>
</section>
<section id="reference-counted-extents" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h2 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Reference Counted Extents<a class="headerlink" href="#reference-counted-extents" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">引用计数的范围</font></font></font></h2>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Reference counting is the basis for the snapshotting subsystems. For
every extent allocated to a btree or a file, Btrfs records the number of
references in a struct btrfs_extent_item. The trees that hold these
items also serve as the allocation map for blocks that are in use on the
filesystem. Some trees are not reference counted and are only protected
by a copy on write logging. However, the same type of extent items are
used for all allocated blocks on the disk.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">引用计数是快照子系统的基础。对于分配给 btree 或文件的每个范围，Btrfs 在 struct btrfs_extent_item 中记录引用的数量。保存这些项的树也用作文件系统上正在使用的块的分配图。一些树没有引用计数，只受写时复制日志的保护。然而，所有磁盘上分配的块都使用相同类型的范围项。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">A reasonably comprehensive description of the way that references work
can be found in <a class="reference external" href="http://www.spinics.net/lists/linux-btrfs/msg33415.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">this email from Josef
Bacik</a>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">可以在 Josef Bacik 的电子邮件中找到对引用工作方式的相当全面的描述。</font></font></font></p>
</section>
<section id="extent-block-groups" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h2 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Extent Block Groups<a class="headerlink" href="#extent-block-groups" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">范围块组</font></font></font></h2>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Extent block groups allow allocator optimizations by breaking the disk
up into chunks of 256MB or more. For each chunk, they record information
about the number of blocks available. Files and directories will have a
preferred block group which they try first for allocations.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">范围块组通过将磁盘分成 256MB 或更大的块来实现分配器优化。对于每个块，它们记录有关可用块数量的信息。文件和目录将有一个首选块组，它们首先尝试进行分配。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Block groups have a flag that indicate if they are preferred for data or
metadata allocations, and at mkfs time the disk is broken up into
alternating metadata (33% of the disk) and data groups (66% of the
disk). As the disk fills, a group’s preference may change back and
forth, but Btrfs always tries to avoid intermixing data and metadata
extents in the same group. This substantially improves fsck throughput,
and reduces seeks during writeback while the FS is mounted. It does
slightly increase the seeks while reading.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">块组有一个标志，指示它们是否首选用于数据或元数据分配，并且在 mkfs 时间，磁盘被分成交替的元数据（磁盘的 33%）和数据组（磁盘的 66%）。随着磁盘填满，组的首选项可能来回变化，但 Btrfs 总是尽量避免在同一组中混合数据和元数据范围。这大大提高了 fsck 的吞吐量，并减少了在挂载文件系统时写回期间的寻道。这确实会增加读取时的寻道。</font></font></font></p>
</section>
<section id="extent-trees-and-dm-integration" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h2 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Extent Trees and DM integration<a class="headerlink" href="#extent-trees-and-dm-integration" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">范围树和 DM 集成</font></font></font></h2>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The Btrfs extent trees are intended to divide up the available storage
into a number of flexible allocation policies. Each extent tree owns a
section of the underlying disk, and they can be assigned to a collection
of (or a single) tree roots, directories or inodes. Policies will direct
how a given allocation is spread across the extent trees available,
allowing the admin to direct which parts of the filesystem are striped,
mirrored or confined to a given device.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Btrfs 范围树旨在将可用存储划分为多种灵活的分配策略。每个范围树拥有底层磁盘的一部分，并且它们可以分配给一组（或单个）树根、目录或索引节点。策略将指导如何将给定的分配分布到可用的范围树中，允许管理员指导文件系统的哪些部分是条带化的、镜像化的或限制在给定设备上。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btrfs will try to tie in with DM in order to easily manage large pools
of storage. The basic idea is to have at least one extent tree per
spindle, and then allow the admin to assign those extent trees to
subvolumes, directories or files.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Btrfs 将尝试与 DM 结合，以便轻松管理大型存储池。基本思想是每个主轴至少有一个范围树，然后允许管理员将这些范围树分配给子卷、目录或文件。</font></font></font></p>
</section>
<section id="explicit-back-references" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h2 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Explicit Back References<a class="headerlink" href="#explicit-back-references" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">显式反向引用</font></font></font></h2>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Back references have three main goals:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">反向引用有三个主要目标：</font></font></font></p>
<ul class="simple" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Differentiate between all holders of references to an extent so that
when a reference is dropped we can make sure it was a valid reference
before freeing the extent.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">区分所有引用持有者的程度，以便在引用被丢弃时，我们可以确保在释放范围之前它是一个有效的引用。</font></font></font></p></li>
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Provide enough information to quickly find the holders of an extent
if we notice a given block is corrupted or bad.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">提供足够的信息，以便在我们注意到给定块已损坏或有问题时，快速找到范围的持有者。</font></font></font></p></li>
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Make it easy to migrate blocks for FS shrinking or storage pool
maintenance. This is actually the same as #2, but with a slightly
different use case.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使块易于迁移，以便进行文件系统收缩或存储池维护。这实际上与＃2 相同，但具有略有不同的用例。</font></font></font></p></li>
</ul>
<section id="file-extent-backrefs" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h3 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">File Extent Backrefs<a class="headerlink" href="#file-extent-backrefs" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件扩展名反向引用 </font></font></font></h3>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">File extents can be referenced by:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件扩展可以被引用为：</font></font></font></p>
<ul class="simple" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Multiple snapshots, subvolumes, or different generations in one
subvol<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在一个子卷中的多个快照、子卷或不同的生成</font></font></font></p></li>
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Different files inside a single subvolume<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">单个子卷内的不同文件</font></font></font></p></li>
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Different offsets inside a file<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件内的不同偏移量</font></font></font></p></li>
</ul>
<div class="admonition note" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<p class="admonition-title" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Note<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">注意</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The&nbsp;remainder&nbsp;of&nbsp;this&nbsp;section&nbsp;refers&nbsp;to&nbsp;the&nbsp;extent_ref_v0&nbsp;structure,&nbsp;which&nbsp;is&nbsp;not&nbsp;used&nbsp;on&nbsp;current&nbsp;btrfs&nbsp;filesystems.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">本节的其余部分涉及 extent_ref_v0 结构，该结构在当前的 btrfs 文件系统上不使用。</font></font></font></p>
</div>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The extent ref structure has fields for:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">扩展 ref 结构具有以下字段：</font></font></font></p>
<ul class="simple" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Objectid of the subvolume root<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">子卷根的 Objectid</font></font></font></p></li>
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Generation number of the tree holding the reference<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">持有引用的树的生成编号</font></font></font></p></li>
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">objectid of the file holding the reference<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件持有引用的对象标识符</font></font></font></p></li>
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">offset in the file corresponding to the key holding the reference<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件中对应于持有引用的键的偏移量</font></font></font></p></li>
</ul>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">When a file extent is allocated the fields are filled in:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当分配文件范围时，填充字段：</font></font></font></p>
<blockquote data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<div data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">(root objectid, transaction id, inode objectid, offset in file)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">(根对象 ID，事务 ID，inode 对象 ID，文件中的偏移量)</font></font></font></p>
</div></blockquote>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">When a leaf is cow’d new references are added for every file extent
found in the leaf. It looks the same as the create case, but the
transaction id will be different when the block is cow’d.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当叶子被复制时，为叶子中找到的每个文件范围添加新的引用。它看起来与创建情况相同，但在块被复制时事务 ID 将不同。</font></font></font></p>
<blockquote data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<div data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">(root objectid, transaction id, inode objectid, offset in file)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">(根对象 ID，事务 ID，inode 对象 ID，文件中的偏移量)</font></font></font></p>
</div></blockquote>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">When a file extent is removed either during snapshot deletion or file
truncation, the corresponding back reference is found by searching for:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当文件范围在快照删除或文件截断期间被移除时，通过搜索以下内容找到相应的后向引用：</font></font></font></p>
<blockquote data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<div data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">(btrfs_header_owner(leaf), btrfs_header_generation(leaf), inode
objectid, offset in file)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">（btrfs_header_owner(叶子), btrfs_header_generation(叶子), inode 对象 ID, 文件中的偏移量）</font></font></font></p>
</div></blockquote>
</section>
<section id="btree-extent-backrefs" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h3 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btree Extent Backrefs<a class="headerlink" href="#btree-extent-backrefs" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">B 树范围后向引用 </font></font></font></h3>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btree extents can be referenced by:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">B 树范围可以被引用：</font></font></font></p>
<ul class="simple" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Different subvolumes<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">不同的子卷</font></font></font></p></li>
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Different generations of the same subvolume<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">相同子卷的不同世代</font></font></font></p></li>
</ul>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Storing sufficient information for a full reverse mapping of a btree
block would require storing the lowest key of the block in the backref,
and it would require updating that lowest key either before write out or
every time it changed.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">存储足够的信息以完全反向映射 btree 块将需要在 backref 中存储块的最低键，并且需要在写出之前或每次更改时更新该最低键。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Instead, the objectid of the lowest key is stored along with the level
of the tree block. This provides a hint about where in the btree the
block can be found. Searches through the btree only need to look for a
pointer to that block, and they stop one level higher than the level
recorded in the backref.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">相反，存储最低键的 objectid 以及树块的级别。这提供了有关在 btree 中可以找到块的位置的提示。通过 btree 的搜索只需要查找指向该块的指针，并且它们停在 backref 中记录的级别的上一级。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Some btrees do not do reference counting on their extents. These include
the extent tree and the tree of tree roots. Backrefs for these trees
always have a generation of zero.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">一些 btree 不对其范围进行引用计数。这些包括范围树和树根的树。这些树的 backref 总是具有零的生成。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">When a tree block is created, back references are inserted:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当创建树块时，会插入反向引用：</font></font></font></p>
<blockquote data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<div data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">(root objectid, transaction id or zero, level, lowest objectid)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">（根对象 id、事务 id 或零、级别、最低对象 id）</font></font></font></p>
</div></blockquote>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The level is stored in the objectid slot of the backref to differentiate
between Btree back references and file data back references. The highest
possible level is 255, and the lowest possible file objectid has been
raised to 256. So, if the objectid field in the back reference is less
than 256, it corresponds to a Btree block.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">级别存储在反向引用的对象 id 槽中，以区分 B 树反向引用和文件数据反向引用。最高可能级别为 255，最低可能文件对象 id 已提高至 256。因此，如果反向引用中的对象 id 字段小于 256，则对应于 B 树块。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">When a tree block is cow’d in a reference counted root, new back
references are added for all the blocks it points to:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当树块在引用计数根中被 cow’d 时，为其指向的所有块添加新的反向引用：</font></font></font></p>
<blockquote data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<div data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">(root objectid, transaction id, level, lowest objectid)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">（根对象 id，事务 id，级别，最低对象 id）</font></font></font></p>
</div></blockquote>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Because the lowest_key_objectid and the level are just hints they are
not used when backrefs are deleted. When a snapshot is created a new
reference is taken directly on the root block. This means the owner
field of the root block may be different from the objectid of the
snapshot. So, when dropping references on tree roots, the objectid of
the root structure is always used. When a backref is deleted:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">因为最低键对象 id 和级别只是提示，它们在删除反向引用时不会被使用。创建快照时，直接在根块上获取新的引用。这意味着根块的所有者字段可能与快照的对象 id 不同。因此，在删除树根上的引用时，始终使用根结构的对象 id。当删除反向引用时：</font></font></font></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if&nbsp;backref&nbsp;was&nbsp;for&nbsp;a&nbsp;tree&nbsp;root:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root_objectid&nbsp;=&nbsp;root-&gt;root_key.objectid
else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root_objectid&nbsp;=&nbsp;btrfs_header_owner(parent)
</pre></div>
</div>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">(root_objectid, btrfs_header_generation(parent) or zero, 0, 0)<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">(root_objectid, btrfs_header_generation(parent) 或零, 0, 0)</font></font></font></p>
</section>
<section id="back-reference-key-construction" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h3 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Back Reference Key Construction<a class="headerlink" href="#back-reference-key-construction" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">反向引用键构造</font></font></font></h3>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Back references have four fields, each 64 bits long. This is hashed into
a single 64 bit number and placed into the key offset. The key objectid
corresponds to the first byte in the extent, and the key type is set to
BTRFS_EXTENT_REF_KEY.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">反向引用有四个字段，每个字段长度为 64 位。这被哈希成一个 64 位的数字，并放入键偏移量中。键对象 ID 对应于范围中的第一个字节，键类型设置为 BTRFS_EXTENT_REF_KEY。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Hash overflows on the offset field are handled by adding one to the
calculated hash and searching forward. The searching stops when the
correct back reference structure is found or<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">散列溢出在偏移字段上通过将计算的散列加一并向前搜索来处理。当找到正确的后向引用结构或搜索停止</font></font></font></p>
</section>
</section>
<section id="snapshots-and-subvolumes" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h2 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Snapshots and Subvolumes<a class="headerlink" href="#snapshots-and-subvolumes" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">快照和子卷</font></font></font></h2>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Subvolumes are basically a named btree that holds files and directories.
They have inodes inside the tree of tree roots and can have non-root
owners and groups. Subvolumes can be given a quota of blocks, and once
this quota is reached no new writes are allowed. All of the blocks and
file extents inside of subvolumes are reference counted to allow
snapshotting. Up to 2<sup data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">64</sup> subvolumes may be created on the FS.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">子卷基本上是一个包含文件和目录的命名 b 树。它们在树根的树中有索引节点，并且可以有非根所有者和组。子卷可以被分配一个块的配额，一旦达到这个配额，就不允许新的写入。子卷内的所有块和文件范围都是引用计数的，以允许快照。在 FS 上最多可以创建 2 个子卷。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Snapshots are identical to subvolumes, but their root block is initially
shared with another subvolume. When the snapshot is taken, the reference
count on the root block is increased, and the copy on write transaction
system ensures changes made in either the snapshot or the source
subvolume are private to that root. Snapshots are writable, and they can
be snapshotted again any number of times. If read only snapshots are
desired, their block quota is set to one at creation time.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">快照与子卷相同，但其根块最初与另一个子卷共享。拍摄快照时，根块上的引用计数会增加，并且写时复制事务系统确保在快照或源子卷中进行的更改对该根是私有的。快照是可写的，并且可以再次进行任意次数的快照。如果需要只读快照，则在创建时将其块配额设置为 1。</font></font></font></p>
</section>
<section id="btree-roots" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h2 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btree Roots<a class="headerlink" href="#btree-roots" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">B 树根</font></font></font></h2>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Each Btrfs filesystem consists of a number of tree roots. A freshly
formatted filesystem will have roots for:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">每个 Btrfs 文件系统由多个树根组成。新格式化的文件系统将具有以下根：</font></font></font></p>
<ul class="simple" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The tree of tree roots<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">树根的树</font></font></font></p></li>
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The tree of allocated extents<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">已分配范围的树</font></font></font></p></li>
<li data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The default subvolume tree<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">默认子卷树</font></font></font></p></li>
</ul>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The tree of tree roots records the root block for the extent tree and
the root blocks and names for each subvolume and snapshot tree. As
transactions commit, the root block pointers are updated in this tree to
reference the new roots created by the transaction, and then the new
root block of this tree is recorded in the FS super block.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">树根树记录了范围树的根块以及每个子卷和快照树的根块和名称。随着事务提交，根块指针在此树中更新，以引用事务创建的新根，然后此树的新根块记录在 FS 超级块中。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The tree of tree roots acts as a directory of all the other trees on the
filesystem, and it has directory items recording the names of all
snapshots and subvolumes in the FS. Each snapshot or subvolume has an
objectid in the tree of tree roots, and at least one corresponding
struct btrfs_root_item. Directory items in the tree map names of
snapshots and subvolumes to these root items. Because the root item key
is updated with every transaction commit, the directory items reference
a generation number of (u64)-1, which tells the lookup code to find the
most recent root available.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">树根树充当文件系统中所有其他树的目录，它具有记录 FS 中所有快照和子卷名称的目录项。每个快照或子卷在树根树中具有一个对象 ID，并且至少有一个相应的 struct btrfs_root_item。树中的目录项将快照和子卷的名称映射到这些根项。由于每个事务提交时更新根项键，因此目录项引用(u64)-1 的生成编号，告诉查找代码找到最新的可用根。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The extent trees are used to manage allocated space on the devices. The
space available can be divided between a number of extent trees to
reduce lock contention and give different allocation policies to
different block ranges.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">范围树用于管理设备上分配的空间。可用空间可以在多个范围树之间划分，以减少锁争用并为不同的块范围提供不同的分配策略。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The diagram below depicts a collection of tree roots. The super block
points to the root tree, and the root tree points to the extent trees
and subvolumes. The root tree also has a directory to map subvolume
names to struct btrfs_root_items in the root tree. This filesystem has
one subvolume named ‘default’ (created by mkfs), and one snapshot of
‘default’ named ‘snap’ (created by the admin some time later). In this
example, ‘default’ has not changed since the snapshot was created and so
both point tree to the same root block on disk.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">下面的图表描述了一组树根。超级块指向根树，根树指向范围树和子卷。根树还有一个目录，将子卷名称映射到根树中的 struct btrfs_root_items。这个文件系统有一个名为“default”的子卷（由 mkfs 创建），以及一个名为“snap”的“default”快照（由管理员在稍后的某个时间创建）。在这个例子中，“default”自创建快照以来没有发生变化，因此两者都指向磁盘上相同的根块。</font></font></font></p>
<img alt="Copy-Design-r.png" src="../_images/Copy-Design-r.png" width="162.2890625" height="22.5" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
</section>
<section id="copy-on-write-logging" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h2 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Copy on Write Logging<a class="headerlink" href="#copy-on-write-logging" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">写时复制日志</font></font></font></h2>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Data and metadata in Btrfs are protected with copy on write logging
(COW). Once the transaction that allocated the space on disk has
committed, any new writes to that logical address in the file or btree
will go to a newly allocated block, and block pointers in the btrees and
super blocks will be updated to reflect the new location.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Btrfs 中的数据和元数据受到写时复制日志（COW）的保护。一旦在磁盘上分配了空间的事务提交，对文件或 B 树中的逻辑地址的任何新写入都将进入新分配的块，并且 B 树和超级块中的块指针将被更新以反映新位置。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Some of the btrfs trees do not use reference counting for their
allocated space. This includes the root tree, and the extent trees. As
blocks are replaced in these trees, the old block is freed in the extent
tree. These blocks are not reused for other purposes until the
transaction that freed them commits.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">一些 btrfs 树不使用引用计数来管理它们分配的空间。这包括根树和范围树。当这些树中的块被替换时，在范围树中释放旧块。这些块直到释放它们的事务提交后才能被重新用于其他目的。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">All subvolume (and snapshot) trees are reference counted. When a COW
operation is performed on a btree node, the reference count of all the
blocks it points to is increased by one. For leaves, the reference
counts of any file extents in the leaf are increased by one. When the
transaction commits, a new root pointer is inserted in the root tree for
each new subvolume root. The key used has the form:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">所有子卷（和快照）树都是引用计数的。当在 btree 节点上执行 COW 操作时，它指向的所有块的引用计数都会增加一。对于叶子节点，叶子中的任何文件范围的引用计数都会增加一。当事务提交时，为每个新的子卷根在根树中插入一个新的根指针。使用的键的形式为：</font></font></font></p>
<table class="docutils align-default" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<tbody data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<tr class="row-odd" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><td data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Subvolume inode number<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">子卷 inode 编号</font></font></font></p></td>
<td><p>BTRFS_ROOT_ITEM_KEY</p></td>
<td data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Transaction ID<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">交易 ID</font></font></font></p></td>
</tr>
</tbody>
</table>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The updated btree blocks are all flushed to disk, and then the super
block is updated to point to the new root tree. Once the super block has
been properly written to disk, the transaction is considered complete.
At this time the root tree has two pointers for each subvolume changed
during the transaction. One item points to the new tree and one points
to the tree that existed at the start of the last transaction.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">更新的 btree 块都被刷新到磁盘，然后超级块被更新指向新的根树。一旦超级块被正确写入磁盘，交易被视为完成。此时，根树对于交易期间更改的每个子卷都有两个指针。一个指向新树，一个指向上次交易开始时存在的树。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Any time after the commit finishes, the older subvolume root items may
be removed. The reference count on the subvolume root block is lowered
by one. If the reference count reaches zero, the block is freed and the
reference count on any nodes the root points to is lowered by one. If a
tree node or leaf can be freed, it is traversed to free the nodes or
extents below it in the tree in a depth first fashion.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在提交完成后的任何时间，旧的子卷根项目可能会被移除。子卷根块上的引用计数减少一。如果引用计数达到零，该块将被释放，并且根指向的任何节点的引用计数减少一。如果可以释放树节点或叶子，它将以深度优先的方式遍历以释放树中它下面的节点或范围。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The traversal and freeing of the tree may be done in pieces by inserting
a progress record in the root tree. The progress record indicates the
last key and level touched by the traversal so the current transaction
can commit and the traversal can resume in the next transaction. If the
system crashes before the traversal completes, the progress record is
used to safely delete the root on the next mount.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">树的遍历和释放可以通过在根树中插入进度记录来分段完成。进度记录指示了遍历所触及的最后一个键和级别，因此当前事务可以提交，遍历可以在下一个事务中恢复。如果系统在遍历完成之前崩溃，进度记录将用于在下次挂载时安全删除根。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Ohad Rodeh presented this reference counted snapshot algorithm at the
2007 Linux Filesystem and Storage Workshop:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Ohad Rodeh 在 2007 年的 Linux 文件系统和存储研讨会上介绍了这个引用计数快照算法：</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Slides: <a class="reference external" href="Media:LinuxFS_Workshop.pdf" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">LinuxFS_Workshop.pdf</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">幻灯片：LinuxFS_Workshop.pdf</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Paper: <a class="reference external" href="Media:Btree_TOS.pdf" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">Btree_TOS.pdf</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件：Btree_TOS.pdf</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The Btrfs snapshotting implementation is based on the ideas he
presented.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Btrfs 快照实现是基于他提出的想法。</font></font></font></p>
</section>
<section id="btrfsck" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
<h2 data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Btrfsck<a class="headerlink" href="#btrfsck" title="Link to this heading" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></a></h2>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">The filesystem checking utility is a crucial tool, but it can be a major
bottleneck in getting systems back online after something has gone
wrong. Btrfs aims to be tolerant of invalid metadata, and will avoid
using metadata it determines to be incorrect. The disk format allows
Btrfs to deal with most corruptions at run time, without crashing the
system and without requiring offline filesystem checking.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件系统检查实用程序是一个至关重要的工具，但在系统出现问题后重新上线时可能成为一个主要瓶颈。Btrfs 旨在容忍无效的元数据，并将避免使用它认为不正确的元数据。磁盘格式允许 Btrfs 在运行时处理大多数损坏，而无需使系统崩溃并且无需离线文件系统检查。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">An offline btrfsck is being developed, in part to help verify the
filesystem during testing, and as an emergency tool to make sure the
filesystem is safe for mounting. The existing tool only verifies the
extent allocation maps, making sure that reference counts are correct
and that all extents are accounted for. If the extent maps are correct,
there is no risk of incorrectly writing over existing data or metadata
as blocks are allocated for new use.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">正在开发离线 btrfsck，部分原因是为了在测试期间验证文件系统，并作为一种紧急工具，以确保文件系统可以安全挂载。现有工具仅验证范围分配图，确保引用计数正确并且所有范围都有记录。如果范围图正确，那么在为新用途分配块时不会错误地覆盖现有数据或元数据。</font></font></font></p>
<p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">btrfsck is able to read metadata in roughly disk order. As it scans the
btrees on disk, it collects the locations of nodes and leaves and pulls
them from the disk in large sequential batches. For the most part,
btrfsck is bound by the sequential read throughput of the storage, and
it is able to take advantage of multi-spindle arrays. The price paid for
the extra speed is more ram. Btrfsck uses about 3x more ram than
ext2fsck.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">btrfsck 能够按照大致的磁盘顺序读取元数据。在扫描磁盘上的 b 树时，它会收集节点和叶子的位置，并以大批量的顺序从磁盘中提取它们。在大多数情况下，btrfsck 受到存储的顺序读取吞吐量的限制，并且能够利用多个磁盘阵列。为了获得额外的速度，需要付出更多的内存。与 ext2fsck 相比，btrfsck 使用的内存大约多 3 倍。</font></font></font></p>
</section>
</section>


           </div>
          </div>
          <footer data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1"><div class="rst-footer-buttons" role="navigation" aria-label="Footer" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
        <a href="Experimental.html" class="btn btn-neutral float-left" title="Experimental features" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dev-btrees.html" class="btn btn-neutral float-right" title="Btrees" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr>

  <div role="contentinfo" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
    <p data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">© Copyright .
      <span class="commit" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">Revision <code data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">cae94956</code>.
      </span><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">© 版权所有。修订版 <code data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">cae94956</code> 。</font></font></font></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">theme</a>
    provided by <a href="https://readthedocs.org" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">Read the Docs</a>.
   

<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用由 Read the Docs 提供的主题构建的 Sphinx。</font></font></font></footer>
        </div>
      </div>
    </section>
  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
    <span class="rst-current-version" data-toggle="rst-current-version" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">
      <span class="fa fa-book" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"> Read the Docs</span>
      v: latest
      <font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Read the Docs 版本：最新</font></font></font><span class="fa fa-caret-down" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"></span>
    </span>
    <div class="rst-other-versions" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
      <dl data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
        <dt data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Versions<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">版本</font></font></font></dt>
        
          <dd data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a href="../../../index.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">latest<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">最新</font></font></font></a></dd>
        
          <dd data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd"><a href="../../stable/index.html" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">stable<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">稳定</font></font></font></a></dd>
        
      </dl>
      <dl data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
        <dt data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Downloads<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">下载</font></font></font></dt>
        
      </dl>
      <dl data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
        
        <dt data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">On Read the Docs<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在 Read the Docs 上</font></font></font></dt>
          <dd data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
            <a href="https://readthedocs.org/projects/btrfs/?fromdocs=btrfs" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Project Home<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">项目主页</font></font></font></a>
          </dd>
          <dd data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd">
            <a href="https://readthedocs.org/builds/btrfs/?fromdocs=btrfs" data-immersive-translate-walked="0b8b4a6b-9a3e-4a82-be8d-ec2ba89e17cd" data-immersive-translate-paragraph="1">Builds<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">构建</font></font></font></a>
          </dd>
      </dl>
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 


</body></html>