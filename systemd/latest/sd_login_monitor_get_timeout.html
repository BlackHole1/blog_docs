<html><head><style data-id="immersive-translate-default-injected-css">:root {
  --immersive-translate-theme-underline-borderColor: #72ece9;
  --immersive-translate-theme-nativeUnderline-borderColor: #72ece9;
  --immersive-translate-theme-nativeDashed-borderColor: #72ece9;
  --immersive-translate-theme-nativeDotted-borderColor: #72ece9;
  --immersive-translate-theme-highlight-backgroundColor: #ffff00;
  --immersive-translate-theme-dashed-borderColor: #59c1bd;
  --immersive-translate-theme-blockquote-borderColor: #cc3355;
  --immersive-translate-theme-thinDashed-borderColor: #ff374f;
  --immersive-translate-theme-dashedBorder-borderColor: #94a3b8;
  --immersive-translate-theme-dashedBorder-borderRadius: 0;
  --immersive-translate-theme-solidBorder-borderColor: #94a3b8;
  --immersive-translate-theme-solidBorder-borderRadius: 0;
  --immersive-translate-theme-dotted-borderColor: #94a3b8;
  --immersive-translate-theme-wavy-borderColor: #72ece9;
  --immersive-translate-theme-dividingLine-borderColor: #94a3b8;
  --immersive-translate-theme-grey-textColor: #2f4f4f;
  --immersive-translate-theme-marker-backgroundColor: #fbda41;
  --immersive-translate-theme-marker-backgroundColor-rgb: 251, 218, 65;
  --immersive-translate-theme-marker2-backgroundColor: #ffff00;
  --immersive-translate-theme-opacity-opacity: 10;
}

.immersive-translate-target-translation-pre-whitespace {
  white-space: pre-wrap !important;
}

.immersive-translate-pdf-target-container {
  position: absolute;
  background-color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
    sans-serif;
  top: 0;
  width: 600px;
  height: 100%;
  z-index: 2;
  line-height: 1.3;
  font-size: 16px;
}
.immersive-translate-target-wrapper[dir='rtl'] {
  text-align: right;
}

.immersive-translate-pdf-target-container .immersive-translate-target-wrapper {
  color: rgb(0, 0, 0);
  white-space: normal;
  position: absolute;
}

.immersive-translate-pdf-target-container .immersive-translate-target-wrapper font {
  color: inherit;
  white-space: inherit;
  position: unset;
}

.immersive-translate-state-dual>br {
  display: none;
}

.immersive-translate-target-translation-block-wrapper {
  margin: 8px 0 !important;
  display: inline-block;
}

.immersive-translate-target-translation-pdf-block-wrapper {
  margin: 0 !important;
  display: block;
}

.immersive-translate-target-translation-theme-grey-inner {
  color: var(--immersive-translate-theme-grey-textColor);
}


.immersive-translate-target-translation-theme-underline-inner {
  border-bottom: 1px solid var(--immersive-translate-theme-underline-borderColor) !important;
}

.immersive-translate-target-translation-theme-nativeUnderline-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeUnderline-borderColor) !important;
}

.immersive-translate-target-translation-block-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

.immersive-translate-target-translation-inline-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
  padding: 2px;
}

.immersive-translate-target-translation-block-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

.immersive-translate-target-translation-inline-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
  padding: 2px;
}

.immersive-translate-target-translation-theme-nativeDashed-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeDashed-borderColor) !important;
  text-decoration-style: dashed !important;
}

.immersive-translate-target-translation-theme-thinDashed-inner {
  border-bottom: 1px dashed var(--immersive-translate-theme-thinDashed-borderColor) !important;
}

.immersive-translate-target-translation-theme-dotted-inner {
  background-image: linear-gradient(to right,
      var(--immersive-translate-theme-dotted-borderColor) 30%,
      rgba(255, 255, 255, 0) 0%);
  background-position: bottom;
  background-size: 5px 1px;
  background-repeat: repeat-x;
  padding-bottom: 3px;
}

.immersive-translate-target-translation-theme-nativeDotted-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeDotted-borderColor) !important;
  text-decoration-style: dotted !important;
}

.immersive-translate-target-translation-theme-wavy-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-wavy-borderColor) !important;
  text-decoration-style: wavy !important;
}

.immersive-translate-target-translation-theme-dashed-inner {
  background: linear-gradient(to right,
      var(--immersive-translate-theme-dashed-borderColor) 0%,
      var(--immersive-translate-theme-dashed-borderColor) 50%,
      transparent 50%,
      transparent 100%) repeat-x left bottom;
  background-size: 8px 2px;
  padding-bottom: 2px;
}

.immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
  content: "";
  display: block;
  max-width: 80px;
  width: 10%;
  border-top: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
  padding-top: 8px;
}

.immersive-translate-target-translation-inline-wrapper-theme-dividingLine::before {
  content: "";
  border-left: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
  max-height: 16px;
  height: 16px;
  padding-left: 8px;
}

.immersive-translate-target-translation-theme-highlight-inner {
  background: var(--immersive-translate-theme-highlight-backgroundColor);
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

.immersive-translate-target-translation-block-wrapper-theme-marker {
  line-height: 1.5em;
}

.immersive-translate-target-translation-theme-marker2-inner {
  font-weight: bold;
  text-shadow: 10px 0px 3px var(--immersive-translate-theme-marker2-backgroundColor),
    16px 3px 9px var(--immersive-translate-theme-marker2-backgroundColor),
    2px 0px 6px var(--immersive-translate-theme-marker2-backgroundColor),
    -12px 0px 12px var(--immersive-translate-theme-marker2-backgroundColor) !important;
}

.immersive-translate-target-translation-theme-marker-inner {
  /* TODO: add more texture */
  background: linear-gradient(to right,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.1),
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 3%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 35%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 70%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.8) 95%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.3));
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

.immersive-translate-target-translation-theme-weakening {
  opacity: 0.618 !important;
}

.immersive-translate-target-translation-theme-italic {
  font-style: italic !important;
}

.immersive-translate-target-translation-theme-bold {
  font-weight: bold !important;
}

.immersive-translate-target-translation-block-wrapper-theme-paper {
  margin: 8px 0;
  box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
  padding: 16px 32px;
  display: block;
}

.immersive-translate-target-translation-block-wrapper-theme-blockquote {
  border-left: 4px solid var(--immersive-translate-theme-blockquote-borderColor) !important;
  padding-left: 12px !important;
  margin-top: 4px;
  margin-bottom: 4px;
  padding-top: 4px;
  padding-bottom: 4px;
  display: block;
}

.immersive-translate-target-translation-theme-mask-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-mask-inner {
  filter: none !important;
}

[data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}


/* opacity theme start */

.immersive-translate-target-translation-theme-opacity-inner {
  filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-opacity-inner {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner,.immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

.immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: none !important;
}


.immersive-translate-target-translation-theme-mask-inner:hover {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner:hover {
  filter: none !important;
}


[data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner:hover {
  filter: none !important;
}

/* opacity theme end */

/* vertical css , please remain it in the last one. */
.immersive-translate-target-translation-vertical-block-wrapper {
  margin: 0px 8px !important;
}

.immersive-translate-text {
  font-size: 15px !important;
}

.immersive-translate-error-toast {
  position: fixed;
  top: 5%;
  z-index: 99999999;
  left: 0;
  right: 0;
  margin: auto;
  max-width: 300px;
  padding: 16px;
  border-radius: 12px;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  flex-direction: row;
  justify-content: space-between;
}

@media all and (min-width: 750px) {
  .immersive-translate-error-toast {
    max-width: 400px;
  }
}


.immersive-translate-clickable-button {
  cursor: pointer;
}

.immersive-translate-help-button {
  cursor: pointer;
}

.immersive-translate-loading-text:before {
  content: "...";
}


/* dark mode for loading */

@media only screen and (prefers-color-scheme: dark) {
  .immersive-translate-loading {
    border: 2px rgba(255, 255, 255, 0.25) solid !important;
    border-top: 2px rgba(255, 255, 255, 1) solid !important;
  }
}

.immersive-translate-error-wrapper {
  position: relative;
  display: inline-flex;
  padding: 6px;
  margin: 0 12px;
  white-space: nowrap;
  font-size: 0.9em;
}
[lang="zh-CN"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}
[lang="zh-TW"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}


.immersive-translate-tooltip {
  position: relative;
  display: inline-flex;
  /* little indicater to indicate it's hoverable */
}

.immersive-translate-tooltip-content {
  /* here's the magic */
  position: absolute;
  z-index: 100000000000;

  left: 50%;
  bottom: 0;
  transform: translate(-50%, 110%);
  line-height: 1;
  /* and add a small left margin */

  /* basic styles */
  width: max-content;
  max-width: 250px;
  word-wrap: break-word;
  white-space: pre-line;
  padding: 10px;
  border-radius: 10px;
  background: #000C;
  color: #fff;
  text-align: center;
  font-size: 14px;
  display: none;
  /* hide by default */
}

.immersive-translate-tooltip:hover .immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip:hover+.immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip-content-table {
  left: unset !important;
  bottom: unset !important;
  transform: translate(-10%, 50%) !important;
}


.immersive-translate-tooltip:hover:before {
  display: block;
}



.immersive-translate-loading-spinner {
  vertical-align: middle !important;
  width: 10px !important;
  height: 10px !important;
  display: inline-block !important;
  margin: 0 4px !important;
  border: 2px rgba(221, 244, 255, 0.6) solid !important;
  border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-radius: 50% !important;
  padding: 0 !important;
  -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
  animation: immersive-translate-loading-animation 0.6s infinite linear !important;
}

@-webkit-keyframes immersive-translate-loading-animation {
  from {
    -webkit-transform: rotate(0deg);
  }

  to {
    -webkit-transform: rotate(359deg);
  }
}

@keyframes immersive-translate-loading-animation {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(359deg);
  }
}
</style><style data-id="immersive-translate-user-custom-style">:root {

.immersive-translate-target-inner { font-family: inherit; }
}
</style><style data-id="immersive-translate-dynamic-injected-css">.immersive-translate-target-wrapper[dir='rtl'] {text-align: right;}
.immersive-translate-target-wrapper[dir='rtl'] [data-immersive-translate-class-bak*='block-wrapper'] {display:block;}
.immersive-translate-target-wrapper {word-break: break-word;}
</style></head><body data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>sd_login_monitor_new</title><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><script src="https://code.jquery.com/jquery-3.7.1.min.js"></script><script src="../nav.js"></script><style>
    a.headerlink {
      color: #c60f0f;
      font-size: 0.8em;
      padding: 0 4px 0 4px;
      text-decoration: none;
      visibility: hidden;
    }

    a.headerlink:hover {
      background-color: #c60f0f;
      color: white;
    }

    h1:hover > a.headerlink, h2:hover > a.headerlink, h3:hover > a.headerlink, dt:hover > a.headerlink {
      visibility: visible;
    }
  </style><a href="index.html" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">Index </a>·
  <a href="systemd.directives.html" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">Directives </a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">索引 · 指令</font></font></font><span style="float:right" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">systemd 255</span><hr><div class="refentry" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><a name="sd_login_monitor_new" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"></a><div class="titlepage" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"></div><div class="refnamediv" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><h2 data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">Name<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">名称</font></font></font></h2><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">sd_login_monitor_new, sd_login_monitor_unref, sd_login_monitor_unrefp, sd_login_monitor_flush, sd_login_monitor_get_fd, sd_login_monitor_get_events, sd_login_monitor_get_timeout, sd_login_monitor — Monitor login sessions, seats, users and virtual machines/containers<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">sd_login_monitor_new, sd_login_monitor_unref, sd_login_monitor_unrefp, sd_login_monitor_flush, sd_login_monitor_get_fd, sd_login_monitor_get_events, sd_login_monitor_get_timeout, sd_login_monitor — 监控登录会话、座位、用户和虚拟机/容器</font></font></font></p></div><div class="refsynopsisdiv" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><h2 data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">Synopsis<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">简介</font></font></font></h2><div class="funcsynopsis"><pre class="funcsynopsisinfo">#include &lt;systemd/sd-login.h&gt;</pre><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">int <b class="fsfunc">sd_login_monitor_new</b>(</code></td><td>const char *<var class="pdparam">category</var>, </td></tr><tr><td>&nbsp;</td><td>sd_login_monitor **<var class="pdparam">ret</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">sd_login_monitor *<b class="fsfunc">sd_login_monitor_unref</b>(</code></td><td>sd_login_monitor *<var class="pdparam">m</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">void <b class="fsfunc">sd_login_monitor_unrefp</b>(</code></td><td>sd_login_monitor **<var class="pdparam">m</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">int <b class="fsfunc">sd_login_monitor_flush</b>(</code></td><td>sd_login_monitor *<var class="pdparam">m</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">int <b class="fsfunc">sd_login_monitor_get_fd</b>(</code></td><td>sd_login_monitor *<var class="pdparam">m</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">int <b class="fsfunc">sd_login_monitor_get_events</b>(</code></td><td>sd_login_monitor *<var class="pdparam">m</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">int <b class="fsfunc">sd_login_monitor_get_timeout</b>(</code></td><td>sd_login_monitor *<var class="pdparam">m</var>, </td></tr><tr><td>&nbsp;</td><td>uint64_t *<var class="pdparam">timeout_usec</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div></div></div><div class="refsect1" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><a name="id-1.5" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"></a><h2 id="Description" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">Description<a class="headerlink" title="Permalink to this headline" href="#Description" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">¶</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">描述</font></font></font></h2><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_new()</code> may be used to
    monitor login sessions, users, seats, and virtual
    machines/containers. Via a monitor object a file descriptor can be
    integrated into an application defined event loop which is woken
    up each time a user logs in, logs out or a seat is added or
    removed, or a session, user, seat or virtual machine/container
    changes state otherwise. The first parameter takes a string which
    can be "<code class="literal" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">seat</code>" (to get only notifications about
    seats being added, removed or changed), "<code class="literal" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">session</code>"
    (to get only notifications about sessions being created or removed
    or changed), "<code class="literal" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">uid</code>" (to get only notifications
    when a user changes state in respect to logins) or
    "<code class="literal" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">machine</code>" (to get only notifications when a
    virtual machine or container is started or stopped). If
    notifications shall be generated in all these conditions,
    <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">NULL</code> may be passed. Note that in the future
    additional categories may be defined. The second parameter returns
    a monitor object and needs to be freed with the
    <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unref()</code> call after
    use.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_new()</code> 可用于监视登录会话、用户、座位和虚拟机/容器。通过监视对象，可以将文件描述符集成到应用程序定义的事件循环中，每当用户登录、注销或添加或删除座位，或会话、用户、座位或虚拟机/容器更改状态时，事件循环就会被唤醒。第一个参数接受一个字符串，可以是 " <code class="literal" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">seat</code> "（仅获取有关添加、删除或更改座位的通知），" <code class="literal" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">session</code> "（仅获取有关创建、删除或更改会话的通知），" <code class="literal" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">uid</code> "（仅在用户在登录方面更改状态时获取通知）或" <code class="literal" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">machine</code> "（仅在启动或停止虚拟机或容器时获取通知）。如果要在所有这些情况下生成通知，可以传递 <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">NULL</code> 。请注意，将来可能会定义其他类别。第二个参数返回一个监视对象，并在使用后需要使用 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unref()</code> 调用释放。</font></font></font></p><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unref()</code> may be used to
    destroy a monitor object. Note that this will invalidate any file
    descriptor returned by
    <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_fd()</code>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unref()</code> 可用于销毁监视对象。请注意，这将使 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_fd()</code> 返回的任何文件描述符无效。</font></font></font></p><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unrefp()</code> is similar to
    <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unref()</code> but takes a pointer
    to a pointer to an <span class="type" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor</span> object. This call
    is useful in conjunction with GCC's and LLVM's <a class="ulink" href="https://gcc.gnu.org/onlinedocs/gcc/Common-Variable-Attributes.html" target="_top" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">Clean-up
    Variable Attribute</a>. Note that this function is defined as
    inline function. Use a declaration like the following, in order to
    allocate a login monitor object that is freed automatically as the
    code block is left:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unrefp()</code> 类似于 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unref()</code> ，但接受一个指向 sd_login_monitor 对象的指针。这个调用与 GCC 和 LLVM 的 Clean-up Variable Attribute 结合使用很有用。请注意，此函数被定义为内联函数。使用以下声明，以便在离开代码块时自动释放一个登录监视器对象：</font></font></font></p><pre class="programlisting">{
  __attribute__((cleanup(sd_login_monitor_unrefp))) sd_login_monitor *m = NULL;
  int r;
  …
  r = sd_login_monitor_new(NULL, &amp;m);
  if (r &lt; 0) {
    errno = -r;
    fprintf(stderr, "Failed to allocate login monitor object: %m\n");
  }
  …
}</pre><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_flush()</code> may be used to
    reset the wakeup state of the monitor object. Whenever an event
    causes the monitor to wake up the event loop via the file
    descriptor this function needs to be called to reset the wake-up
    state. If this call is not invoked, the file descriptor will
    immediately wake up the event loop again.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_flush()</code> 可用于重置监视器对象的唤醒状态。每当事件导致监视器通过文件描述符唤醒事件循环时，需要调用此函数来重置唤醒状态。如果不调用此函数，文件描述符将立即再次唤醒事件循环。</font></font></font></p><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unref()</code> and
    <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unrefp()</code> execute no
    operation if the passed in monitor object is
    <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">NULL</code>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果传入的监视器对象是 <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">NULL</code> ， <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unref()</code> 和 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unrefp()</code> 将不执行任何操作。</font></font></font></p><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_fd()</code> may be used
    to retrieve the file descriptor of the monitor object that may be
    integrated in an application defined event loop, based around
    <a href="https://man7.org/linux/man-pages/man2/poll.2.html" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="citerefentry" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="refentrytitle" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">poll</span>(2)</span></a>
    or a similar interface. The application should include the
    returned file descriptor as wake-up source for the events mask
    returned by <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_events()</code>. It
    should pass a timeout value as returned by
    <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_timeout()</code>. Whenever a
    wake-up is triggered the file descriptor needs to be reset via
    <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_flush()</code>. An application
    needs to reread the login state with a function like
    <a href="sd_get_seats.html#" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="citerefentry" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="refentrytitle" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_get_seats</span>(3)</span></a>
    or similar to determine what changed.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_fd()</code> 可用于检索监视对象的文件描述符，该对象可以集成在应用程序定义的事件循环中，基于 poll(2) 或类似接口。应用程序应将返回的文件描述符包括为由 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_events()</code> 返回的事件掩码的唤醒源。它应传递由 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_timeout()</code> 返回的超时值。每当触发唤醒时，需要通过 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_flush()</code> 重置文件描述符。应用程序需要使用类似 sd_get_seats(3) 的函数重新读取登录状态，以确定发生了什么变化。</font></font></font></p><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_events()</code> will
    return the <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">poll()</code> mask to wait for. This
    function will return a combination of <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">POLLIN</code>,
    <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">POLLOUT</code> and similar to fill into the
    "<code class="literal" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">.events</code>" field of <code class="varname" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">struct
    pollfd</code>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_events()</code> 将返回等待的 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">poll()</code> 掩码。此函数将返回一组 <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">POLLIN</code> 、 <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">POLLOUT</code> 等类似内容，填入 <code class="varname" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">struct
    pollfd</code> 的字段中。</font></font></font></p><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_timeout()</code> will
    return a timeout value for usage in <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">poll()</code>.
    This returns a value in microseconds since the epoch of
    <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">CLOCK_MONOTONIC</code> for timing out
    <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">poll()</code> in <code class="varname" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">timeout_usec</code>.
    See
    <a href="https://man7.org/linux/man-pages/man2/clock_gettime.2.html" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="citerefentry" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="refentrytitle" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">clock_gettime</span>(2)</span></a>
    for details about <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">CLOCK_MONOTONIC</code>. If there
    is no timeout to wait for this will fill in <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">(uint64_t)
    -1</code> instead. Note that <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">poll()</code> takes
    a relative timeout in milliseconds rather than an absolute timeout
    in microseconds. To convert the absolute 'μs' timeout into
    relative 'ms', use code like the following:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_timeout()</code> 将返回用于在 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">poll()</code> 中使用的超时值。这将返回自 <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">CLOCK_MONOTONIC</code> 时代以来的微秒值，用于在 <code class="varname" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">timeout_usec</code> 中计时 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">poll()</code> 的超时。有关 <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">CLOCK_MONOTONIC</code> 的详细信息，请参阅 clock_gettime(2) 。如果没有要等待的超时，将填入 <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">(uint64_t)
    -1</code> 。请注意， <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">poll()</code> 接受相对于毫秒的相对超时，而不是微秒的绝对超时。要将绝对的“μs”超时转换为相对的“ms”，请使用以下代码：</font></font></font></p><pre class="programlisting">uint64_t t;
int msec;
sd_login_monitor_get_timeout(m, &amp;t);
if (t == (uint64_t) -1)
  msec = -1;
else {
  struct timespec ts;
  uint64_t n;
  clock_gettime(CLOCK_MONOTONIC, &amp;ts);
  n = (uint64_t) ts.tv_sec * 1000000 + ts.tv_nsec / 1000;
  msec = t &gt; n ? (int) ((t - n + 999) / 1000) : 0;
}</pre><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">The code above does not do any error checking for brevity's
    sake. The calculated <code class="varname" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">msec</code> integer can be passed
    directly as <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">poll()</code>'s timeout
    parameter.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">为简洁起见，上述代码没有进行任何错误检查。计算出的 <code class="varname" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">msec</code> 整数可以直接作为 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">poll()</code> 的超时参数传递。</font></font></font></p></div><div class="refsect1" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><a name="id-1.6" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"></a><h2 id="Return Value" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">Return Value<a class="headerlink" title="Permalink to this headline" href="#Return%20Value" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">¶</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回值 ¶</font></font></font></h2><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">On success,
    <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_new()</code>,
    <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_flush()</code> and
    <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_timeout()</code>
    return 0 or a positive integer. On success,
    <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_fd()</code> returns
    a Unix file descriptor. On success,
    <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_events()</code>
    returns a combination of <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">POLLIN</code>,
    <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">POLLOUT</code> and suchlike. On failure,
    these calls return a negative errno-style error
    code.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在成功时， <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_new()</code> ， <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_flush()</code> 和 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_timeout()</code> 返回 0 或正整数。在成功时， <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_fd()</code> 返回 Unix 文件描述符。在成功时， <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_events()</code> 返回 <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">POLLIN</code> ， <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">POLLOUT</code> 等的组合。在失败时，这些调用返回负的 errno 风格的错误代码。</font></font></font></p><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unref()</code>
    always returns <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">NULL</code>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unref()</code> 总是返回 <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">NULL</code> 。</font></font></font></p><div class="refsect2" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><a name="id-1.6.4" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"></a><h3 id="Errors" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">Errors<a class="headerlink" title="Permalink to this headline" href="#Errors" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">¶</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">错误 ¶</font></font></font></h3><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">Returned errors may indicate the following problems:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回的错误可能表示以下问题：</font></font></font></p><div class="variablelist" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><dl class="variablelist" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><dt id="-EINVAL" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><span class="term" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">-EINVAL</code></span><a class="headerlink" title="Permalink to this term" href="#-EINVAL" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">¶</a></dt><dd data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">An input parameter was invalid (out of range, or <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">NULL</code>, where
          that is not accepted). The specified category to watch is not known.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">输入参数无效（超出范围，或 <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">NULL</code> ，其中不被接受）。要监视的指定类别未知。</font></font></font></p></dd><dt id="-ENOMEM" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><span class="term" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">-ENOMEM</code></span><a class="headerlink" title="Permalink to this term" href="#-ENOMEM" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">¶</a></dt><dd data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">Memory allocation failed.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">内存分配失败。</font></font></font></p></dd></dl></div></div></div><div class="refsect1" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><a name="id-1.7" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"></a><h2 id="Notes" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">Notes<a class="headerlink" title="Permalink to this headline" href="#Notes" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">¶</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">注意事项 ¶</font></font></font></h2><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><a name="pkgconfig-text" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"></a>Functions described here are available as a shared
  library, which can be compiled against and linked to with the
  <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">libsystemd</code>&nbsp;<a href="http://linux.die.net/man/1/pkg-config" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="citerefentry" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="refentrytitle" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">pkg-config</span>(1)</span></a>
  file.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此处描述的函数可作为共享库使用，可以通过 <code class="constant" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">libsystemd</code> pkg-config(1) 文件进行编译和链接。</font></font></font></p><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><a name="getenv" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"></a>The code described here uses
<a href="https://man7.org/linux/man-pages/man3/getenv.3.html" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="citerefentry" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="refentrytitle" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">getenv</span>(3)</span></a>,
which is declared to be not multi-thread-safe. This means that the code calling the functions described
here must not call
<a href="https://man7.org/linux/man-pages/man3/setenv.3.html" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="citerefentry" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="refentrytitle" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">setenv</span>(3)</span></a>
from a parallel thread. It is recommended to only do calls to <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">setenv()</code>
from an early phase of the program when no other threads have been started.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此处描述的代码使用了 getenv(3)，该函数被声明为非多线程安全。这意味着调用此处描述的函数的代码不能从并行线程中调用 setenv(3)。建议仅在程序的早期阶段进行对 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">setenv()</code> 的调用，此时尚未启动其他线程。</font></font></font></p></div><div class="refsect1" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><a name="id-1.8" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"></a><h2 id="History" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">History<a class="headerlink" title="Permalink to this headline" href="#History" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">¶</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">历史 ¶</font></font></font></h2><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_events()</code> and
    <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_timeout()</code> were added in version 201.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_events()</code> 和 <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_get_timeout()</code> 在版本 201 中添加。</font></font></font></p><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unrefp()</code> was added in version 229.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_login_monitor_unrefp()</code> 在版本 229 中添加。</font></font></font></p></div><div class="refsect1" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><a name="id-1.9" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"></a><h2 id="See Also" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">See Also<a class="headerlink" title="Permalink to this headline" href="#See%20Also" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">¶</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">参见 ¶</font></font></font></h2><p data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d" data-immersive-translate-paragraph="1">
      <a href="systemd.html#" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="citerefentry" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="refentrytitle" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">systemd</span>(1)</span></a>,
      <a href="sd-login.html#" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="citerefentry" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="refentrytitle" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd-login</span>(3)</span></a>,
      <a href="sd_get_seats.html#" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="citerefentry" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="refentrytitle" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">sd_get_seats</span>(3)</span></a>,
      <a href="https://man7.org/linux/man-pages/man2/poll.2.html" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="citerefentry" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="refentrytitle" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">poll</span>(2)</span></a>,
      <a href="https://man7.org/linux/man-pages/man2/clock_gettime.2.html" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="citerefentry" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d"><span class="refentrytitle" data-immersive-translate-walked="12526d12-d470-4459-92cc-48e848a34c5d">clock_gettime</span>(2)</span></a>
    </p></div></div>
</body></html>