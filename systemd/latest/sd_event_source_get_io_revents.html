<html><head><style data-id="immersive-translate-default-injected-css">:root {
  --immersive-translate-theme-underline-borderColor: #72ece9;
  --immersive-translate-theme-nativeUnderline-borderColor: #72ece9;
  --immersive-translate-theme-nativeDashed-borderColor: #72ece9;
  --immersive-translate-theme-nativeDotted-borderColor: #72ece9;
  --immersive-translate-theme-highlight-backgroundColor: #ffff00;
  --immersive-translate-theme-dashed-borderColor: #59c1bd;
  --immersive-translate-theme-blockquote-borderColor: #cc3355;
  --immersive-translate-theme-thinDashed-borderColor: #ff374f;
  --immersive-translate-theme-dashedBorder-borderColor: #94a3b8;
  --immersive-translate-theme-dashedBorder-borderRadius: 0;
  --immersive-translate-theme-solidBorder-borderColor: #94a3b8;
  --immersive-translate-theme-solidBorder-borderRadius: 0;
  --immersive-translate-theme-dotted-borderColor: #94a3b8;
  --immersive-translate-theme-wavy-borderColor: #72ece9;
  --immersive-translate-theme-dividingLine-borderColor: #94a3b8;
  --immersive-translate-theme-grey-textColor: #2f4f4f;
  --immersive-translate-theme-marker-backgroundColor: #fbda41;
  --immersive-translate-theme-marker-backgroundColor-rgb: 251, 218, 65;
  --immersive-translate-theme-marker2-backgroundColor: #ffff00;
  --immersive-translate-theme-opacity-opacity: 10;
}

.immersive-translate-target-translation-pre-whitespace {
  white-space: pre-wrap !important;
}

.immersive-translate-pdf-target-container {
  position: absolute;
  background-color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
    sans-serif;
  top: 0;
  width: 600px;
  height: 100%;
  z-index: 2;
  line-height: 1.3;
  font-size: 16px;
}
.immersive-translate-target-wrapper[dir='rtl'] {
  text-align: right;
}

.immersive-translate-pdf-target-container .immersive-translate-target-wrapper {
  color: rgb(0, 0, 0);
  white-space: normal;
  position: absolute;
}

.immersive-translate-pdf-target-container .immersive-translate-target-wrapper font {
  color: inherit;
  white-space: inherit;
  position: unset;
}

.immersive-translate-state-dual>br {
  display: none;
}

.immersive-translate-target-translation-block-wrapper {
  margin: 8px 0 !important;
  display: inline-block;
}

.immersive-translate-target-translation-pdf-block-wrapper {
  margin: 0 !important;
  display: block;
}

.immersive-translate-target-translation-theme-grey-inner {
  color: var(--immersive-translate-theme-grey-textColor);
}


.immersive-translate-target-translation-theme-underline-inner {
  border-bottom: 1px solid var(--immersive-translate-theme-underline-borderColor) !important;
}

.immersive-translate-target-translation-theme-nativeUnderline-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeUnderline-borderColor) !important;
}

.immersive-translate-target-translation-block-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

.immersive-translate-target-translation-inline-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
  padding: 2px;
}

.immersive-translate-target-translation-block-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

.immersive-translate-target-translation-inline-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
  padding: 2px;
}

.immersive-translate-target-translation-theme-nativeDashed-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeDashed-borderColor) !important;
  text-decoration-style: dashed !important;
}

.immersive-translate-target-translation-theme-thinDashed-inner {
  border-bottom: 1px dashed var(--immersive-translate-theme-thinDashed-borderColor) !important;
}

.immersive-translate-target-translation-theme-dotted-inner {
  background-image: linear-gradient(to right,
      var(--immersive-translate-theme-dotted-borderColor) 30%,
      rgba(255, 255, 255, 0) 0%);
  background-position: bottom;
  background-size: 5px 1px;
  background-repeat: repeat-x;
  padding-bottom: 3px;
}

.immersive-translate-target-translation-theme-nativeDotted-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-nativeDotted-borderColor) !important;
  text-decoration-style: dotted !important;
}

.immersive-translate-target-translation-theme-wavy-inner {
  text-decoration: underline !important;
  text-decoration-color: var(--immersive-translate-theme-wavy-borderColor) !important;
  text-decoration-style: wavy !important;
}

.immersive-translate-target-translation-theme-dashed-inner {
  background: linear-gradient(to right,
      var(--immersive-translate-theme-dashed-borderColor) 0%,
      var(--immersive-translate-theme-dashed-borderColor) 50%,
      transparent 50%,
      transparent 100%) repeat-x left bottom;
  background-size: 8px 2px;
  padding-bottom: 2px;
}

.immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
  content: "";
  display: block;
  max-width: 80px;
  width: 10%;
  border-top: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
  padding-top: 8px;
}

.immersive-translate-target-translation-inline-wrapper-theme-dividingLine::before {
  content: "";
  border-left: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
  max-height: 16px;
  height: 16px;
  padding-left: 8px;
}

.immersive-translate-target-translation-theme-highlight-inner {
  background: var(--immersive-translate-theme-highlight-backgroundColor);
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

.immersive-translate-target-translation-block-wrapper-theme-marker {
  line-height: 1.5em;
}

.immersive-translate-target-translation-theme-marker2-inner {
  font-weight: bold;
  text-shadow: 10px 0px 3px var(--immersive-translate-theme-marker2-backgroundColor),
    16px 3px 9px var(--immersive-translate-theme-marker2-backgroundColor),
    2px 0px 6px var(--immersive-translate-theme-marker2-backgroundColor),
    -12px 0px 12px var(--immersive-translate-theme-marker2-backgroundColor) !important;
}

.immersive-translate-target-translation-theme-marker-inner {
  /* TODO: add more texture */
  background: linear-gradient(to right,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.1),
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 3%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 35%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 70%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.8) 95%,
      rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.3));
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

.immersive-translate-target-translation-theme-weakening {
  opacity: 0.618 !important;
}

.immersive-translate-target-translation-theme-italic {
  font-style: italic !important;
}

.immersive-translate-target-translation-theme-bold {
  font-weight: bold !important;
}

.immersive-translate-target-translation-block-wrapper-theme-paper {
  margin: 8px 0;
  box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
  padding: 16px 32px;
  display: block;
}

.immersive-translate-target-translation-block-wrapper-theme-blockquote {
  border-left: 4px solid var(--immersive-translate-theme-blockquote-borderColor) !important;
  padding-left: 12px !important;
  margin-top: 4px;
  margin-bottom: 4px;
  padding-top: 4px;
  padding-bottom: 4px;
  display: block;
}

.immersive-translate-target-translation-theme-mask-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-mask-inner {
  filter: none !important;
}

[data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}


/* opacity theme start */

.immersive-translate-target-translation-theme-opacity-inner {
  filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-opacity-inner {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner,.immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

.immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: none !important;
}


.immersive-translate-target-translation-theme-mask-inner:hover {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner:hover {
  filter: none !important;
}


[data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner:hover {
  filter: none !important;
}

/* opacity theme end */

/* vertical css , please remain it in the last one. */
.immersive-translate-target-translation-vertical-block-wrapper {
  margin: 0px 8px !important;
}

.immersive-translate-text {
  font-size: 15px !important;
}

.immersive-translate-error-toast {
  position: fixed;
  top: 5%;
  z-index: 99999999;
  left: 0;
  right: 0;
  margin: auto;
  max-width: 300px;
  padding: 16px;
  border-radius: 12px;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  flex-direction: row;
  justify-content: space-between;
}

@media all and (min-width: 750px) {
  .immersive-translate-error-toast {
    max-width: 400px;
  }
}


.immersive-translate-clickable-button {
  cursor: pointer;
}

.immersive-translate-help-button {
  cursor: pointer;
}

.immersive-translate-loading-text:before {
  content: "...";
}


/* dark mode for loading */

@media only screen and (prefers-color-scheme: dark) {
  .immersive-translate-loading {
    border: 2px rgba(255, 255, 255, 0.25) solid !important;
    border-top: 2px rgba(255, 255, 255, 1) solid !important;
  }
}

.immersive-translate-error-wrapper {
  position: relative;
  display: inline-flex;
  padding: 6px;
  margin: 0 12px;
  white-space: nowrap;
  font-size: 0.9em;
}
[lang="zh-CN"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}
[lang="zh-TW"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}


.immersive-translate-tooltip {
  position: relative;
  display: inline-flex;
  /* little indicater to indicate it's hoverable */
}

.immersive-translate-tooltip-content {
  /* here's the magic */
  position: absolute;
  z-index: 100000000000;

  left: 50%;
  bottom: 0;
  transform: translate(-50%, 110%);
  line-height: 1;
  /* and add a small left margin */

  /* basic styles */
  width: max-content;
  max-width: 250px;
  word-wrap: break-word;
  white-space: pre-line;
  padding: 10px;
  border-radius: 10px;
  background: #000C;
  color: #fff;
  text-align: center;
  font-size: 14px;
  display: none;
  /* hide by default */
}

.immersive-translate-tooltip:hover .immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip:hover+.immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip-content-table {
  left: unset !important;
  bottom: unset !important;
  transform: translate(-10%, 50%) !important;
}


.immersive-translate-tooltip:hover:before {
  display: block;
}



.immersive-translate-loading-spinner {
  vertical-align: middle !important;
  width: 10px !important;
  height: 10px !important;
  display: inline-block !important;
  margin: 0 4px !important;
  border: 2px rgba(221, 244, 255, 0.6) solid !important;
  border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-radius: 50% !important;
  padding: 0 !important;
  -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
  animation: immersive-translate-loading-animation 0.6s infinite linear !important;
}

@-webkit-keyframes immersive-translate-loading-animation {
  from {
    -webkit-transform: rotate(0deg);
  }

  to {
    -webkit-transform: rotate(359deg);
  }
}

@keyframes immersive-translate-loading-animation {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(359deg);
  }
}
</style><style data-id="immersive-translate-user-custom-style">:root {

.immersive-translate-target-inner { font-family: inherit; }
}
</style><style data-id="immersive-translate-dynamic-injected-css">.immersive-translate-target-wrapper[dir='rtl'] {text-align: right;}
.immersive-translate-target-wrapper[dir='rtl'] [data-immersive-translate-class-bak*='block-wrapper'] {display:block;}
.immersive-translate-target-wrapper {word-break: break-word;}
</style></head><body data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>sd_event_add_io</title><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><script src="https://code.jquery.com/jquery-3.7.1.min.js"></script><script src="../nav.js"></script><style>
    a.headerlink {
      color: #c60f0f;
      font-size: 0.8em;
      padding: 0 4px 0 4px;
      text-decoration: none;
      visibility: hidden;
    }

    a.headerlink:hover {
      background-color: #c60f0f;
      color: white;
    }

    h1:hover > a.headerlink, h2:hover > a.headerlink, h3:hover > a.headerlink, dt:hover > a.headerlink {
      visibility: visible;
    }
  </style><a href="index.html" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">Index </a>·
  <a href="systemd.directives.html" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">Directives </a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">索引 · 指令</font></font></font><span style="float:right" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">systemd 255</span><hr><div class="refentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><a name="sd_event_add_io" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"></a><div class="titlepage" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"></div><div class="refnamediv" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><h2 data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">Name<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">名称</font></font></font></h2><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">sd_event_add_io, sd_event_source_get_io_events, sd_event_source_set_io_events, sd_event_source_get_io_revents, sd_event_source_get_io_fd, sd_event_source_set_io_fd, sd_event_source_get_io_fd_own, sd_event_source_set_io_fd_own, sd_event_source, sd_event_io_handler_t — Add an I/O event source to an event loop<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">sd_event_add_io, sd_event_source_get_io_events, sd_event_source_set_io_events, sd_event_source_get_io_revents, sd_event_source_get_io_fd, sd_event_source_set_io_fd, sd_event_source_get_io_fd_own, sd_event_source_set_io_fd_own, sd_event_source, sd_event_io_handler_t — 将 I/O 事件源添加到事件循环</font></font></font></p></div><div class="refsynopsisdiv" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><h2 data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">Synopsis<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">简介</font></font></font></h2><div class="funcsynopsis"><pre class="funcsynopsisinfo">#include &lt;systemd/sd-event.h&gt;</pre><pre class="funcsynopsisinfo"><span class="token">typedef</span> struct sd_event_source sd_event_source;</pre><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">typedef int (*<b class="fsfunc">sd_event_io_handler_t</b>)(</code></td><td>sd_event_source *<var class="pdparam">s</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">fd</var>, </td></tr><tr><td>&nbsp;</td><td>uint32_t <var class="pdparam">revents</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">userdata</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">int <b class="fsfunc">sd_event_add_io</b>(</code></td><td>sd_event *<var class="pdparam">event</var>, </td></tr><tr><td>&nbsp;</td><td>sd_event_source **<var class="pdparam">source</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">fd</var>, </td></tr><tr><td>&nbsp;</td><td>uint32_t <var class="pdparam">events</var>, </td></tr><tr><td>&nbsp;</td><td>sd_event_io_handler_t <var class="pdparam">handler</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">userdata</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">int <b class="fsfunc">sd_event_source_get_io_events</b>(</code></td><td>sd_event_source *<var class="pdparam">source</var>, </td></tr><tr><td>&nbsp;</td><td>uint32_t *<var class="pdparam">events</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">int <b class="fsfunc">sd_event_source_set_io_events</b>(</code></td><td>sd_event_source *<var class="pdparam">source</var>, </td></tr><tr><td>&nbsp;</td><td>uint32_t <var class="pdparam">events</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">int <b class="fsfunc">sd_event_source_get_io_revents</b>(</code></td><td>sd_event_source *<var class="pdparam">source</var>, </td></tr><tr><td>&nbsp;</td><td>uint32_t *<var class="pdparam">revents</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">int <b class="fsfunc">sd_event_source_get_io_fd</b>(</code></td><td>sd_event_source *<var class="pdparam">source</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">int <b class="fsfunc">sd_event_source_set_io_fd</b>(</code></td><td>sd_event_source *<var class="pdparam">source</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">fd</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">int <b class="fsfunc">sd_event_source_get_io_fd_own</b>(</code></td><td>sd_event_source *<var class="pdparam">source</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tbody><tr><td><code class="funcdef">int <b class="fsfunc">sd_event_source_set_io_fd_own</b>(</code></td><td>sd_event_source *<var class="pdparam">source</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">b</var><code>)</code>;</td></tr></tbody></table><div class="funcprototype-spacer">&nbsp;</div></div></div><div class="refsect1" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><a name="id-1.5" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"></a><h2 id="Description" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">Description<a class="headerlink" title="Permalink to this headline" href="#Description" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">¶</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">描述</font></font></font></h2><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> adds a new I/O event source to an event loop. The event loop
    object is specified in the <em class="parameter" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">event</code></em> parameter, the event source object is returned in
    the <em class="parameter" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">source</code></em> parameter. The <em class="parameter" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">fd</code></em> parameter takes the UNIX file
    descriptor to watch, which may refer to a socket, a FIFO, a message queue, a serial connection, a
    character device, or any other file descriptor compatible with Linux <a href="https://man7.org/linux/man-pages/man7/epoll.7.html" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">epoll</span>(7)</span></a>. The
    <em class="parameter" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">events</code></em> parameter takes a bit mask of events to watch for, a combination of the
    following event flags: <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLIN</code>, <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLOUT</code>,
    <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLRDHUP</code>, <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLPRI</code>, and <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLET</code>, see
    <a href="https://man7.org/linux/man-pages/man2/epoll_ctl.2.html" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">epoll_ctl</span>(2)</span></a> for
    details. Note that not all file descriptors are compatible with epoll, for example regular file or
    directories are not. If this function is called with a file descriptor that does not support epoll,
    <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">-EPERM</code> is returned (also see below). In most cases such file descriptors may be
    treated as always-readable or always-writable, so that IO event watching is unnecessary.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> 向事件循环添加了一个新的 I/O 事件源。事件循环对象在 <code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">event</code> 参数中指定，事件源对象在 <code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">source</code> 参数中返回。 <code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">fd</code> 参数接受要监视的 UNIX 文件描述符，可以是套接字、FIFO、消息队列、串行连接、字符设备或与 Linux epoll(7)兼容的任何其他文件描述符。 <code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">events</code> 参数接受要监视的事件位掩码，是以下事件标志的组合： <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLIN</code> 、 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLOUT</code> 、 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLRDHUP</code> 、 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLPRI</code> 和 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLET</code> ，详细信息请参阅 epoll_ctl(2)。请注意，并非所有文件描述符都与 epoll 兼容，例如常规文件或目录不兼容。如果使用不支持 epoll 的文件描述符调用此函数，则返回 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">-EPERM</code> （另请参阅下文）。在大多数情况下，这些文件描述符可能被视为始终可读或始终可写，因此不需要进行 I/O 事件监视。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">The <em class="parameter" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">handler</code></em> is a function to call when the event source is triggered or
    <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">NULL</code>. The <em class="parameter" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">userdata</code></em> pointer will be passed to the handler
    function, and may be chosen freely by the caller. The handler will also be passed the file descriptor the
    event was seen on, as well as the actual event flags. It's generally a subset of the events watched,
    however may additionally include <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLERR</code> and <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLHUP</code>. The
    handler may return negative to signal an error (see below), other return values are ignored. If
    <em class="parameter" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">handler</code></em> is <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">NULL</code>, a default handler that calls
    <a href="sd_event_exit.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_exit</span>(3)</span></a> will be
    used.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当事件源被触发或 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">NULL</code> 时， <code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">handler</code> 是要调用的函数。指针 <code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">userdata</code> 将传递给处理程序函数，并可以由调用者自由选择。处理程序还将传递事件发生的文件描述符，以及实际的事件标志。通常是被监视的事件的子集，但也可能包括 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLERR</code> 和 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLHUP</code> 。处理程序可以返回负值以表示错误（见下文），其他返回值将被忽略。如果 <code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">handler</code> 是 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">NULL</code> ，将使用调用 sd_event_exit(3)的默认处理程序。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">By default, an event source will stay enabled continuously (<code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">SD_EVENT_ON</code>), but
    this may be changed with
    <a href="sd_event_source_set_enabled.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_enabled</span>(3)</span></a>.
    If the handler function returns a negative error code, it will either be disabled after the invocation,
    even if the <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">SD_EVENT_ON</code> mode was requested before, or it will cause the loop to
    terminate, see
    <a href="sd_event_source_set_exit_on_failure.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_exit_on_failure</span>(3)</span></a>.
    Note that an event source set to <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">SD_EVENT_ON</code> will fire continuously unless data is
    read from or written to the file descriptor to reset the mask of events seen.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">默认情况下，事件源将保持连续启用（ <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">SD_EVENT_ON</code> ），但可以使用 sd_event_source_set_enabled(3)进行更改。如果处理程序函数返回负错误代码，则在调用后它将被禁用，即使之前请求了 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">SD_EVENT_ON</code> 模式，或者它将导致循环终止，请参见 sd_event_source_set_exit_on_failure(3)。请注意，设置为 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">SD_EVENT_ON</code> 的事件源将持续触发，除非从文件描述符读取或写入数据以重置已看到的事件掩码。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">Setting the I/O event mask to watch for to 0 does not mean
    that the event source won't be triggered anymore, as
    <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLHUP</code> and <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLERR</code>
    may be triggered even with a zero event mask. To temporarily
    disable an I/O event source use
    <a href="sd_event_source_set_enabled.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_enabled</span>(3)</span></a>
    with <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">SD_EVENT_OFF</code> instead.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将 I/O 事件掩码设置为 0 并不意味着事件源不会再被触发，因为即使事件掩码为零， <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLHUP</code> 和 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">EPOLLERR</code> 仍可能被触发。要暂时禁用 I/O 事件源，请改用 sd_event_source_set_enabled(3) 以 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">SD_EVENT_OFF</code> 代替。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">To destroy an event source object use
    <a href="sd_event_source_unref.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_unref</span>(3)</span></a>,
    but note that the event source is only removed from the event loop
    when all references to the event source are dropped. To make sure
    an event source does not fire anymore, even if it is still referenced,
    disable the event source using
    <a href="sd_event_source_set_enabled.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_enabled</span>(3)</span></a>
    with <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">SD_EVENT_OFF</code>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">要销毁事件源对象，请使用 sd_event_source_unref(3)，但请注意，只有当对事件源的所有引用都被丢弃时，事件源才会从事件循环中移除。为了确保事件源不再触发，即使它仍然被引用，使用 sd_event_source_set_enabled(3) 禁用事件源，使用 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">SD_EVENT_OFF</code> 。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">If the second parameter of
    <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> is
    <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">NULL</code> no reference to the event source object
    is returned. In this case the event source is considered
    "floating", and will be destroyed implicitly when the event loop
    itself is destroyed.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> 的第二个参数是 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">NULL</code> ，则不会返回对事件源对象的引用。在这种情况下，事件源被视为“浮动”，当事件循环本身被销毁时，事件源将隐式销毁。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">If the <em class="parameter" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">handler</code></em> to <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> is
    <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">NULL</code>, and the event source fires, this will be considered a request to exit the
    event loop. In this case, the <em class="parameter" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">userdata</code></em> parameter, cast to an integer, is passed as
    the exit code parameter to
    <a href="sd_event_exit.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_exit</span>(3)</span></a>.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果 <code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">handler</code> 到 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> 是 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">NULL</code> ，并且事件源触发，这将被视为退出事件循环的请求。在这种情况下，将 <code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">userdata</code> 参数转换为整数，并作为退出码参数传递给 sd_event_exit(3)。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">Note that this call does not take possession of the file descriptor passed in, ownership (and thus
    the duty to close it when it is no longer needed) remains with the caller. However, with the
    <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_fd_own()</code> call (see below) the event source may optionally
    take ownership of the file descriptor after the event source has been created. In that case the file
    descriptor is closed automatically as soon as the event source is released.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">请注意，此调用不会占用传入的文件描述符，所有权（以及关闭不再需要时的责任）仍归调用者所有。然而，使用 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_fd_own()</code> 调用（见下文）后，事件源在创建后可以选择占用文件描述符的所有权。在这种情况下，一旦事件源被释放，文件描述符将被自动关闭。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">It is recommended to use
    <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> only in conjunction with
    file descriptors that have <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">O_NONBLOCK</code> set, to
    ensure that all I/O operations from invoked handlers are properly
    asynchronous and non-blocking. Using file descriptors without
    <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">O_NONBLOCK</code> might result in unexpected
    starvation of other event sources. See
    <a href="https://man7.org/linux/man-pages/man2/fcntl.2.html" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">fcntl</span>(2)</span></a>
    for details on enabling <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">O_NONBLOCK</code> mode.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">建议仅在与已设置 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">O_NONBLOCK</code> 的文件描述符一起使用 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> ，以确保调用处理程序的所有 I/O 操作都是正确的异步和非阻塞的。在没有 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">O_NONBLOCK</code> 的文件描述符的情况下使用可能导致其他事件源意外饥饿。有关启用 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">O_NONBLOCK</code> 模式的详细信息，请参阅 fcntl(2)。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_events()</code> retrieves
    the configured mask of watched I/O events of an event source created
    previously with <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code>. It takes
    the event source object and a pointer to a variable to store the
    mask in.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_events()</code> 检索先前使用 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> 创建的事件源的已监视 I/O 事件的配置掩码。它接受事件源对象和一个指向要存储掩码的变量的指针。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_events()</code>
    configures the mask of watched I/O events of an event source created
    previously with <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code>. It takes the
    event source object and the new event mask.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_events()</code> 配置先前使用 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> 创建的事件源的已监视 I/O 事件的掩码。它接受事件源对象和新的事件掩码。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_revents()</code>
    retrieves the I/O event mask of currently seen but undispatched
    events from an event source created previously with
    <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code>. It takes the event source
    object and a pointer to a variable to store the event mask
    in. When called from a handler function on the handler's event
    source object this will return the same mask as passed to the
    handler's <em class="parameter" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">revents</code></em> parameter. This call is
    primarily useful to check for undispatched events of an event
    source from the handler of an unrelated (possibly higher priority)
    event source. Note the relation between
    <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_pending()</code> and
    <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_revents()</code>: both
    functions will report non-zero results when there's an event
    pending for the event source, but the former applies to all event
    source types, the latter only to I/O event sources.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_revents()</code> 从先前使用 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> 创建的事件源中检索当前已看到但未分派的事件的 I/O 事件掩码。它接受事件源对象和一个指向要存储事件掩码的变量的指针。当从处理程序函数调用处理程序的事件源对象时，这将返回与传递给处理程序的 <code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">revents</code> 参数相同的掩码。此调用主要用于检查来自无关事件源的处理程序的事件源的未分派事件（可能具有更高的优先级）。请注意 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_pending()</code> 和 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_revents()</code> 之间的关系：当事件源有待处理事件时，这两个函数都会报告非零结果，但前者适用于所有事件源类型，后者仅适用于 I/O 事件源。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_fd()</code> retrieves
    the UNIX file descriptor of an event source created previously
    with <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code>. It takes the event
    source object and returns the non-negative file descriptor
    or a negative error number on error (see below).<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_fd()</code> 检索先前使用 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> 创建的事件源的 UNIX 文件描述符。它接受事件源对象并返回非负文件描述符，或在错误时返回负错误号（请参阅下文）。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_fd()</code>
    changes the UNIX file descriptor of an I/O event source created
    previously with <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code>. It takes
    the event source object and the new file descriptor.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_fd()</code> 更改先前使用 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> 创建的 I/O 事件源的 UNIX 文件描述符。它接受事件源对象和新文件描述符。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_fd_own()</code> controls whether the file descriptor of the event source
    shall be closed automatically when the event source is freed, i.e. whether it shall be considered 'owned' by the
    event source object. By default it is not closed automatically, and the application has to do this on its own. The
    <em class="parameter" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">b</code></em> parameter is a boolean parameter: if zero, the file descriptor is not closed automatically
    when the event source is freed, otherwise it is closed.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_fd_own()</code> 控制事件源的文件描述符在事件源被释放时是否自动关闭，即是否被事件源对象“拥有”。默认情况下，它不会自动关闭，应用程序必须自行处理。 <code data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">b</code> 参数是一个布尔参数：如果为零，则在事件源被释放时文件描述符不会自动关闭，否则会关闭。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_fd_own()</code> may be used to query the current setting of the file
    descriptor ownership boolean flag as set with <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_fd_own()</code>. It returns
    positive if the file descriptor is closed automatically when the event source is destroyed, zero if not, and
    negative on error.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_fd_own()</code> 可用于查询使用 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_fd_own()</code> 设置的文件描述符所有权布尔标志的当前设置。如果文件描述符在事件源被销毁时自动关闭，则返回正值，如果不是，则返回零，出现错误时返回负值。</font></font></font></p></div><div class="refsect1" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><a name="id-1.6" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"></a><h2 id="Return Value" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">Return Value<a class="headerlink" title="Permalink to this headline" href="#Return%20Value" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">¶</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回值 ¶</font></font></font></h2><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">On success, these functions return 0 or a positive
    integer. On failure, they return a negative errno-style error
    code.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">成功时，这些函数返回 0 或正整数。失败时，它们返回负的 errno 风格的错误代码。</font></font></font></p><div class="refsect2" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><a name="id-1.6.3" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"></a><h3 id="Errors" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">Errors<a class="headerlink" title="Permalink to this headline" href="#Errors" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">¶</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">错误 ¶</font></font></font></h3><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">Returned values may indicate the following problems:<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回的值可能表示以下问题：</font></font></font></p><div class="variablelist" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><dl class="variablelist" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><dt id="-ENOMEM" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><span class="term" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">-ENOMEM</code></span><a class="headerlink" title="Permalink to this term" href="#-ENOMEM" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">¶</a></dt><dd data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">Not enough memory to allocate an object.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">没有足够的内存来分配对象。</font></font></font></p></dd><dt id="-EINVAL" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><span class="term" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">-EINVAL</code></span><a class="headerlink" title="Permalink to this term" href="#-EINVAL" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">¶</a></dt><dd data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">An invalid argument has been passed.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">传递了无效参数。</font></font></font></p></dd><dt id="-ESTALE" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><span class="term" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">-ESTALE</code></span><a class="headerlink" title="Permalink to this term" href="#-ESTALE" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">¶</a></dt><dd data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">The event loop is already terminated.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">事件循环已经终止。</font></font></font></p></dd><dt id="-ECHILD" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><span class="term" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">-ECHILD</code></span><a class="headerlink" title="Permalink to this term" href="#-ECHILD" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">¶</a></dt><dd data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">The event loop has been created in a different process, library or module instance.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">事件循环已在不同的进程、库或模块实例中创建。</font></font></font></p></dd><dt id="-EDOM" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><span class="term" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">-EDOM</code></span><a class="headerlink" title="Permalink to this term" href="#-EDOM" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">¶</a></dt><dd data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">The passed event source is not an I/O event source.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">传递的事件源不是 I/O 事件源。</font></font></font></p></dd><dt id="-EPERM" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><span class="term" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">-EPERM</code></span><a class="headerlink" title="Permalink to this term" href="#-EPERM" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">¶</a></dt><dd data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">The passed file descriptor does not support the <a href="https://man7.org/linux/man-pages/man7/epoll.7.html" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">epoll</span>(7)</span></a>
          API, for example because it is a regular file or directory. See <a href="https://man7.org/linux/man-pages/man2/epoll_ctl.2.html" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">epoll_ctl</span>(2)</span></a>
          for details.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">传递的文件描述符不支持 epoll(7) API，例如因为它是一个常规文件或目录。有关详细信息，请参阅 epoll_ctl(2)。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><a name="v255" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"></a>Added in version 255.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在版本 255 中添加。</font></font></font></p></dd></dl></div></div></div><div class="refsect1" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><a name="id-1.7" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"></a><h2 id="Notes" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">Notes<a class="headerlink" title="Permalink to this headline" href="#Notes" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">¶</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">注意事项 ¶</font></font></font></h2><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><a name="pkgconfig-text" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"></a>Functions described here are available as a shared
  library, which can be compiled against and linked to with the
  <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">libsystemd</code>&nbsp;<a href="http://linux.die.net/man/1/pkg-config" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">pkg-config</span>(1)</span></a>
  file.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此处描述的函数可作为共享库使用，可以通过 <code class="constant" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">libsystemd</code> pkg-config(1) 文件进行编译和链接。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><a name="getenv" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"></a>The code described here uses
<a href="https://man7.org/linux/man-pages/man3/getenv.3.html" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">getenv</span>(3)</span></a>,
which is declared to be not multi-thread-safe. This means that the code calling the functions described
here must not call
<a href="https://man7.org/linux/man-pages/man3/setenv.3.html" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">setenv</span>(3)</span></a>
from a parallel thread. It is recommended to only do calls to <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">setenv()</code>
from an early phase of the program when no other threads have been started.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此处描述的代码使用了 getenv(3)，该函数被声明为非多线程安全。这意味着调用此处描述的函数的代码不能从并行线程中调用 setenv(3)。建议仅在程序的早期阶段进行对 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">setenv()</code> 的调用，此时尚未启动其他线程。</font></font></font></p></div><div class="refsect1" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><a name="id-1.8" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"></a><h2 id="History" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">History<a class="headerlink" title="Permalink to this headline" href="#History" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">¶</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">历史 ¶</font></font></font></h2><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_io_handler_t()</code>,
    <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code>,
    <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_events()</code>,
    <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_events()</code>,
    <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_revents()</code>,
    <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_fd()</code>, and
    <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_fd()</code> were added in version 229.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_io_handler_t()</code> ， <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_io()</code> ， <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_events()</code> ， <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_events()</code> ， <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_revents()</code> ， <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_fd()</code> 和 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_fd()</code> 在版本 229 中添加。</font></font></font></p><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1"><code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_fd_own()</code> and
    <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_fd_own()</code> were added in version 239.<font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_io_fd_own()</code> 和 <code class="function" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_io_fd_own()</code> 在版本 239 中添加。</font></font></font></p></div><div class="refsect1" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><a name="id-1.9" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"></a><h2 id="See Also" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">See Also<a class="headerlink" title="Permalink to this headline" href="#See%20Also" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">¶</a><font class="notranslate immersive-translate-target-wrapper" lang="zh-CN" data-immersive-translate-translation-element-mark="1"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">参见 ¶</font></font></font></h2><p data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832" data-immersive-translate-paragraph="1">
      <a href="systemd.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">systemd</span>(1)</span></a>,
      <a href="sd-event.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd-event</span>(3)</span></a>,
      <a href="sd_event_new.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_new</span>(3)</span></a>,
      <a href="sd_event_now.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_now</span>(3)</span></a>,
      <a href="sd_event_add_time.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_time</span>(3)</span></a>,
      <a href="sd_event_add_signal.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_signal</span>(3)</span></a>,
      <a href="sd_event_add_child.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_child</span>(3)</span></a>,
      <a href="sd_event_add_inotify.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_inotify</span>(3)</span></a>,
      <a href="sd_event_add_defer.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_add_defer</span>(3)</span></a>,
      <a href="sd_event_source_set_enabled.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_enabled</span>(3)</span></a>,
      <a href="sd_event_source_set_priority.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_priority</span>(3)</span></a>,
      <a href="sd_event_source_set_userdata.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_userdata</span>(3)</span></a>,
      <a href="sd_event_source_set_description.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_description</span>(3)</span></a>,
      <a href="sd_event_source_get_pending.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_get_pending</span>(3)</span></a>,
      <a href="sd_event_source_set_floating.html#" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">sd_event_source_set_floating</span>(3)</span></a>,
      <a href="https://man7.org/linux/man-pages/man2/epoll_ctl.2.html" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">epoll_ctl</span>(2)</span></a>,
      <a href="https://man7.org/linux/man-pages/man7/epoll.7.html" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="citerefentry" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832"><span class="refentrytitle" data-immersive-translate-walked="65ddc268-aac2-4c11-ae7b-d0648a744832">epoll</span>(7)</span></a>
    </p></div></div>
</body></html>